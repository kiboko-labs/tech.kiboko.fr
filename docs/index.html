<!DOCTYPE html>
<html lang="fr-fr">
  <head>
  <meta charset="utf-8">
  <title>Tech.Kiboko.fr</title>

  <meta name="generator" content="Hugo 0.147.3">

  <!-- mobile responsive meta -->
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  
  <!-- ** Plugins Needed for the Project ** -->
  <!-- Bootstrap -->
  <link rel="stylesheet" href="http://tech.kiboko.fr/plugins/bootstrap/bootstrap.min.css">

  <!-- themefy-icon -->
  <link rel="stylesheet" href="http://tech.kiboko.fr/plugins/themify-icons/themify-icons.css">

  <!-- highlight -->
  <link rel="stylesheet" href="http://tech.kiboko.fr/plugins/highlight/hybrid.css">

  <!--Favicon-->
  <link rel="icon" href="http://tech.kiboko.fr/images/favicon.png" type="image/x-icon">

  <!-- fonts -->
  <link href="https://fonts.googleapis.com/css?family=Libre%20Franklin%2c%20Helvetica%20Neue%2c%20Helvetica%2c%20Arial%2c%20Sans-Serif:300,400,700&display=swap" rel="stylesheet">
  
  <style>
  :root{
    --primary-color: #222;
    --body-color:#ddd;
    --text-color:#000;
    --text-color-dark:#333;
    --white-color:#eee;
    --light-color:#ddd;
    --font-family:Libre Franklin, Helvetica Neue, Helvetica, Arial, Sans-Serif;
  }
  </style>

<!-- Main Stylesheet -->

<link href="http://tech.kiboko.fr/css/style.min.css" rel="stylesheet" media="screen"/>

<!-- jquiry -->
<script src="http://tech.kiboko.fr/plugins/jquery/jquery-1.12.4.js"></script>

<!-- jquary ui -->
<script src="http://tech.kiboko.fr/plugins/jquery/jquery-ui.js"></script>

<!-- Bootstrap JS -->
<script src="http://tech.kiboko.fr/plugins/bootstrap/bootstrap.min.js"></script>

<!-- match-height JS -->
<script src="http://tech.kiboko.fr/plugins/match-height/jquery.matchHeight-min.js"></script>

<!-- highlight -->
<script src="http://tech.kiboko.fr/plugins/highlight/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>



</head>
  
  <body>
    
    <!-- header -->
    <header class="banner bg-white" data-background="http://tech.kiboko.fr/">
      <nav class="navbar navbar-expand-md navbar-dark">
  <div class="container">
    <a class="navbar-brand px-2" href="/">
      
      
      
      
      <div class="navbar-brand">
        <img class="img-fluid" src="http://tech.kiboko.fr/images/logo.png "
          alt="Tech.Kiboko.fr">
      </div>
      
      
    </a>
    <button class="navbar-toggler border-0" type="button" data-toggle="collapse" data-target="#navigation"
      aria-controls="navigation" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse text-center" id="navigation">
      <ul class="navbar-nav ml-auto">
        <li class="nav-item">
          <a class="nav-link text-dark" href="/"></a>
        </li>
        
        
        <li class="nav-item">
          <a class="nav-link text-dark" href="/kibokast">Kibokast</a>
        </li>
        
        
        
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle text-dark" href="#" role="button" data-toggle="dropdown"
            aria-haspopup="true" aria-expanded="false">
            docs
          </a>
          <div class="dropdown-menu">
            
            <a class="dropdown-item" href="/oro">Oro</a>
            
            <a class="dropdown-item" href="/docker">Docker</a>
            
            <a class="dropdown-item" href="/autre">Autre</a>
            
            <a class="dropdown-item" href="/composer">Composer</a>
            
            <a class="dropdown-item" href="/env-local">Environnement local</a>
            
            <a class="dropdown-item" href="/kubernetes">Kubernetes</a>
            
            <a class="dropdown-item" href="/sql">SQL</a>
            
          </div>
        </li>
        
        
        
        <li class="nav-item">
          <a class="nav-link text-dark" href="http://kiboko.fr/fr/contactez-nous/">Contactez-nous</a>
        </li>
        
        
      </ul>
      
    </div>
  </div>
</nav>

      <!-- banner -->
<div class="container section">
  <div class="row">
    <div class="col-lg-8 text-center mx-auto">
      <h1 class="text-dark mb-3">Tech.Kiboko.fr</h1>
      <p class="text-dark mb-4">Parcourir la documentation technique pour découvrir et utiliser nos méthodes de travail</p>
      <div class="position-relative">
        <input id="search" class="form-control" placeholder="Rechercher une documentation">
        <i class="ti-search search-icon"></i>
        
        
        
        
        <script>
          $(function () {
          var projects = [
            
            {
              value: "Afficher dynamiquement une action de datagrid",
              label: "<p>Scénario : L\u0026rsquo;affichage ou non d\u0026rsquo;une action doit être générée a la volée suivant les données de la ligne\nGérer dynamiquement des actions dans une datagrid Dans datagrid.yml\nproperties: link_1: type: url route: route_1 params: [id] link_2: type: url route: route_2 params: [id] actions: action_1: type: navigate label: edit link: link_1 icon: edit rowAction: true action_2: type: navigate label: edit link: link_2 icon: edit rowAction: true action_configuration: [\u0026#39;@acme_test.datagrid.entity.action_permission_provider\u0026#39;, \u0026#39;getActionPermissions\u0026#39;] On fait le service du provider :\nacme_test.datagrid.entity.action_permission_provider: class: Acme\\Bundle\\TestBundle\\Datagrid\\EntityActionPermissionProvider La classe qui va avec :\n$record contient nos données pour chaque ligne de la datagrid\n\u0026lt;?php namespace Acme\\Bundle\\TestBundle\\Datagrid; use Marello\\Bundle\\DataGridBundle\\Action\\ActionPermissionInterface; use Oro\\Bundle\\DataGridBundle\\Datasource\\ResultRecordInterface; class EntityActionPermissionProvider implements ActionPermissionInterface { \/** * {@inheritdoc} *\/ public function getActionPermissions(ResultRecordInterface $record) { \/\/ Votre traitement qui va permettre de décider les actions qu\u0026#39;on affiche \/\/ false =\u0026gt; pas affiché \/\/ true =\u0026gt; affiché return [ \u0026#39;action_1\u0026#39; =\u0026gt; true, \u0026#39;action_2\u0026#39; =\u0026gt; false ]; } } </p>",
              url: "http:\/\/tech.kiboko.fr\/oro\/datagrid\/afficher-dynamiquement-une-action\/"
            },
            
            {
              value: "Ajouter  un Consent sur la page d\u0027inscription",
              label: "<p>https:\/\/oroinc.com\/b2b-ecommerce\/doc\/current\/user-guide\/consents\/add-consent#user-guide-consents-add\nAjouter un Consent sur la page d\u0026rsquo;inscription Configuration \/ Commerce \/ Client \/ Consents Enable user consents feature :\nDécocher Par défaut\nCocher Enable user consents feature\nMarketing \/ Catalogues Web \/ Créer Noeud de contenu -\u0026gt; Ajouter Page de contenu Contiendra le texte du consent\nSystème \/ Consent Manager -\u0026gt; Créer Consent Name : le nom qui apparaitra sur le formulaire d\u0026rsquo;inscription\nContent Node : sélectionner le noeud de contenu qui contient le texte\nConfiguration \/ Commerce \/ Client \/ Consents Enabled user consents :\nDécocher Par défaut\nCliquer Add Consent\nSélectionner le consent\nVIDER LE CACHE </p>",
              url: "http:\/\/tech.kiboko.fr\/oro\/front\/add-consent-on-registration\/"
            },
            
            {
              value: "Ajouter une mass action dans la grille produit",
              label: "<p>Le strict nécessaire pour ajouter une mass-action sur la grille produit.\nLes mots rigolos (machin, glouglou, torref, avionAréAction et massage-de-pieds) indiquent les alias qui peuvent être changés.\nResources\/oro\/config\/actions.yml operations: glouglou: label: mass.age.de.pieds datagrids: - frontend-product-search-grid datagrid_options: mass_action: type: addproducts frontend_type: torref # c\u0026#39;est le nom de votre JS sans \u0026#34;-action.js\u0026#34; Resources\/public\/js\/datagrid\/action\/backend-action-header-cell.js piquez backend-action-header-cell.js dans les vendor ligne 102, ajouter votre action : newMassActions[\u0026#39;glougloumass_action\u0026#39;] = $.extend(true, {}, avionAréAction, { name: \u0026#39;glougloumass_action\u0026#39; }); ligne 30 : définissez votre action : var avionAréAction = { icon: \u0026#39;copy\u0026#39;, # une icone FontAwesome sans \u0026#34;fa-\u0026#34; frontend_handle: \u0026#39;ajax\u0026#39;, label: __(\u0026#39;mass.age.de.pieds\u0026#39;), type: \u0026#39;addproducts\u0026#39;, frontend_type: \u0026#39;torref\u0026#39;, # le nom de votre JS sans \u0026#34;-action.js\u0026#34; route: \u0026#39;mass_age_de_pieds\u0026#39;, # la route handler: \u0026#39;app.machin.mass_action.handler\u0026#39;, # là ou vous mettrez vos traitements }; Ajoutez var __ = require(\u0027orotranslation\/js\/translator\u0027); vers les requires lignes 4 ou 5. Resources\/public\/js\/datagrid\/action\/torref-action.js piquez add-products-mass-action.js dans les vendor Resources\/views\/layouts\/blank\/config\/require.js config: paths: \u0026#39;oro\/datagrid\/action\/torref-action\u0026#39;: \u0026#39;bundles\/app\/js\/datagrid\/action\/torref-action.js\u0026#39; \u0026#39;app\/js\/datagrid\/action\/backend-action-header-cell\u0026#39;: \u0026#39;bundles\/app\/js\/datagrid\/action\/backend-action-header-cell.js\u0026#39; map: \u0026#39;*\u0026#39;: \u0026#39;oroproduct\/js\/app\/datagrid\/header-cell\/backend-action-header-cell\u0026#39;: \u0026#39;app\/js\/datagrid\/action\/backend-action-header-cell\u0026#39; Controller\/MachinController.php \/** * @Route(\u0026#34;\/mass-age-de-pieds\/\u0026#34;, name=\u0026#34;mass_age_de_pieds\u0026#34;) *\/ public function massAgeDePieds(Request $request) { $gridName = $request-\u0026gt;get(\u0026#39;gridName\u0026#39;); $actionName = $request-\u0026gt;get(\u0026#39;actionName\u0026#39;); \/** @var MassActionDispatcher $massActionDispatcher *\/ $massActionDispatcher = $this-\u0026gt;get(\u0026#39;oro_datagrid.mass_action.dispatcher\u0026#39;); $response = $massActionDispatcher-\u0026gt;dispatchByRequest($gridName, $actionName, $request); $data = [ \u0026#39;successful\u0026#39; =\u0026gt; $response-\u0026gt;isSuccessful(), \u0026#39;message\u0026#39; =\u0026gt; $response-\u0026gt;getMessage() ]; return new JsonResponse(array_merge($data, $response-\u0026gt;getOptions())); } Dans routing.yml, le controller doit avoir options.expose: true.\nMassAction\/MachinMassActionHandler.php Là ou vous mettez vos traitements. C\u0026rsquo;est $ids qui vous intéresse.\nclass MachinMassActionHandler implements MassActionHandlerInterface { public function handle(MassActionHandlerArgs $args) { $argsParser = new AddProductsMassActionArgsParser($args); $ids = $argsParser-\u0026gt;getProductIds(); return new MassActionResponse(true, \u0026#39;message\u0026#39;); } } </p>",
              url: "http:\/\/tech.kiboko.fr\/oro\/datagrid\/mass-actions-product-grid\/"
            },
            
            {
              value: "Back",
              label: "<p></p>",
              url: "http:\/\/tech.kiboko.fr\/oro\/back\/"
            },
            
            {
              value: "Creer un formulaite en front",
              label: "<p>Create a frontend form Create a form Create the frontend controller and declare it in Resource\\config\\oro\\routing.yml like this: my_entity_frontend: resource: \u0026#39;@MyBundle\/Controller\/Frontend\/MyEntityController.php\u0026#39; type: annotation prefix: \/myentity options: frontend: true Create a FormProvider in Layout\\DataProvider: use Oro\\Bundle\\LayoutBundle\\Layout\\DataProvider\\AbstractFormProvider; class MyEntityFormProvider extends AbstractFormProvider { \/** * @param MyEntity $myEntity * @return FormView *\/ public function getMyFormView(MyEntity $myEntity) { return $this-\u0026gt;getFormView(MyEntityType::class, $myEntity); } } Declare it in the services: my.frontend.form.provider: class: MyBundle\\Layout\\DataProvider\\MyEntityFormProvider arguments: - \u0026#39;@form.factory\u0026#39; - \u0026#39;@router\u0026#39; tags: - { name: layout.data_provider, alias: my_provider_alias } Create a layout.yml in Resources\\views\\layouts\\the theme you use\\layouts\\the name of your page layout: actions: - \u0026#39;@setBlockTheme\u0026#39;: themes: \u0026#39;MyBundle:layouts:default\/my_page\/my_page.html.twig\u0026#39; - \u0026#39;@addTree\u0026#39;: items: container: blockType: container form_start: blockType: form_start options: form: \u0026#39;=data[\u0026#34;my_provider_alias\u0026#34;].getMyFormView(data[\u0026#34;entity\u0026#34;])\u0026#39; form_fields: blockType: form_fields options: form: \u0026#39;=data[\u0026#34;my_provider_alias\u0026#34;].getMyFormView(data[\u0026#34;entity\u0026#34;])\u0026#39; form_end: blockType: form_end options: form: \u0026#39;=data[\u0026#34;my_provider_alias\u0026#34;].getMyFormView(data[\u0026#34;entity\u0026#34;])\u0026#39; form_confirm: blockType: button options: action: submit text: oro.customer.form.action.save.label style: auto attr: \u0026#39;class\u0026#39;: \u0026#39; btn--large btn--full-in-mobile\u0026#39; tree: page_content: container: form_start: ~ form_fields: ~ form_confirm: ~ form_end: ~ You can now customize how fields are rendered with a twig:\n{% block _form_fields_widget %} \u0026lt;div class=\u0026#34;grid__column grid__column--12\u0026#34;\u0026gt; {{ form_row(form.afield) }} \u0026lt;\/div\u0026gt; \u0026lt;div class=\u0026#34;grid__column grid__column--6\u0026#34;\u0026gt; {{ form_row(form.anotherfield) }} \u0026lt;\/div\u0026gt; {% endblock %} {% block _container_widget %} \u0026lt;div class=\u0026#34;login-form\u0026#34;\u0026gt; {{ block_widget(block) }} \u0026lt;\/div\u0026gt; {% endblock %} </p>",
              url: "http:\/\/tech.kiboko.fr\/oro\/front\/create-form-frontend\/"
            },
            
            {
              value: "Datagrid",
              label: "<p></p>",
              url: "http:\/\/tech.kiboko.fr\/oro\/datagrid\/"
            },
            
            {
              value: "Front",
              label: "<p></p>",
              url: "http:\/\/tech.kiboko.fr\/oro\/front\/"
            },
            
            {
              value: "Tech.Kiboko.fr",
              label: "<p></p>",
              url: "http:\/\/tech.kiboko.fr\/"
            },
            
            {
              value: "Utiliser un champ select d\u0027entité dans la config Oro",
              label: "<p>Utiliser un select type dans la config Oro! Pour utiliser un champ select héritant de OroEntitySelectOrCreateInlineType, on ne peux simplement utiliser des transformers pour convertir un objet en Id pour que l\u0026rsquo;on puisse enregistrer un id au lieu d\u0026rsquo;un objet en base.(Sinon vous allez avoir des surprises en prod :) )\nExplication Le champ Select vas utiliser la ModelData du formulaire pour la transmettre a l\u0026rsquo;autocomplete qui utilise un objet. ( Oro\/Bundle\/ConfigBundle\/Form\/Handler\/ConfigHandler.php pour plus de précisions). OroEntitySelectOrCreateInlineType utilise lui meme un EntityToIdTransformer pour transformer la donnée. Donc il ne faut pas rajouter d\u0026rsquo;autre DataTransformer sinon vous aurez des erreurs. Il faut donc transformer la donnée autre part, mais ou ?\nSolution Tout d\u0026rsquo;abord créer un formulaire comme ceci :\n\u0026lt;?php namespace SliderBundle\\Form\\Type; use Doctrine\\Common\\Persistence\\ObjectRepository; use Oro\\Bundle\\FormBundle\\Form\\Type\\OroEntitySelectOrCreateInlineType; use SliderBundle\\Form\\DataTransformer\\SliderModelTransformer; use SliderBundle\\Form\\DataTransformer\\SliderViewTransformer; use Symfony\\Component\\Form\\AbstractType; use Symfony\\Component\\Form\\FormBuilderInterface; use Symfony\\Component\\OptionsResolver\\OptionsResolver; class SliderSelectType extends AbstractType { const NAME = \u0026#39;kiboko_slider_select\u0026#39;; \/** * {@inheritdoc} *\/ public function configureOptions(OptionsResolver $resolver) { $resolver-\u0026gt;setDefaults( [ \u0026#39;autocomplete_alias\u0026#39; =\u0026gt; \u0026#39;kiboko_slider\u0026#39;, \u0026#39;create_form_route\u0026#39; =\u0026gt; \u0026#39;kiboko_slider_create\u0026#39;, \u0026#39;grid_name\u0026#39; =\u0026gt; \u0026#39;kiboko-slider-grid\u0026#39;, \u0026#39;configs\u0026#39; =\u0026gt; [ \u0026#39;placeholder\u0026#39; =\u0026gt; \u0026#39;kiboko.slider.form.choose\u0026#39;, ] ] ); } \/** * {@inheritdoc} *\/ public function getParent() { return OroEntitySelectOrCreateInlineType::class; } \/** * {@inheritdoc} *\/ public function getName() { return $this-\u0026gt;getBlockPrefix(); } \/** * {@inheritdoc} *\/ public function getBlockPrefix() { return self::NAME; } } Assurez vous bien d\u0026rsquo;avoir un search handler:\nservices.yml :\nkiboko.form.autocomplete.slider.search_handler: public: false parent: oro_form.autocomplete.search_handler arguments: - \u0026#39;%kiboko.entity.slider.class%\u0026#39; - [\u0026#34;name\u0026#34;] tags: - { name: oro_form.autocomplete.search_handler, alias: kiboko_slider } search.yml :\nsearch: SliderBundle\\Entity\\Slider: alias: kiboko_slider title_fields: [name] route: name: kiboko_slider_view parameters: id: id search_template: SliderBundle:Search:result.html.twig fields: - name: name target_type: text target_fields: [name] Dans votre fichier de Configuration dans DependencyInjection votre config doit être de type string pour stocker l\u0026rsquo;id de l\u0026rsquo;entité.\n\u0027slider\u0027 =\u0026gt; [\u0027type\u0027 =\u0026gt; \u0027string\u0027, \u0027value\u0027 =\u0026gt; null], et dans votre fichier system_configuration.yml\nslider_bundle.slider: data_type: string type: SliderBundle\\Form\\Type\\SliderSelectType options: label: kiboko.slider.system_configuration.fields.slider.label tooltip: kiboko.slider.system_configuration.fields.slider.label.tooltip required: true configs: placeholder: \u0026#39;kiboko.slider.form.choose_slider\u0026#39; result_template_twig: \u0026#39;SliderBundle:Slider:Autocomplete\/result.html.twig\u0026#39; selection_template_twig: \u0026#39;SliderBundle:Slider:Autocomplete\/selection.html.twig\u0026#39; constraints: - NotBlank: ~ A vous de personnalisez vos templates twig a votre sauce :)\nBon, jusqu\u0026rsquo;ici nous avons notre champ select mais ils nous faut la logique de transformation :\nPour cela créer une classe SystemConfigListener dans un dossier EventListener, comme ceci :\n\u0026lt;?php namespace SliderBundle\\EventListener; use Doctrine\\Common\\Persistence\\ManagerRegistry; use Oro\\Bundle\\ConfigBundle\\Config\\ConfigManager; use Oro\\Bundle\\ConfigBundle\\Event\\ConfigSettingsUpdateEvent; use SliderBundle\\DependencyInjection\\SliderExtension; class SystemConfigListener { const SETTING = \u0026#39;slider\u0026#39;; \/** * @var ManagerRegistry *\/ protected $registry; \/** * @var string *\/ protected $sliderClass; \/** * @param ManagerRegistry $registry * @param string $userClass *\/ public function __construct(ManagerRegistry $registry, $userClass) { $this-\u0026gt;registry = $registry; $this-\u0026gt;sliderClass = $userClass; } \/** * @param ConfigSettingsUpdateEvent $event *\/ public function onFormPreSetData(ConfigSettingsUpdateEvent $event) { $settingsKey = implode(ConfigManager::SECTION_VIEW_SEPARATOR, [SliderExtension::ALIAS, self::SETTING]); $settings = $event-\u0026gt;getSettings(); if (is_array($settings) \u0026amp;\u0026amp; !empty($settings[$settingsKey][\u0026#39;value\u0026#39;]) ) { $settings[$settingsKey][\u0026#39;value\u0026#39;] = $this-\u0026gt;registry -\u0026gt;getManagerForClass($this-\u0026gt;sliderClass) -\u0026gt;find($this-\u0026gt;sliderClass, $settings[$settingsKey][\u0026#39;value\u0026#39;]); $event-\u0026gt;setSettings($settings); } } \/** * @param ConfigSettingsUpdateEvent $event *\/ public function onSettingsSaveBefore(ConfigSettingsUpdateEvent $event) { $settings = $event-\u0026gt;getSettings(); if (!array_key_exists(\u0026#39;value\u0026#39;, $settings)) { return; } if (!is_a($settings[\u0026#39;value\u0026#39;], $this-\u0026gt;sliderClass)) { return; } \/** @var object $owner *\/ $slider = $settings[\u0026#39;value\u0026#39;]; $settings[\u0026#39;value\u0026#39;] = $slider-\u0026gt;getId(); $event-\u0026gt;setSettings($settings); } } Le but de cette classe et de récupérer l\u0026rsquo;entité en fonction de son id lors du chargement de la page et de transformer cet objet en id lors d\u0026rsquo;un submit. et du coup pour ça il faut déclarer le service comme ceci\nkiboko.slider.event_listener.system_config: class: SliderBundle\\EventListener\\SystemConfigListener arguments: - \u0026#34;@doctrine\u0026#34; - \u0026#39;%kiboko.entity.slider.class%\u0026#39; tags: - { name: kernel.event_listener, event: oro_config.settings_form_preset, method: onFormPreSetData } - { name: kernel.event_listener, event: oro_config.settings_before_save.slider_bundle.slider, method: onSettingsSaveBefore } Sachant que slider_bundle c\u0026rsquo;est votre alias de votre extension et slider votre config spécifique :\nclass SliderExtension extends Extension { const ALIAS = \u0026#39;slider_bundle\u0026#39;; </p>",
              url: "http:\/\/tech.kiboko.fr\/oro\/select-type-in-oro-config\/"
            },
            
            {
              value: "Proxy Symfony",
              label: "<p>Pourquoi utiliser le Proxy de Symfony ? Le Proxy de symfony permet d\u0026rsquo;utiliser des noms de domaines HTTPS en local, à la manière du fichier etc\/hosts.\nL\u0026rsquo;avantage est que le proxy fournit un certificat et permet de tester en local les fonctionnalités reservées au HTTPS (localisation, différente gestion des cookies, etc\u0026hellip;)\nAutre avantage: on évite de modifier le fichier etc\/host pour ajouter ou enlever un domaine, et symfony fournit une commande symfony proxy:status pour lister les domaines actifs et leur répertoire.\nMise en place 1. Activer TLS symfony server:ca:install\nCrée et installe le certificat, pour faire croire au navigateur que les domaines sont en HTTPS.\n2. Paramètrer le proxy Dans les paramètres réseau de l\u0026rsquo;OS (linux, mac), il faut trouver l\u0026rsquo;option \u0026ldquo;Configuration automatique du proxy\u0026rdquo; et lui assigner l\u0026rsquo;URL:\nhttp:\/\/127.0.0.1:7080\/proxy.pac\n3. Lancer le proxy symfony proxy:start\nUtilisation Ajouter \/ enlever un domaine symfony proxy:domain:attach domaine\nsymfony proxy:domain:detach domaine\nVoir la liste des domaines Accedez à 127.0.0.1:7080\nou lancez\nsymfony proxy:status\nPlus de détails dans la documentation de symfony server\n</p>",
              url: "http:\/\/tech.kiboko.fr\/kibokast\/symfony-proxy\/"
            },
            
            {
              value: "Commandes Symfony, Oro et Doctrine",
              label: "<p>À partir de Oro 4.1, Oro a fourni sa propre stack Docker. La différence majeure par rapport à la stack Kiboko est l\u0026rsquo;utilisation de symfony CLI à la place de services php.\nOn lance désormais les commandes Symfony en local.\n1. Commandes Symfony Avant :\ndocker compose exec sh bin\/console cache:clear\nAprès :\nsymfony console cache:clear\nOn utilise désormais Symfony CLI :\nhttps:\/\/github.com\/symfony-cli\/symfony-cli https:\/\/symfony.com\/doc\/current\/components\/console.html Symfony CLI permet également de lancer les commandes composer et php.\n⚠︎ Toutes les commandes php, composer et bin\/console doivent être lancées en utilisant Symfony CLI\nsymfony composer\nMultiples versions de Php\nQuand il y a plusieurs versions de php installées sur votre poste, il est préférable de forcer la version utilisée sur le projet. Il faut pour cela ajouter un fichier .php-version à la racine du projet pour indiquer la version de php à utiliser.\nhttps:\/\/symfony.com\/doc\/current\/setup\/symfony_server.html#different-php-settings-per-project\nServer local\nPour lancer le serveur HTTPS local :\nSoit symfony serve Soit symfony server:start Pour arrêter le serveur HTTPS local :\nSoit faire un CTRL \u002b C dans la console qui a lancé le serveur Soit symfony server:stop https:\/\/symfony.com\/doc\/current\/setup\/symfony_server.html#getting-started\nActiver TLS\/HTTPS\nPour que le HTTPS soit fonctionnel, il faut ajouter les certificats TLS sur le poste local avec la commande suivante :\nsymfony server:ca:install\nhttps:\/\/symfony.com\/doc\/current\/setup\/symfony_server.html#enabling-tls\n2. Commandes Oro 2.1. Commande \u0026ldquo;platform update\u0026rdquo; La commande oro:platform:update d\u0026rsquo;Oro : https:\/\/github.com\/oroinc\/platform\/blob\/master\/src\/Oro\/Bundle\/InstallerBundle\/Command\/PlatformUpdateCommand.php\nsymfony console oro:platform:update --force --timeout=0\nQuand on lance la commande oro:platform:update, les commandes ci-dessous sont lancées dans cet ordre :\noro:check-requirements oro:migration:load (comprend le rafraichissement de cache d\u0026rsquo;entités) security:permission:configuration:load oro:cron:definitions:load oro:workflow:definitions:load oro:process:configuration:load oro:migration:data:load router:cache:clear oro:message-queue:create-queues assets:install fos:js-routing:dump oro:localization:dump oro:translation:dump oro:assets:build Si vous avez un grand nombre de migrations, ou que votre migration a un risque de dépasser 300 secondes d\u0026rsquo;exécution, il faut ajouter l\u0026rsquo;option --timeout=0\nSi vous souhaitez reprendre rapidement la main sur votre console et laisser l\u0026rsquo;indexation se lancer en tâche de fond, il faut ajouter l\u0026rsquo;option --schedule-search-reindexation pour ne pas bloquer la console et remplir la MQ :\nhttps:\/\/github.com\/oroinc\/platform\/blob\/master\/src\/Oro\/Bundle\/SearchBundle\/EventListener\/Command\/ReindexationOptionsCommandListener.php\nou --skip-search-reindexation pour totalement passer l\u0026rsquo;indexation\nCette dernière option est à utiliser uniquement dans des situations où vous avez de grandes volumétries, comme un site multi-boutiques ou un site avec de nombreux produits. Vous devrez vous charger vous-même du lancement des commandes d\u0026rsquo;indexation.\nPour lancer la réindexation back-office :\nsymfony console oro:search:reindex --scheduled\nPour lancer la réindexation d\u0026rsquo;un site web :\nsymfony console oro:website-search:reindex --website-id=2 --scheduled\n2.2 Commandes de cache symfony console cache:clear\nCette commande reconstruit un nouveau cache en conservant le cache existant vivre le temps de cette reconstruction. Une fois le cache reconstruit, l\u0026rsquo;ancien cache est remplacé par le nouveau. C\u0026rsquo;est cette commande qui crée les dossiers var\/cache\/de_ et var\/cache\/pro_ dans son processus de régénération de cache.\nCette commande ne met pas à jour le fichier bundles.php généré par Oro. Quand on ajoute un bundle Oro il faut absolument supprimer ce fichier.\nsymfony console cache:warmup\nCette commande reconstruit un nouveau cache, Si un dossier de cache existe, le nouveau cache se cumulera avec le cache existant. Il es impératif de lancer cette commande après un rm -rf var\/cache\/* et de s\u0026rsquo;assurer que les processus de Worker de MQ ou se serveur Websocket ou qu\u0026rsquo;aucune requête HTTP ne soit en cours d\u0026rsquo;exécution. Si ce dernier critère n\u0026rsquo;est pas suivi, le cache aura une chance d\u0026rsquo;être corrompu.\n2.3. Commandes d\u0026rsquo;assets symfony console assets:install --symlink\nCette commande permet d\u0026rsquo;effectuer une copie des assets de l\u0026rsquo;application et des bundles dans le dossier public\/bundles. La seule limite à cette commande est l\u0026rsquo;ajout d\u0026rsquo;un nouveau fichier d\u0026rsquo;assets. À chaque création de nouveau fichier il faudra relancer cette commande.\nsymfony console oro:assets:build\nCette commande lance le build webpack. Elle permet avec l\u0026rsquo;option --watch de lancer le watcher Webpack, qui permet d\u0026rsquo;avoir des mises à jour en temps réel dans le navigateur sans avoir à rafraichir la page.\nOn peut la restreindre sur un seul theme pour la partie front en précisant le nom du thème en paramètre comme ceci :\nsymfony console oro:asset:build --watch\nLa commande symfony console oro:assets:install --symlink permet de générer tous les assets, dans le cas où on ne ferait pas de développements front-end. En fond, 4 commandes sont lancées :\nfos:js-routing:dump oro:localization:dump assets:install --symlink oro:assets:build 3. Entités Doctrine et schéma SQL Les commandes Doctrine permettent de maintenir le schéma de bases de données lorsque l\u0026rsquo;on modifie des entités.\nhttps:\/\/symfony.com\/doc\/6.0\/doctrine.html\nLa commande symfony console doctrine:schema:update --dump-sql permet de voir quelles requêtes SQL doivent être lancées pour aligner le schéma déclaré en base de donnés avec celui déclaré sur les entités Doctrine.\nLa commande symfony console doctrine:schema:update --force permet d\u0026rsquo;exécuter ces requêtes pour aligner les deux schémas.\nSur un projet Symfony standard (qui n\u0026rsquo;utilise pas OroPlatform) Les commandes listées dans symfony console list doctrine:migrations permettent de gérer les fichiers de migrations. Les fichiers de migration sont des listings des requêtes SQL à exécuter pour modifier le schéma de base de données.\nsymfony console doctrine:migration:diff permet de générer un nouveau fichier de migration pour aligner les schémas Doctrine et SQL symfony console doctrine:migrations:migrate permet d\u0026rsquo;exécuter toutes les migrations qui n\u0026rsquo;auraient pas encore été exécutées https:\/\/symfony.com\/bundles\/DoctrineMigrationsBundle\/current\/index.html#usage\n⚠︎ Ces commandes ne doivent pas être utilisées sur des applications Oro\nLa commande symfony console oro:migration:dump --bundle=AppBundle \u0026gt; src\/AppBundle\/Migrations\/AppBundleInstaller.php permet de générer un fichier de migration de schéma Oro.\nhttps:\/\/doc.oroinc.com\/backend\/entities\/migration\/\n⚠︎ Ces fichiers générés peuvent avoir des lignes en trop, notamment lorsque vous avez une entité qui hérite d\u0026rsquo;une entité d\u0026rsquo;un autre bundle. Il faudra nettoyer manuellement les lignes en trop.\n⚠︎ Ces fichiers de migrations ne prennent pas en compte les champs ajoutés à l\u0026rsquo;aide des extensions (pièces jointes, assets, attributs dynamiques, etc.). Il faudra ajouter ces champs manuellement au fichier généré\n4. Conclusion Il faut d\u0026rsquo;une manière générale privilégier le lancement de commandes Oro plutôt que les commandes génériques :\nsymfony console oro:platform:update --force --timeout=0 symfony console oro:assets:install --symlink </p>",
              url: "http:\/\/tech.kiboko.fr\/kibokast\/commandes-symfony-oro\/"
            },
            
            {
              value: "SCSS dans Oro",
              label: "<p>Qu\u0026rsquo;est ce que le SCSS (et le SASS) ? Ce sont des préprocesseurs CSS\nSASS = Syntactically Awesome Style Sheets : https:\/\/sass-lang.com\/documentation\/ SCSS = Sassy CSS c\u0026rsquo;est-à-dire du CSS dans le style de SASS. Avec la version 3 de SASS, SCSS a été défini comme la syntaxe officielle.\nLa plus grande différence réside dans l’utilisation des crochets et des points-virgules.\nSASS plus proche du Yaml niveau visuel SCSS plus proche du CSS niveau visuel Outil similaire : Less http:\/\/lesscss.org\/ (basé sur du JS contrairement au Sass basé sur du Ruby)\n1. Avantages\/Inconvénients Avantages Inconvénients Plus de possibilités Le code doit être compilé Code plus clair Résolution des erreurs difficiles Frameworks étendus Effort d’apprentissage Travail avec des mixins et des variables 2. Différences entre CSS et SCSS Liste de fonctionnalités SCSS trés pratiques : https:\/\/sass-lang.com\/documentation\/at-rules\nEn voici quelqu\u0026rsquo;unes en détails.\n2.1. Utilisation de variables On peut déclarer des variables avec cette syntaxe :\n$variable: value;\nExemples :\nCSS\nbody{ color: #ffffff; font: \u0026#39;Ubuntu\u0026#39;, \u0026#39;Arial\u0026#39;, \u0026#39;Helvetica\u0026#39;, sans-serif; font-size: 18px; } SCSS\n$white: #ffffff; $ubuntu-font: \u0026#39;Ubuntu\u0026#39;, \u0026#39;Arial\u0026#39;, \u0026#39;Helvetica\u0026#39;, sans-serif; $md-font: 18px; body{ color: $white; font: $ubuntu-font; font-size: $md-font; } Trés pratique pour les couleurs, taille de typo, les fonts mais aussi pour les points de ruptures pour le responsive :\n$sm-font: 14px; $md-font: 18px; $xl-font: 22px; $grid--breakpoint-sm: 480px; $grid--breakpoint-md: 768px; $grid--breakpoint-lg: 1024px; @media (max-width: $grid--breakpoint-sm) { body { font-size: $sm-font; } } Attention on peut utiliser uniquement les variables déclarés dans le fichiers courants (sauf si on utilise des imports).\n2.2. Utilisation des imports Possibilité d\u0026rsquo;importer des fichiers SASS :\n@import \u0026#39;components\/page-container\u0026#39;; @import \u0026#39;components\/page-header\u0026#39;; @import \u0026#39;components\/page-content\u0026#39;; @import \u0026#39;components\/page-footer\u0026#39;; @import \u0026#39;components\/page-title\u0026#39;; Exemple concret :\n_variables.scss\n$sm-font: 14px; $md-font: 18px; $xl-font: 22px; style.scss\n@import \u0026#39;variables\u0026#39;; body { font-size: $sm-font; } avec ces 2 fichiers au même niveau.\n2.3. Utilisation de mixins Pour simplifier et éviter de répéter tout le temps les mêmes lignes, on peut créer des mixins :\nMixin simple\n@mixin reset-list { margin: 0; padding: 0; list-style: none; } nav ul { @include reset-list; } Mixin avec variables\n@mixin box-shadow($left, $top, $radius, $color) { box-shadow: $left $top $radius $color; -webkit-box-shadow: $left $top $radius $color; -moz-box-shadow: $left $top $radius $color; } input { @include box-shadow(10px 5px 5px red); } 2.4. Méthodologie BEM BEM = une convention CSS qui va nous aider à rendre nos classes plus compréhensibles, et ce grâce au nommage.\nBloc Elément Modificateur Exemple :\nSCSS\n.block{ background: #000; .block__element { color: #fff; } } CSS généré\n.block { background: #000; } .block .block__element { color: #fff; } SCSS avec méthodologie BEM\n.block { background-color: #000; \u0026amp;__element { color: #fff; } } CSS généré\n.block { background: #000; } .block__element { color: #fff; } Ressources externes pour avoir plus d\u0026rsquo;informations sur la méthodologie BEM :\nhttps:\/\/openclassrooms.com\/fr\/courses\/6106181-simplifiez-vous-le-css-avec-sass\/6596494-utilisez-des-selecteurs-bem-avec-sass https:\/\/medium.com\/@andrew_barnes\/bem-and-sass-a-perfect-match-5e48d9bc3894 https:\/\/www.alsacreations.com\/article\/lire\/1641-Bonnes-pratiques-en-CSS--BEM-et-OOCSS.html#bem 2. Dans Oro Documentation officiele pour l\u0026rsquo;usage front : https:\/\/doc.oroinc.com\/frontend\/storefront\/css\/\n2.1. Utilisation et déclaration Exemple d\u0026rsquo;un usage simple pour ajouter des assets .Scss pour le front :\nDans le fichier src\/AppBundle\/Resources\/views\/layouts\/montheme\/config\/assets.yml\nstyles: inputs: - \u0026#39;bundles\/app\/montheme\/scss\/settings\/global-settings.scss\u0026#39; - \u0026#39;bundles\/app\/montheme\/scss\/variables\/base-config.scss\u0026#39; - \u0026#39;bundles\/app\/montheme\/scss\/variables\/page-header-config.scss\u0026#39; - \u0026#39;bundles\/app\/montheme\/scss\/variables\/page-content-config.scss\u0026#39; - \u0026#39;bundles\/app\/montheme\/scss\/variables\/page-footer-config.scss\u0026#39; - \u0026#39;bundles\/app\/montheme\/scss\/styles.scss\u0026#39; filters: [\u0026#39;cssrewrite\u0026#39;, \u0026#39;cssmin\u0026#39;] output: \u0026#39;css\/styles.css\u0026#39; L\u0026rsquo;option filters est optionnel.\nNOTE Dans la partie inputs, il faut renseigner l\u0026rsquo;emplacement du fichier dans le répertoire \/public\/ Visible une fois avoir lancer la commande bin\/console assets:install.\n2.2. Commandes SF et Oro Source : https:\/\/doc.oroinc.com\/backend\/bundles\/platform\/AssetBundle\/\nbin\/console oro:assets:build : cette command lance webpack pour construire les assets. (et donc compiler le SCSS en CSS)\nEn mode dév., la commande créé les ressources sans minification et avec les fichiers sources. En mode production, les ressources sont minifiées et n\u0026rsquo;incluent pas les fichiers sources. Use Commands\noro:assets:build [-w|\u0026ndash;watch] [-i|\u0026ndash;npm-install] [\u0026ndash;] []\noro:assets:build admin.oro to build assets only for the default management-console theme called admin.oro\noro:assets:build default --watch to build assets only for the blank theme with enabled watch mode\noro:assets:build default -skip-js to build assets without JS\nNOTE Lorsque vous utilisez le mode \u0026ldquo;Watch\u0026rdquo; après avoir modifié la configuration dans le fichier assets.yml, il est nécessaire de redémarrer la commande ; sinon, il ne détectera pas les changements.\n</p>",
              url: "http:\/\/tech.kiboko.fr\/kibokast\/scss-dans-oro\/"
            },
            
            {
              value: "Les processus dans Oro",
              label: "<p>Qu\u0026rsquo;est ce qu\u0026rsquo;un processus dans Oro ? Les Processes permettent d\u0026rsquo;effectuer des tâches automatique lorsqu\u0026rsquo;une entité du système est créé, modifiée ou supprimée.\nDoc. officielle : https:\/\/doc.oroinc.com\/backend\/entities-data-management\/processes\/\nLes processus offrent la possibilité d\u0026rsquo;automatiser les tâches liées à la gestion des entités. Ils utilisent les principaux événements de doctrine pour exécuter les tâches décrites au bon moment. Chaque processus peut être exécuté immédiatement ou après un délai. Les processus utilisent le composant OroMessageQueue et le bundle pour offrir la possibilité d\u0026rsquo;une exécution retardée. (traduit depuis Oro)\nExemple d\u0026rsquo;utilisation : lorsqu\u0026rsquo;une commande est créé (l\u0026rsquo;entité \\Order\\Bundle\\OrderBundle\\Entity\\Order) celle-ci est envoyé à un ERP.\nOro Processess Bundle OroWorkflowBundle Fonctionnalité allégée par rapport aux Workflows Repose sur les entités de l\u0026rsquo;ORM de Doctrine et ses événements \u002b Components d\u0026rsquo;OroPlatform Définit dans un fichier \u0026lt;MyBundle\u0026gt;\/Resources\/config\/oro\/processes.yml Avantages \/ inconvénients Les plus :\nfacile à mettre en place et à comprendre pour des tâches assez simple peu, voir pas de code nécessaire Les moins :\ncompliqué à débugger : création d\u0026rsquo;un job, puis placement de breakpoints dans les actions ou conditions correspondantes Format du fichier Processes.yml Constituté de 2 sections principales :\ndéfinition : label, actif ou non, préconditions, actions trigger (le déclencheur) : par le bias d\u0026rsquo;un cron, via doctrine persistance (create, update, delete), avec retard ou immédiatement, dans le messaque queue ou non Exemple\nDans le bundle Order : https:\/\/github.com\/oroinc\/orocommerce\/blob\/master\/src\/Oro\/Bundle\/OrderBundle\/Resources\/config\/oro\/processes.yml\nCommandes Pour charger la configuration des processus Commande à éxécuter dès qu\u0026rsquo;on modifie un fichier processess.yml\nbin\/console oro:process:configuration:load\nThis command loads processes configuration from .yml configuration files to the database. It is used during application installation and update. The command has two optional options:\n–directories - this option specifies directories used to find configuration files (multiple values allowed)\n–definitions - this option specifies names of the process definitions that should be loaded (multiple values allowed)\nPour débugger les actions et conditions bin\/console oro:debug:action : Commande pour débugger les différentes actions et les paramètres à utiliser, fournit la liste des actions disponibles\nbin\/console oro:debug:condition : Commande pour débugger les différentes conditions, fournit la liste des conditions disponibles\nDoc. officielle : https:\/\/doc.oroinc.com\/backend\/entities-data-management\/actions\/commands\/\nActions : tag \u0026ldquo;name: oro_action.action\u0026rdquo; Conditions : tag \u0026ldquo;name: oro_condition.condition\u0026rdquo; Note : également présent dans les Workflows\nDétails et débug Différences entre $ \u0026amp; $. $= Entité en cours Ex: $ = \\Order\\Bundle\\OrderBundle\\Entity\\Order\n$.= ProcessData = données contextuelles du process en cours Comment débugger ? Activé xdebug Créer un job dans la table oro_process_job Chercher l\u0026rsquo;action ou la condition à débugger (cf commandes en fin de présentation) Lancer bin\/console oro:process:handle-trigger --id=\u0026lt;ID\u0026gt; --name=\u0026lt;PROCESS_NAME\u0026gt; Source : Présentation effectuée par Sylvain Rayé, Diglin\n</p>",
              url: "http:\/\/tech.kiboko.fr\/kibokast\/processus\/"
            },
            
            {
              value: "Autoloading",
              label: "<p>Lors de l\u0026rsquo;initialisation, l\u0026rsquo;extension crée une suite de tests avec un nom de bundle si un répertoire Tests\/Behat\/Features existe dans un bundle. Ainsi, si le bundle n\u0026rsquo;a pas de répertoire Features - aucune suite de tests ne sera créée ce bundle.\nSi vous avez besoin de certaines étapes de fonctionnalité spécifiques pour votre bundle, créez la classe AcmeDemoBundle\\Tests\\Behat\\Context\\FeatureContext. Ce contexte est ajouté à la suite avec les contextes courants.La liste complète du contexte commun est configurée dans le fichier de configuration behat sous la clé shared_contexts.\nVous pouvez configurer manuellement la suite de tests pour un bundle dans la configuration de l\u0026rsquo;application behat:\ndefault: \u0026amp;default suites: AcmeDemoBundle: type: symfony_bundle bundle: AcmeDemoBundle contexts: - Oro\\Bundle\\TestFrameworkBundle\\Tests\\Behat\\Context\\OroMainContext - OroDataGridBundle::GridContext - AcmeDemoBundle::FeatureContext paths: - \u0026#39;vendor\/Acme\/DemoBundle\/Tests\/Behat\/Features\u0026#39; ou dans une configuration de bundle behat {BundleName}\/Tests\/Behat\/behat.yml :\noro_behat_extension: suites: AcmeDemoBundle: contexts: - Oro\\Bundle\\TestFrameworkBundle\\Tests\\Behat\\Context\\OroMainContext - OroDataGridBundle::GridContext - AcmeDemoBundle::FeatureContext paths: - \u0026#39;@AcmeDemoBundle\/Tests\/Behat\/Features\u0026#39; Les suites de test configurées manuellement ne sont pas chargées automatiquement par l\u0026rsquo;extension.\n</p>",
              url: "http:\/\/tech.kiboko.fr\/oro\/test\/behat\/behat-autoloading\/"
            },
            
            {
              value: "Configuration",
              label: "<p>Préparation de l\u0026rsquo;environnement :\nUtilisez la configuration par défaut de l\u0026rsquo;application installée en mode production. Si aucun serveur de messagerie n\u0026rsquo;est configuré localement, définissez le paramètre mailer_transport dans parameters.yml sur null.\nConfiguration de Behat\nLa configuration de base se trouve dans behat.yml.dist. Chaque application possède son propre fichier behat.yml.dist à la racine du répertoire de l\u0026rsquo;application. Créez votre behat.yml (il est ignoré par git automatiquement et n\u0026rsquo;est jamais validé dans le référentiel distant), importez la configuration de base et modifiez-la pour l\u0026rsquo;adapter à votre environnement:\nconfiguration en local, sans docker yaml imports: - .\/behat.yml.dist default: \u0026amp;default extensions: \u0026amp;default_extensions Behat\\MinkExtension: browser_name: chrome base_url: \u0026#34;http:\/\/localhost:8010\u0026#34; configuration avec la stack docker kiboko imports: - .\/behat.yml.dist default: \u0026amp;default extensions: \u0026amp;default_extensions Behat\\MinkExtension: browser_name: chrome base_url: \u0026#39;http:\/\/http\u0026#39; default_session: \u0026#39;first_session\u0026#39; sessions: second_session: oroSelenium2: wd_host: \u0026#39;http:\/\/localhost:4444\/wd\/hub\u0026#39; capabilities: browser: chrome extra_capabilities: browser: chrome chromeOptions: w3c: false first_session: oroSelenium2: wd_host: \u0026#39;http:\/\/localhost:4444\/wd\/hub\u0026#39; capabilities: browser: chrome extra_capabilities: browser: chrome chromeOptions: w3c: false system_session: oroSelenium2: wd_host: \u0026#39;http:\/\/localhost:4444\/wd\/hub\u0026#39; capabilities: browser: chrome extra_capabilities: browser: chrome chromeOptions: w3c: false 320_session: oroSelenium2: wd_host: \u0026#39;http:\/\/localhost:4444\/wd\/hub\u0026#39; capabilities: extra_capabilities: chromeOptions: w3c: false 640_session: oroSelenium2: wd_host: \u0026#39;http:\/\/localhost:4444\/wd\/hub\u0026#39; capabilities: extra_capabilities: chromeOptions: w3c: false !!! =\u0026gt; Configurer votre parameters.yml avec le search engine en orm et dbal pour les messages\nInstallation Etat de l\u0026rsquo;application initiale Dans Oro, l\u0026rsquo;état initial est celui lorsque l\u0026rsquo;application est installé sans données de démonstration. Les scénarios qui testent des fonctionnalités doivent s\u0026rsquo;appuyer sur cet état et doivent créer toutes les données nécessaires à des vérifications supplémentaires. Les données peuvent être créées par les étapes du scénario.\nInstallez l\u0026rsquo;application en anglais, sans données de démonstration en mode production, sans rabbit et elastic à l\u0026rsquo;aide de la commande suivante:\nbin\/console oro:install --drop-database --user-name=admin --user-email=admin@example.com \\ --application-url=http:\/\/localhost:8010 --user-firstname=John --user-lastname=Doe \\ --user-password=admin --organization-name=ORO --env=prod --sample-data=n --timeout=3000 \\ --formatting-code=en --language=en Installation des outils de test en local, sans la stack docker : Pour exécuter des scénarios qui utilisent les fonctionnalités de l\u0026rsquo;application Oro, exécutez le navigateur WebKit (à l\u0026rsquo;aide de ChromeDriver). Pour installer ChromeDriver, exécutez les commandes suivantes:\nLINUX :\nCHROME_DRIVER_VERSION=$(curl -sS chromedriver.storage.googleapis.com\/LATEST_RELEASE) mkdir -p \u0026#34;$HOME\/chrome\u0026#34; || true wget \u0026#34;http:\/\/chromedriver.storage.googleapis.com\/${CHROME_DRIVER_VERSION}\/chromedriver_linux64.zip\u0026#34; -O \u0026#34;$HOME\/chrome\/chromedriver_linux64_${CHROME_DRIVER_VERSION}.zip\u0026#34; unzip \u0026#34;$HOME\/chrome\/chromedriver_linux64_${CHROME_DRIVER_VERSION}.zip\u0026#34; -d \u0026#34;$HOME\/chrome\u0026#34; sudo ln -s \u0026#34;$HOME\/chrome\/chromedriver\u0026#34; \/usr\/local\/bin\/chromedriver MAC :\nbrew cask install chromedriver\nInstallation des outils de test avec la stack docker : version: \u0026#39;2.2\u0026#39; services: mailcatcher: image: schickling\/mailcatcher:latest ports: - ${MAILCATCHER_PORT}:1080 sql: image: postgres:9.6-alpine ports: - ${SQL_PORT}:5432 environment: - POSTGRES_USER - POSTGRES_DB - POSTGRES_PASSWORD - POSTGRES_ROOT_PASSWORD volumes: - .\/.docker\/postgres@9.6\/sql\/uuid-ossp.sql:\/docker-entrypoint-initdb.d\/00-uuid-ossp.sql:ro - .\/.docker\/postgres@9.6\/custom-sql\/:\/docker-entrypoint-initdb.d\/custom-sql\/ - database:\/var\/lib\/postgresql\/data restart: on-failure http: image: nginx:alpine volumes: - .\/.docker\/nginx@1.15\/config\/options.conf:\/etc\/nginx\/conf.d\/000-options.conf - .\/.docker\/nginx@1.15\/config\/reverse-proxy.conf:\/etc\/nginx\/conf.d\/default.conf - .\/:\/var\/www\/html - cache:\/var\/www\/html\/var\/cache:ro - assets:\/var\/www\/html\/public\/bundles:ro restart: on-failure ports: - ${HTTP_PORT}:80 depends_on: - http-worker-prod - http-worker-dev - http-worker-xdebug http-worker-prod: image: nginx:alpine volumes: - .\/.docker\/nginx@1.15\/config\/options.conf:\/etc\/nginx\/conf.d\/000-options.conf - .\/.docker\/nginx@1.15\/config\/vhost-prod.conf:\/etc\/nginx\/conf.d\/default.conf - .\/:\/var\/www\/html - cache:\/var\/www\/html\/var\/cache:delegated - assets:\/var\/www\/html\/public\/bundles:delegated restart: on-failure depends_on: - fpm http-worker-dev: image: nginx:alpine volumes: - .\/.docker\/nginx@1.15\/config\/options.conf:\/etc\/nginx\/conf.d\/000-options.conf - .\/.docker\/nginx@1.15\/config\/vhost-dev.conf:\/etc\/nginx\/conf.d\/default.conf - .\/:\/var\/www\/html - cache:\/var\/www\/html\/var\/cache:ro - assets:\/var\/www\/html\/public\/bundles:ro restart: on-failure depends_on: - fpm http-worker-xdebug: image: nginx:alpine volumes: - .\/.docker\/nginx@1.15\/config\/options.conf:\/etc\/nginx\/conf.d\/000-options.conf - .\/.docker\/nginx@1.15\/config\/vhost-xdebug.conf:\/etc\/nginx\/conf.d\/default.conf - .\/:\/var\/www\/html - cache:\/var\/www\/html\/var\/cache:ro - assets:\/var\/www\/html\/public\/bundles:ro restart: on-failure depends_on: - fpm-xdebug fpm: image: kiboko\/php:7.2-fpm-blackfire-orocommerce-ee-3.1-postgresql user: docker:docker volumes: - .\/:\/var\/www\/html - cache:\/var\/www\/html\/var\/cache - assets:\/var\/www\/html\/public\/bundles environment: - \u0026#34;I_AM_DEVELOPER_DISABLE_INDEX_IP_CHECK=\u0026#34; - BLACKFIRE_CLIENT_ID - BLACKFIRE_CLIENT_TOKEN restart: on-failure fpm-xdebug: image: kiboko\/php:7.2-fpm-xdebug-orocommerce-ee-3.1-postgresql user: docker:docker volumes: - .\/:\/var\/www\/html - cache:\/var\/www\/html\/var\/cache - assets:\/var\/www\/html\/public\/bundles environment: - \u0026#34;I_AM_DEVELOPER_DISABLE_INDEX_IP_CHECK=\u0026#34; restart: on-failure blackfire: image: blackfire\/blackfire environment: - BLACKFIRE_SERVER_ID - BLACKFIRE_SERVER_TOKEN sh: build: context: .docker\/sh@7.2\/ user: docker:docker volumes: - $HOME\/.ssh:\/opt\/docker\/.ssh:cached - .\/:\/var\/www\/html - cache:\/var\/www\/html\/var\/cache - assets:\/var\/www\/html\/public\/bundles - composer:\/opt\/docker\/.composer\/:cached environment: - COMPOSER_AUTH - COMPOSER_PROCESS_TIMEOUT - BLACKFIRE_CLIENT_ID - BLACKFIRE_CLIENT_TOKEN - HOME=\/var\/www\/html command: [ \u0026#34;sleep\u0026#34;, \u0026#34;31536000\u0026#34; ] restart: \u0026#34;always\u0026#34; sh-xdebug: image: kiboko\/php:7.2-cli-xdebug-orocommerce-ee-3.1-postgresql user: docker:docker volumes: - $HOME\/.ssh:\/opt\/docker\/.ssh:cached - .\/:\/var\/www\/html - cache:\/var\/www\/html\/var\/cache - assets:\/var\/www\/html\/public\/bundles - composer:\/opt\/docker\/.composer\/ environment: - COMPOSER_AUTH - COMPOSER_PROCESS_TIMEOUT command: [ \u0026#34;sleep\u0026#34;, \u0026#34;31536000\u0026#34; ] restart: \u0026#34;always\u0026#34; mq: image: kiboko\/php:7.2-cli-blackfire-orocommerce-ee-3.1-postgresql user: docker:docker volumes: - .\/:\/var\/www\/html - cache:\/var\/www\/html\/var\/cache - assets:\/var\/www\/html\/public\/bundles command: [ \u0026#34;bin\/console\u0026#34;, \u0026#34;oro:message-queue:consume\u0026#34;, \u0026#34;--env=prod\u0026#34;, \u0026#34;-vv\u0026#34; ] restart: \u0026#34;always\u0026#34; ws: image: kiboko\/php:7.2-cli-blackfire-orocommerce-ee-3.1-postgresql user: docker:docker volumes: - .\/:\/var\/www\/html - cache:\/var\/www\/html\/var\/cache - assets:\/var\/www\/html\/public\/bundles command: [ \u0026#34;bin\/console\u0026#34;, \u0026#34;gos:websocket:server\u0026#34;, \u0026#34;--env=prod\u0026#34;, \u0026#34;-vv\u0026#34; ] ports: - ${WEBSOCKET_PORT}:8080 restart: \u0026#34;always\u0026#34; elasticsearch: image: \u0026#39;docker.elastic.co\/elasticsearch\/elasticsearch-oss:6.5.4\u0026#39; environment: - cluster.name=docker-cluster - bootstrap.memory_lock=true - \u0026#34;ES_JAVA_OPTS=-Xms512m -Xmx512m\u0026#34; - discovery.type=single-node - http.port=9200 - http.cors.allow-origin=http:\/\/localhost:${DEJAVU_PORT},http:\/\/127.0.0.1:${DEJAVU_PORT},http:\/\/192.168.64.4:${DEJAVU_PORT},http:\/\/dejavu:${DEJAVU_PORT},http:\/\/host.docker.internal:${DEJAVU_PORT} - http.cors.enabled=true - http.cors.allow-headers=X-Requested-With,X-Auth-Token,Content-Type,Content-Length,Authorization - http.cors.allow-credentials=true ports: - ${ELASTICSEARCH_PORT}:9200 volumes: - elasticsearch:\/usr\/share\/elasticsearch\/data - .\/.docker\/elasticsearch\/elasticsearch.yml:\/usr\/share\/elasticsearch\/config\/elasticsearch.yml restart: on-failure dejavu: image: appbaseio\/dejavu ports: - ${DEJAVU_PORT}:1358 amqp: build: context: .docker\/rabbitmq@3.6 ports: - ${RABBITMQ_AMQP_PORT}:5672 - ${RABBITMQ_MANAGER_PORT}:15672 environment: - RABBITMQ_DEFAULT_USER=${RABBITMQ_USER} - RABBITMQ_DEFAULT_PASS=${RABBITMQ_PASSWORD} restart: on-failure redis: build: context: .docker\/redis@5\/ restart: on-failure ports: - ${REDIS_PORT}:6379 chrome: image: selenium\/node-chrome:3.141.59-oxygen volumes: - \/dev\/shm:\/dev\/shm depends_on: - hub environment: HUB_HOST: hub firefox: image: selenium\/node-firefox:3.141.59-20200525 volumes: - \/dev\/shm:\/dev\/shm depends_on: - hub environment: HUB_HOST: hub opera: image: selenium\/node-opera:3.141.59-20200525 volumes: - \/dev\/shm:\/dev\/shm depends_on: - hub environment: HUB_HOST: hub hub: image: selenium\/hub:3.141.59-20200525 ports: - ${HUB_PORT}::4444 volumes: database: driver: local elasticsearch: driver: local composer: driver: local driver_opts: type: tmpfs device: tmpfs o: \u0026#34;size=2048m,uid=1001,gid=1002\u0026#34; assets: driver: local driver_opts: type: tmpfs device: tmpfs o: \u0026#34;size=2048m,uid=1001,gid=1002\u0026#34; cache: driver: local driver_opts: type: tmpfs device: tmpfs o: \u0026#34;size=2048m,uid=1001,gid=1002\u0026#34; Lancement des outils de tests en local, sans docker Conditions préalables\nExécutez ChromeDriver: chromedriver --url-base=wd\/hub --port=4444 \u0026gt; \/tmp\/driver.log 2\u0026gt;\u0026amp;1\nPour exécuter ChromeDriver en arrière-plan, ajoutez le symbole esperluette (\u0026amp;) à la fin de la ligne, comme dans les exemples suivants:\nchromedriver --url-base=wd\/hub --port=4444 \u0026gt; \/tmp\/driver.log 2\u0026gt;\u0026amp;1 \u0026amp;\nLancer un serveur sur le port spécifié pour l\u0026rsquo;installation (ici 8010 ), avec apache, nginx, ou juste le serveur symfony de base Execution des tests Avant de commencer, il est fortement recommandé de vous familiariser avec les arguments et les options de Behat. Exécutez bin\/behat --help pour une description détaillée.\nLorsque l\u0026rsquo;application Oro est installée sans données de démonstration et est en cours d\u0026rsquo;exécution, et que ChromeDriver est en cours d\u0026rsquo;exécution, vous pouvez commencer à exécuter les tests behat par fonctionnalité à partir de la racine de l\u0026rsquo;application.\nVous pouvez utiliser l\u0026rsquo;une des commandes suivantes.\nExécutez le scénario de test des fonctionnalités:\nbin\/behat vendor\/oro\/platform\/src\/Oro\/Bundle\/UserBundle\/Tests\/Behat\/Features\/login.feature -vvv\nAperçu de toutes les étapes de fonctionnalité disponibles:\nbin\/behat -dl -s OroUserBundle\nVoir les étapes avec une description complète et des exemples:\nbin\/behat -di -s OroUserBundle\nChaque bundle a sa suite de tests dédiée qui peut être exécutée séparément:\nbin\/behat -s OroUserBundle\n</p>",
              url: "http:\/\/tech.kiboko.fr\/oro\/test\/behat\/behat-configuration\/"
            },
            
            {
              value: "Conventions",
              label: "<p>Conventions Utilisez le mapping de formulaire au lieu de sélecteurs dans vos scénarios pour les garder clairs et compréhensibles pour les personnes du monde technique et non technique.\nExemples Ne pas utiliser des selecteurs CSS dans le test:\nI fill in \u0026#34;oro_workflow_definition_form[label]\u0026#34; with \u0026#34;User Workflow Test\u0026#34; I fill in \u0026#34;oro_workflow_definition_form[related_entity]\u0026#34; with \u0026#34;User\u0026#34; Mais utilisez plutôt des raccourcis:\nAnd I fill \u0026#34;Workflow Edit Form\u0026#34; with: | Name | User Workflow Test | | Related Entity | User | Que vous définnissez dans le fichier yml :\nWorkflow Edit Form: selector: \u0026#39;form[name=\u0026#34;oro_workflow_definition_form\u0026#34;]\u0026#39; class: Oro\\Bundle\\TestFrameworkBundle\\Behat\\Element\\Form options: mapping: Name: \u0026#39;oro_workflow_definition_form[label]\u0026#39; Related Entity: \u0026#39;oro_workflow_definition_form[related_entity]\u0026#39; Utilisez des menu et des liens pour obtenir les bonnes pages au lieu de l\u0026rsquo;URL de la page directe\nFaire :\nAnd I open User Index page Et non pas :\nAnd I go to \u0026#34;\/users\u0026#34; Évitez la redondance des scénarios (par exemple, en répétant la même séquence d\u0026rsquo;étapes, comme la connexion, dans plusieurs scénarios). Pour cela chainez vos tests dans un ordre logique.\nNommer les éléments dans le style camelCase sans espaces Vous pouvez toujours vous y référer en utilisant le style camelCase avec des espaces dans les scénarios behat. Par exemple, un élément nommé OroProductForm peut être mentionné dans l\u0026rsquo;étape du scénario comme «Oro Product From»:\n</p>",
              url: "http:\/\/tech.kiboko.fr\/oro\/test\/behat\/behat-conventions\/"
            },
            
            {
              value: "Elements form",
              label: "<p>Les elements sont le mapping entre des elements du dom utilisé par le test. Prenez une minute pour lire la base des NodeElement Mink\nTous les éléments doivent être décrits dans {BundleName} {BundleName}\/Tests\/Behat\/behat.yml de la manière suivante:\noro_behat_extension: elements: Login: selector: \u0026#39;#login-form\u0026#39; class: Oro\\Bundle\\TestFrameworkBundle\\Behat\\Element\\Form options: mapping: Username: \u0026#39;_username\u0026#39; Password: \u0026#39;_password\u0026#39; Login est un nom d\u0026rsquo;élément qui DOIT être unique. L\u0026rsquo;élément peut être créé manuellement dans un contexte par OroElementFactory par son nom: $this-\u0026gt;elementFactory-\u0026gt;createElement(\u0026#39;Login\u0026#39;); Le selector définit comment le driver Web doit trouver l\u0026rsquo;élément dans le DOM. Par défaut, lorsque le type de sélecteur n\u0026rsquo;est pas spécifié, le type css est utilisé. Le sélecteur XPath est également pris en charge et peut être fourni avec la configuration suivante: selector: type: xpath locator: \/\/span[id=\u0026#39;mySpan\u0026#39;]\/ancestor::form\/ options est un tableau d\u0026rsquo;options supplémentaires stockées dans la propriété options de la classe Element. Il est fortement recommandé de fournir une classe avec des options de mappage pour les éléments de formulaire, car cela augmente la vitesse de test et garantit un mappage de champ plus précis. Mappage des champs de formulaire Par défaut, les tests utilisent le sélecteur de champ nommé pour mapper les champs du formulaire. Le sélecteur de nom de champ peut rechercher le champ par son identifiant, son nom, son label ou son placeholder. Vous êtes libre d\u0026rsquo;utiliser n\u0026rsquo;importe quel sélecteur pour mapper des champs de formulaire ou encapsuler un élément dans l\u0026rsquo;élément behat particulier.\noro_behat_extension: elements: Payment Method Config Type Field: class: Oro\\Bundle\\PaymentBundle\\Tests\\Behat\\Element\\PaymentMethodConfigType PaymentRuleForm: selector: \u0026#34;form[id^=\u0026#39;oro_payment_methods_configs_rule\u0026#39;]\u0026#34; class: Oro\\Bundle\\TestFrameworkBundle\\Behat\\Element\\Form options: mapping: Method: type: \u0026#39;xpath\u0026#39; locator: \u0026#39;\/\/div[@id[starts-with(.,\u0026#34;uniform-oro_payment_methods_configs_rule_method\u0026#34;)]]\u0026#39; element: Payment Method Config Type Field Vous devez maintenant créer et implémenter la méthode setValue de l\u0026rsquo;Element:\n\u0026lt;?php namespace Oro\\Bundle\\PaymentBundle\\Tests\\Behat\\Element; use Oro\\Bundle\\TestFrameworkBundle\\Behat\\Element\\Element; class PaymentMethodConfigType extends Element { \/** * {@inheritdoc} *\/ public function setValue($value) { $values = is_array($value) ? $value : [$value]; foreach ($values as $item) { $parentField = $this-\u0026gt;getParent()-\u0026gt;getParent()-\u0026gt;getParent()-\u0026gt;getParent(); $field = $parentField-\u0026gt;find(\u0026#39;css\u0026#39;, \u0026#39;select\u0026#39;); self::assertNotNull($field, \u0026#39;Select payment method field not found\u0026#39;); $field-\u0026gt;setValue($item); $parentField-\u0026gt;clickLink(\u0026#39;Add\u0026#39;); $this-\u0026gt;getDriver()-\u0026gt;waitForAjax(); } } } Vous pouvez maintenant l\u0026rsquo;utiliser dans une étape standard:\nFeature: Payment Rules CRUD Scenario: Creating Payment Rule Given I login as administrator And I go to System\/ Payment Rules And I click \u0026#34;Create Payment Rule\u0026#34; When I fill \u0026#34;Payment Rule Form\u0026#34; with: | Method | PayPal | Mappages de formulaires intégrés : Parfois, un formulaire apparaît dans l\u0026rsquo;iframe. Behat peut passer à l\u0026rsquo;iframe par son identifiant. Pour remplir correctement le formulaire dans l\u0026rsquo;iframe, spécifiez l\u0026rsquo;id iframe dans les options du formulaire:\noro_behat_extension: elements: MagentoContactUsForm: selector: \u0026#39;div#page\u0026#39; class: Oro\\Bundle\\TestFrameworkBundle\\Behat\\Element\\Form options: embedded-id: embedded-form mapping: First name: \u0026#39;oro_magento_contactus_contact_request[firstName]\u0026#39; Last name: \u0026#39;oro_magento_contactus_contact_request[lastName]\u0026#39; ELement de page L\u0026rsquo;élément Page encapsule la page Web entière avec son URL et son chemin d\u0026rsquo;accès à la page. Chaque élément Page doit étendre Oro\\Bundle\\TestFrameworkBundle\\Behat\\Element\\Page.\nExemple de Configuration de Page :\noro_behat_extension: pages: UserProfileView: class: Oro\\Bundle\\UserBundle\\Tests\\Behat\\Page\\UserProfileView route: \u0026#39;oro_user_profile_view\u0026#39; Exemple de classe de page:\nnamespace Oro\\Bundle\\UserBundle\\Tests\\Behat\\Page; use Oro\\Bundle\\TestFrameworkBundle\\Behat\\Element\\Page; class UserProfileView extends Page { \/** * {@inheritdoc} *\/ public function open(array $parameters = []) { $userMenu = $this-\u0026gt;elementFactory-\u0026gt;createElement(\u0026#39;UserMenu\u0026#39;); $userMenu-\u0026gt;find(\u0026#39;css\u0026#39;, \u0026#39;[data-toggle=\u0026#34;dropdown\u0026#34;]\u0026#39;)-\u0026gt;click(); $userMenu-\u0026gt;clickLink(\u0026#39;My User\u0026#39;); } } Vous pouvez maintenant utiliser plusieurs étapes significatives:\nAnd I open User Profile View page And I should be on User Profile View page </p>",
              url: "http:\/\/tech.kiboko.fr\/oro\/test\/behat\/behat-elements-form\/"
            },
            
            {
              value: "exemples",
              label: "<p>Ecrire une feature Chaque bundle doit contenir ses propres tests behat pour les fonctionnalités du répertoire {BundleName}\/Tests\/Behat\/Features\/. Chaque fonctionnalité est un fichier distinct avec l\u0026rsquo;extension .feature et une syntaxe spécifique.\nNote : Voir la doc de Cucumber pour plus d\u0026rsquo;infos.\nUne fonctionnalité commence par ce qui suit:\nLe mot clé Feature: et le nom de la fonctionnalité (ceux-ci doivent rester sur la même ligne), Une description facultative (peut être formatée sur plusieurs lignes). Une description significative est fortement recommandée. Vient ensuite le scénario de fonctionnalité - un exemple spécifique qui illustre une règle métier et se compose d\u0026rsquo;étapes séquentielles. En plus d\u0026rsquo;être une spécification de test et une documentation de test, un scénario définit les étapes de test et sert de spécification exécutable du système.\nNormalement, une étape commence par Given, When ou Then.\nS\u0026rsquo;il existe plusieurs étapes Given ou When les unes sous les autres, vous pouvez utiliser And ou But pour les organiser en groupes logiques. Cucumber ne fait pas de différence entre les mots clés, mais le choix du bon est important pour la lisibilité du scénario dans son ensemble.\nJetez un œil à la feature login login.feature dans OroUserBundle\nFeature: User login In order to login in application As an OroCRM admin I need to be able to authenticate Scenario: Success login Given I am on \u0026#34;\/user\/login\u0026#34; When I fill \u0026#34;Login Form\u0026#34; with: | Username | admin | | Password | admin | And I press \u0026#34;Log in\u0026#34; Then I should be on \u0026#34;\/\u0026#34; Scenario Outline: Fail login Given I am on \u0026#34;\/user\/login\u0026#34; When I fill \u0026#34;Login Form\u0026#34; with: | Username | \u0026lt;login\u0026gt; | | Password | \u0026lt;password\u0026gt; | And I press \u0026#34;Log in\u0026#34; Then I should be on \u0026#34;\/user\/login\u0026#34; And I should see \u0026#34;Invalid user name or password.\u0026#34; Examples: | login | password | | user | pass | | user2 | pass2 | La ligne Feature: User login démarre la fonctionnalité et lui donne un titre. Behat n\u0026rsquo;analyse pas les trois lignes de texte suivantes: In order to\u0026hellip; As an\u0026hellip; I need to\u0026hellip; Ces lignes fournissent un contexte lisible par l\u0026rsquo;homme aux personnes qui réviseront ou modifieront cette fonctionnalité. Ils décrivent la valeur commerciale dérivée de l\u0026rsquo;inclusion de la fonctionnalité dans le logiciel. La ligne Scenario: Success login démarre le scénario et fournit une description. Les six lignes suivantes représentent les étapes du scénario. Chaque étape correspond à une expression régulière définie dans le contexte. La ligne Scenario Outline: Fail login démarre le scénario suivant. Dans le plan du scénario, les placeholders sont utilisés à la place des valeurs réelles et les valeurs pour l\u0026rsquo;exécution du scénario sont fournies sous la forme d\u0026rsquo;un ensemble d\u0026rsquo;exemples sous le plan. Le scénario vous aide à exécuter ces étapes plusieurs fois, en parcourant les valeurs fournies dans la section Exemples: et en testant ainsi le même flux avec des entrées différentes. Le plan du scénario est un modèle qui n\u0026rsquo;est jamais exécuté seul. Au lieu de cela, un scénario qui suit un plan s\u0026rsquo;exécute une fois pour chaque ligne dans la section Exemples: en dessous (à l\u0026rsquo;exception de la première ligne d\u0026rsquo;en-tête qui est ignorée). Considérez un espace réservé comme une variable. Il est remplacé par une valeur réelle depuis Exemples:, où le texte entre les crochets d\u0026rsquo;angle de l\u0026rsquo;espace réservé (par exemple, ) correspond au texte de l\u0026rsquo;en-tête de la colonne du tableau (par exemple, login). </p>",
              url: "http:\/\/tech.kiboko.fr\/oro\/test\/behat\/behat-exemples\/"
            },
            
            {
              value: "Fixtures",
              label: "<p>Feature Fixtures : Chaque fois que behat exécute une nouvelle fonctionnalité, l\u0026rsquo;état de l\u0026rsquo;application est réinitialisé par défaut : il n\u0026rsquo;y a qu\u0026rsquo;un seul utilisateur administrateur, une organisation, une unité commerciale et des rôles par défaut dans la base de données.\nLes tests de fonctionnalités doivent s\u0026rsquo;appuyer sur les données disponibles dans l\u0026rsquo;application après l\u0026rsquo;exécution de la commande oro: install. Dans la plupart des cas, cela ne suffit pas.\nAinsi, vous avez deux façons d\u0026rsquo;obtenir plus de données dans le système: en utilisant des fixtures de base ou des fixtures alice.\nFixtures basiques Vous pouvez créer un nombre quelconque d\u0026rsquo;entités dans les tests de fonctionnalités. FixtureContext devine la classe d\u0026rsquo;entité, crée le nombre nécessaire d\u0026rsquo;objets et utilise faker pour remplir les champs requis lorsque leur valeur n\u0026rsquo;a pas été spécifiée explicitement.\nVous utilisez à la fois les références faker et les références d\u0026rsquo;entité dans les appareils en ligne.\nGiven the following contacts: | First Name | Last Name | Email | | Joan | Anderson | \u0026lt;email()\u0026gt; | | Craig | Bishop | \u0026lt;email()\u0026gt; | | Jean | Castillo | \u0026lt;email()\u0026gt; | | Willie | Chavez | \u0026lt;email()\u0026gt; | | Arthur | Fisher | \u0026lt;email()\u0026gt; | | Wanda | Ford | \u0026lt;email()\u0026gt; | And I have 5 Cases And there are 5 calls And there are two users with their own 7 Accounts And there are 3 users with their own 3 Tasks And there is user with its own Account Fixtures Alice Parfois, vous avez besoin de nombreuses entités différentes avec des relations complexes. Dans de tels cas, vous pouvez utiliser des fixtures Alice. Alice est une bibliothèque qui vous permet de créer facilement des fixtures au format yml.\nNOTE : Voir la documentation d\u0026rsquo;Alice pour plus d\u0026rsquo;informations.\nLes fixtures doivent être situés dans le répertoire {BundleName}\/Tests\/Behat\/Features\/Fixtures. Pour charger une fixture avant l\u0026rsquo;exécution des tests de fonctionnalité, ajoutez une balise (annotation) qui est construite à l\u0026rsquo;aide de la convention suivante @fixture-BundleName:fixture_file_name.yml, par exemple:\n@fixture-OroCRMBundle:mass_action.yml Feature: Mass Delete records Il est également possible de charger des fixtures pour tout autre bundle disponible pour l\u0026rsquo;application.\nPar exemple:\n@fixture-OroUserBundle:user.yml @fixture-OroOrganizationBundle:BusinessUnit.yml Feature: Adding attributes for workflow transition De plus, Alice vous permet d\u0026rsquo;inclure des fichiers via l\u0026rsquo;extension, vous pouvez donc importer des fichiers à partir d\u0026rsquo;autres bundles:\ninclude: - \u0026#39;@OroCustomerBundle\/Tests\/Behat\/Features\/Fixtures\/CustomerUserAmandaRCole.yml\u0026#39; Vous devez toujours inclure les fixtures d\u0026rsquo;autres bundles avec des entités qui ont été déclarées dans ce bundle\nRéférences d\u0026rsquo;entités Vous pouvez utiliser des références aux entités dans les fixtures de base et alice.\n{Bundle}\\Tests\\Behat\\ReferenceRepositoryInitializer est utilisé pour créer des références pour des objets qui existent déjà dans la base de données.\nIl est interdit de modifier ou d\u0026rsquo;ajouter de nouvelles entités dans le Initializer. Il doit implémenter ReferenceRepositoryInitializerInterface et ne doit pas avoir de dépendances. Pour afficher toutes les références, utilisez la commande bin\/behat --available-references. Les références les plus utilisées sont:\n@admin - Utilisateur Admin @adminRole - Administrator role @organization - Default organization @business_unit - Default business unit </p>",
              url: "http:\/\/tech.kiboko.fr\/oro\/test\/behat\/behat-fixtures\/"
            },
            
            {
              value: "Isolation",
              label: "<p>Chaque fonctionnalité peut interagir avec l\u0026rsquo;application et effectuer des opérations CRUD. Par conséquent, la base de données peut être modifiée. Pour éviter les collisions de données, les fonctionnalités sont isolées: la base de données et les répertoires de cache sont vidés avant d\u0026rsquo;exécuter les tests de fonctionnalités; ils sont restaurés une fois l\u0026rsquo;exécution des tests de fonctionnalités terminée.\nChaque isolateur doit implémenter l\u0026rsquo;interface Oro\\Bundle\\TestFrameworkBundle\\Behat\\Isolation\\IsolatorInterface et le tag \u0060oro_behat.isolator avec de la priorité.\nDésactiver l\u0026rsquo;isolation des fonctionnalités Vous pouvez désactiver l\u0026rsquo;isolation des fonctionnalités en ajoutant l\u0026rsquo;option -skip-isolators=database,cache à la commande console behat. Dans ce cas, la combinaison des tests de fonctionnalité peut s\u0026rsquo;exécuter beaucoup plus rapidement, mais la logique de test doit se soucier de la cohérence de la base de données et du cache.\n</p>",
              url: "http:\/\/tech.kiboko.fr\/oro\/test\/behat\/behat-isolation\/"
            },
            
            {
              value: "Symfony",
              label: "<p>Behat est une application console Symfony avec son propre conteneur et ses propres services. Un conteneur Behat peut être configuré via des extensions en utilisant behat.yml à la racine du répertoire d\u0026rsquo;application. Le conteneur d\u0026rsquo;application peut être utilisé par le noyau injecté dans votre contexte après avoir implémenté KernelAwareContext et utilisé le trait KernelDictionary.\nuse Behat\\Symfony2Extension\\Context\\KernelAwareContext; use Behat\\Symfony2Extension\\Context\\KernelDictionary; use Oro\\Bundle\\TestFrameworkBundle\\Behat\\Context\\OroFeatureContext; class FeatureContext extends OroFeatureContext implements KernelAwareContext { use KernelDictionary; public function useContainer() { $doctrine = $this-\u0026gt;getContainer()-\u0026gt;get(\u0026#39;doctrine\u0026#39;); } } De plus, vous pouvez injecter des services dans le contexte behat:\noro_behat_extension: suites: OroCustomerAccountBridgeBundle: contexts: - OroImportExportBundle::ImportExportContext: - \u0026#39;@oro_entity.entity_alias_resolver\u0026#39; - \u0026#39;@oro_importexport.processor.registry\u0026#39; </p>",
              url: "http:\/\/tech.kiboko.fr\/oro\/test\/behat\/behat-symfony\/"
            },
            
            {
              value: "Tester avec Oro",
              label: "<p>Oro propose différents frameworks de test à l\u0026rsquo;heure actuel.\nLes Tests unitaires et fonctionnels avec PHP pour tester une ou plusieurs classes en particulier. Les Tests Behat pour tester votre application par un robot comme pourrait le faire un humain. Les Tests Javascript pour tester vos vues\/composants JS. La documentation original est publié ici : Doc original\n</p>",
              url: "http:\/\/tech.kiboko.fr\/oro\/test\/"
            },
            
            {
              value: "Tests Behat",
              label: "<p>Concepts Les informations ci-dessous résume les concepts et les outils qui sont importants pour la compréhension et l’utilisation de Behat et de l\u0026rsquo;extension Behat pour Oro : OroBehatExtension.\nBehavior-driven development (BDD) est un processus de développement logiciel issu du développement axé sur les tests (TDD). Le BDD combine les techniques générales et les principes de TDD avec des idées de conception axée sur le domaine et l\u0026rsquo;analyse d\u0026rsquo;objet et du design pour fournir aux équipes de développement et de gestion de logiciels des outils partagés et un processus partagé de collaboration pour le développement de logiciels.\nBehat est un framework de développement basé sur le comportement pour PHP. Cet outil permet de décrire le comportement de l\u0026rsquo;application voulue en utilisant Php et le language de test : Gherking Vous pouvez utiliser Behat pour décrire tout ce que vous pouvez décrire dans la logique métier. Outils, applications GUI, applications Web, etc.\nMink est une extension de Behat qui vas permettre de controller un navigateur durant les tests en utilisant PHP. Il controlle des emulateurs de navigateurs(voir plus bas), un des avantages d\u0026rsquo;utiliser Mink c\u0026rsquo;est qu\u0026rsquo;il supprime les différences entres les différents emulateurs de navigateur et leurs drivers.\nWebDriver est un protocole qui permet de controller des navigateurs en JSON. Chaque navigateur est appuyé par une implémentation spécifique de WebDriver, appelée un driver\nLes drivers Mink ce sont des plugin de mink qui permettent de controller des \u0026lsquo;controlleurs\/émulateurs\u0026rsquo; de navigateurs tel que le très connu Selenium2. Dans oro, on utilise Chromedriver.\nChromeDriver est un driver de Mink comme Selenium2Driver mais ne fonctionne que pour chrome et a la particularité de fonctionner sans Selenium ce qui rend les tests plus rapides sur chrome.\nSelenium est un framework de test informatique développé en Java qui est composé de 3 grandes briques :\nSelenium WebDriver : Framework de test fonctionnel permettant l’écriture de scripts de test automatisés en different languages. Il met à disposition une API pour controller tous les navigateurs. Selenium IDE : qui permet de créer des script , sous forme d\u0026rsquo;extension chrome our firefox, pour controller des navigateurs. Selenium Grid : Qui se compose d\u0026rsquo;un hub et de nodes, permet de lancer des test sur plusieurs navigateurs en même temps. Symfony2Extension qui ajoute une intégration pour Symfony avec Behat.\nOroTestFrameworkExtension est une extension de Symfony pour intégrer Behat dans Oro, il ajoute des features tel que :\nl\u0026rsquo;autoloading des contextes, permet de construire des suites de tests spécifiques. la possibilité de déclarer des \u0026lsquo;Elements\u0026rsquo; facilement dans le fichier de config behat.yml Mapper facilement des champs de formulaires OroElementFactory est une classe qui permet de manipuler des éléments du DOM :\nhasElement($name) createElement($name, NodeElement $context = null) guessElement($name) findElementContains($name, $text, Element $context = null) findElementContainsByCss($name, $text, Element $context = null) findElementContainsByXPath($name, $text, $useChildren = true, Element $context = null) findAllElements($name, NodeElement $context = null) getPage() findElement($name, $selectorCallback, Element $context = null) et d\u0026rsquo;autre fonctions \u0026hellip;. Le contexte : Chaque phrase en Gherkin est associée à une méthode PHP grâce aux classes de contexte.La phrase est située dans une annotation au-dessus de la fonction à appeler. L’annotation peut contenir une expression rationnelle ou une phrase avec des placeholders commençant par deux points. Chaque parenthèse de capture de l’expression rationnelle ou placeholder sera un argument de la méthode PHP appelée pour exécuter la phrase du test.\nArchitecture Documentations Conventions Configuration Architecture Autoloading Isolation Elements et formulaire Fixtures Exemples d\u0026rsquo;un test behat Tips,tricks,bugfix Docs relatives (externes) Behat Gherkin Mink WebDriver MinkSelenium2Driver ChromeDriver Selenium Symfony2Extension </p>",
              url: "http:\/\/tech.kiboko.fr\/oro\/test\/behat\/"
            },
            
            {
              value: "Tests fonctionnel avec PHPUnit",
              label: "<p>Tests fonctionnels Les tests fonctionnels permettent de vérifier l’intégration des différentes couches d’une application.\nDans cet article, vous apprendrez comment vous pouvez améliorer l’expérience de la rédaction de tests fonctionnels avec Oroplatform. Il est recommandé de lire la Doc Symfony concernant les tests avant de continuer. Vous devriez également connaître PhpUnit\nQuand rédiger les tests fonctionnels Les tests fonctionnels sont généralement rédigés pour les :\nContrôleurs Commandes Dépôts Autres services\nL’objectif des tests fonctionnels n’est pas de tester des classes séparées (tests unitaires), mais de tester l’intégration des différentes parties d’une application.\nAjouter des tests fonctionnels pour compléter les tests unitaires pour les raisons suivantes :\nVous pouvez tester le système multi-composants et vous assurer qu’il fonctionne comme un tout. Vous pouvez éviter la simulation(mocking) de l’interface compliquée ou de la couche de manipulation de données (comme les classes de doctrine pour construire une requête). Les tests unitaires peuvent réussir même si les fonctionnalités ne fonctionnent pas correctement. Environnement de test Initialisation du client et avertissement quand aux chargement des fixtures Pour améliorer la performance de l’exécution du test, l’initialisation d’un client n’est effectuée qu’une seule fois par cas de test par défaut. Cela signifie que le noyau de l’application Symfony sera démarré une fois par cas de test. Les fixtures sont également chargés une seule fois par cas de test par défaut. D’une part, initialiser et charger des fixtures une fois par cas de test augmente la performance de l’exécution de test mais peut aussi causer des bugs car l’état des fixtures et du noyau (et par conséquent, le conteneur de service) sera partagé par défaut entre les méthodes de test de cas de test séparés. Assurez-vous de réinitialiser cet état si nécessaire.\nConfiguration d\u0026rsquo;un environnement de test Vous devez configurer les paramètres suivants pour l’environnement de test :\nCréer une base de données distincte pour les tests (p. ex., ajouter le suffixe « _test ») :\nConfigurez les paramètres hôte, port et authentification pour la base de données, le serveur de messagerie et le serveur de socket web dans le fichier parameters_test.yml :\nPar exemple :\n# config\/parameters_test.yml parameters: database_host: 127.0.0.1 database_port: null database_name: crm_test database_user: root database_password: null mailer_transport: smtp mailer_host: 127.0.0.1 mailer_port: null mailer_encryption: null mailer_user: null mailer_password: null session_handler: null locale: en secret: ThisTokenIsNotSoSecretChangeIt installed: false Installez l\u0026rsquo;application dans un environnement de test bin\/console oro:install \\ --env=test \\ --organization-name=Oro \\ --user-name=admin \\ --user-email=admin@example.com \\ --user-firstname=John \\ --user-lastname=Doe \\ --user-password=admin \\ --sample-data=n \\ --application-url=http:\/\/localhost Lors de l’installation, la structure de la base de données est configurée et les fixtures standard sont chargés.\nExécuter les tests en utilisant phpunit avec l’option –testsuite appropriée (unit ou functionnal). ATTENTION Actuellement, l’exécution de différents types de tests automatisés ensemble n’est pas prise en charge. Il est donc fortement déconseillé d’exécuter des tests unitaires et des tests fonctionnels côte à côte en une seule exécution, car cela produit des erreurs. Les tests unitaires créent des objets fictifs qui interfèrent ultérieurement avec l’exécution des tests fonctionnels et créent une ambiguïté inutile. Il est possible de désactiver les tests unitaires au démarrage du test à l’aide de l’option testsuite :\n$ php bin\/phpunit -c . \/ \u0026ndash;testsuite=functional $ php bin\/phpunit -c . \/ \u0026ndash;testsuite=unit\nDatabase Isolation L\u0026rsquo;annotation @dbIsolationPerTest ajoute une transaction qui sera effectuée avant le début d’un test et qui est annulée lorsqu’un test se termine.\n\/\/ src\/Oro\/Bundle\/FooBundle\/Tests\/Functional\/FooBarTest.php namespace Oro\\Bundle\\FooBundle\\Tests\\Functional; use Oro\\Bundle\\TestFrameworkBundle\\Test\\WebTestCase; \/** * @dbIsolationPerTest *\/ class FooBarTest extends WebTestCase { \/\/ ... } Chargement des data fixtures : Utilisez la méthode loadFixtures() pour charger des données dans un test :\n\/\/ src\/Oro\/Bundle\/FooBundle\/Tests\/Functional\/FooBarTest.php namespace Oro\\Bundle\\FooBundle\\Tests\\Functional; use Oro\\Bundle\\TestFrameworkBundle\\Test\\WebTestCase; class FooBarTest extends WebTestCase { protected function setUp() { $this-\u0026gt;initClient(); \/\/ must be called before! \/\/ loading fixtures will be executed once, use the second parameter \/\/ $force = true to force the loading $this-\u0026gt;loadFixtures([ \u0026#39;Oro\\Bundle\\FooBarBundle\\Tests\\Functional\\DataFixtures\\LoadFooData\u0026#39;, \u0026#39;@OroFooBarBundle\/Tests\/Functional\/DataFixtures\/bar_data.yml\u0026#39;, ]); } \/\/ ... } Un fixture doit être soit un nom de classe qui implémente Doctrine\\Common\\DataFixtures\\FixtureInterface , soit un chemin vers le fichier nelmio\/alice.\nUn exemple de fixture :\n\/\/ src\/Oro\/Bundle\/FooBarBundle\/Tests\/Functional\/DataFixtures\/LoadFooData.php namespace Oro\\Bundle\\FooBarBundle\\Tests\\Functional\\DataFixtures; use Doctrine\\Common\\DataFixtures\\AbstractFixture; use Doctrine\\Common\\Persistence\\ObjectManager; use Oro\\Bundle\\FooBarBundle\\Entity\\FooEntity; class LoadFooData extends AbstractFixture { public function load(ObjectManager $manager) { $entity = new FooEntity(); $manager-\u0026gt;persist($entity); $manager-\u0026gt;flush(); } } # src\/Oro\/Bundle\/FooBarBundle\/Tests\/Functional\/DataFixtures\/bar_data.yml Oro\\Bundle\\FooBarBundle\\Entity\\BarEntity: bar: name: test Vous pouvez également implémenter l’interfaceDoctrine\\Common\\DataFixtures\\DependentFixtureInterface qui permet de charger des fixtures en fonction des autres fixtures déjà chargées :\n\/\/ src\/Oro\/Bundle\/FooBarBundle\/Tests\/Functional\/DataFixtures\/LoadFooData.php namespace Oro\\Bundle\\FooBarBundle\\Tests\\Functional\\DataFixtures; use Doctrine\\Common\\DataFixtures\\DependentFixtureInterface; use Doctrine\\Common\\DataFixtures\\AbstractFixture; use Doctrine\\Common\\Persistence\\ObjectManager; class LoadFooData extends AbstractFixture implements DependentFixtureInterface { public function load(ObjectManager $manager) { \/\/ load fixtures } public function getDependencies() { return [\u0026#39;Oro\\Bundle\\FooBarBundle\\Tests\\Functional\\DataFixtures\\LoadBarData\u0026#39;]; } } De plus, vous pouvez utiliser des entités spécifiques aux références à partir de fixtures, par exemple :\nnamespace Oro\\Bundle\\FooBarBundle\\Tests\\Functional\\DataFixtures; use Doctrine\\Common\\Persistence\\ObjectManager; use Doctrine\\Common\\DataFixtures\\DependentFixtureInterface; use Doctrine\\Common\\DataFixtures\\AbstractFixture; use Oro\\Bundle\\FooBarBundle\\Entity\\FooEntity; class LoadFooData extends AbstractFixture implements DependentFixtureInterface { public function load(ObjectManager $manager) { $entity = new FooEntity(); $manager-\u0026gt;persist($entity); $manager-\u0026gt;flush(); $this-\u0026gt;addReference(\u0026#39;my_entity\u0026#39;, $entity); } public function getDependencies() { return [\u0026#39;Oro\\Bundle\\FooBarBundle\\Tests\\Functional\\DataFixtures\\LoadBarData\u0026#39;]; } } Maintenant, vous pouvez référencer le fixture par le nom configuré dans votre test :\n\/\/ src\/Oro\/Bundle\/FooBundle\/Tests\/Functional\/FooBarTest.php namespace Oro\\Bundle\\FooBundle\\Tests\\Functional; use Oro\\Bundle\\TestFrameworkBundle\\Test\\WebTestCase; class FooBarTest extends WebTestCase { protected $entity; protected function setUp() { $this-\u0026gt;initClient(); $this-\u0026gt;loadFixtures(\u0026#39;Oro\\Bundle\\FooBarBundle\\Tests\\Functional\\DataFixtures\\LoadFooData\u0026#39;); $this-\u0026gt;entity = $this-\u0026gt;getReference(\u0026#39;my_entity\u0026#39;); } \/\/ ... } NOTES : Par défaut, le gestionnaire d’entités est effacé après le chargement de chaque fixture. Pour éviter le nettoyage une fixture peut implémenterOro\\Bundle\\TestFrameworkBundle\\Test\\DataFixtures\\InitialFixtureInterface. Parfois, vous avez besoin d’une référence à l’Organization, d\u0026rsquo;un User ou d\u0026rsquo;une BusinessUnit. Les fixtures suivants peuvent être utilisés pour les charger : Oro\\Bundle\\TestFrameworkBundle\\Tests\\Functional\\DataFixtures\\LoadOrganization Oro\\Bundle\\TestFrameworkBundle\\Tests\\Functional\\DataFixtures\\LoadUser Oro\\Bundle\\TestFrameworkBundle\\Tests\\Functional\\DataFixtures\\LoadBusinessUnit Ecrire des test fonctionnel : Pour créer un test fonctionel :\nEtendez la classe WebTestCase Préparez une instance de la classe Client Préparez vos fixtures ( Optionnel) Préparez le container Appelez les fonctionnalitées du test 6 Vérifiez le résultat Tests fonctionnel pour les controlleurs : Un test fonctionnel pour un contrôleur se compose de quelques étapes:\nFaire une requete Tester la réponse Cliquez sur un lien ou soumettez un formulaire Test the response Nettoyer et répéter Exemples de prépraration du client : L’initialisation simple fonctionne pour tester les commandes et les services lorsque l’authentification n’est pas nécessaire.\n\/\/ src\/Oro\/Bundle\/FooBundle\/Tests\/Functional\/FooBarTest.php namespace Oro\\Bundle\\FooBundle\\Tests\\Functional; use Oro\\Bundle\\TestFrameworkBundle\\Test\\WebTestCase; class FooBarTest extends WebTestCase { protected function setUp() { $this-\u0026gt;initClient(); \/\/ initialization occurres only once per test class \/\/ now varialbe $this-\u0026gt;client is available } \/\/ ... } Initialisation avec les options Appkernel personnalisées :\n\/\/ src\/Oro\/Bundle\/FooBundle\/Tests\/Functional\/FooBarTest.php namespace Oro\\Bundle\\FooBundle\\Tests\\Functional; use Oro\\Bundle\\TestFrameworkBundle\\Test\\WebTestCase; class FooBarTest extends WebTestCase { protected function setUp() { \/\/ first array is Kernel options $this-\u0026gt;initClient([\u0026#39;debug\u0026#39; =\u0026gt; false]); } \/\/ ... } Initialisation avec authentification :\n\/\/ src\/Oro\/Bundle\/FooBundle\/Tests\/Functional\/FooBarTest.php namespace Oro\\Bundle\\FooBundle\\Tests\\Functional; use Oro\\Bundle\\TestFrameworkBundle\\Test\\WebTestCase; class FooBarTest extends WebTestCase { protected function setUp() { \/\/ second array is service options \/\/ this example will create client with server options [\u0026#39;PHP_AUTH_USER\u0026#39; =\u0026gt; \u0026#39;admin@example.com\u0026#39;, \u0026#39;PHP_AUTH_PW\u0026#39; =\u0026gt; \u0026#39;admin\u0026#39;] \/\/ make sure you loaded fixture with test user \/\/ bin\/console doctrine:fixture:load --no-debug --append --no-interaction --env=test --fixtures src\/Oro\/src\/Oro\/Bundle\/TestFrameworkBundle\/Fixtures $this-\u0026gt;initClient([], $this-\u0026gt;generateBasicAuthHeader()); \/\/ init client with custom username and password $this-\u0026gt;initClient([], $this-\u0026gt;generateBasicAuthHeader(\u0026#39;custom_username\u0026#39;, \u0026#39;custom_password\u0026#39;)); } \/\/ ... } Types de tests fonctionnels Tester les controllers \/\/ src\/OroCRM\/Bundle\/TaskBundle\/Tests\/Functional\/Controller\/TaskControllersTest.php namespace Oro\\Bundle\\TaskBundle\\Tests\\Functional\\Controller; use Oro\\Bundle\\TestFrameworkBundle\\Test\\WebTestCase; \/** * @outputBuffering enabled *\/ class TaskControllersTest extends WebTestCase { protected function setUp() { $this-\u0026gt;initClient([], $this-\u0026gt;generateBasicAuthHeader()); } public function testCreate() { $crawler = $this-\u0026gt;client-\u0026gt;request(\u0026#39;GET\u0026#39;, $this-\u0026gt;getUrl(\u0026#39;orocrm_task_create\u0026#39;)); $form = $crawler-\u0026gt;selectButton(\u0026#39;Save and Close\u0026#39;)-\u0026gt;form(); $form[\u0026#39;orocrm_task[subject]\u0026#39;] = \u0026#39;New task\u0026#39;; $form[\u0026#39;orocrm_task[description]\u0026#39;] = \u0026#39;New description\u0026#39;; $form[\u0026#39;orocrm_task[dueDate]\u0026#39;] = \u0026#39;2014-03-04T20:00:00\u002b0000\u0026#39;; $form[\u0026#39;orocrm_task[owner]\u0026#39;] = \u0026#39;1\u0026#39;; $form[\u0026#39;orocrm_task[reporter]\u0026#39;] = \u0026#39;1\u0026#39;; $this-\u0026gt;client-\u0026gt;followRedirects(true); $crawler = $this-\u0026gt;client-\u0026gt;submit($form); $result = $this-\u0026gt;client-\u0026gt;getResponse(); $this-\u0026gt;assertHtmlResponseStatusCodeEquals($result, 200); $this-\u0026gt;assertContains(\u0026#39;Task saved\u0026#39;, $crawler-\u0026gt;html()); } \/** * @depends testCreate *\/ public function testUpdate() { $response = $this-\u0026gt;client-\u0026gt;requestGrid( \u0026#39;tasks-grid\u0026#39;, [\u0026#39;tasks-grid[_filter][reporterName][value]\u0026#39; =\u0026gt; \u0026#39;John Doe\u0026#39;] ); $result = $this-\u0026gt;getJsonResponseContent($response, 200); $result = reset($result[\u0026#39;data\u0026#39;]); $crawler = $this-\u0026gt;client-\u0026gt;request( \u0026#39;GET\u0026#39;, $this-\u0026gt;getUrl(\u0026#39;orocrm_task_update\u0026#39;, [\u0026#39;id\u0026#39; =\u0026gt; $result[\u0026#39;id\u0026#39;]]) ); $form = $crawler-\u0026gt;selectButton(\u0026#39;Save and Close\u0026#39;)-\u0026gt;form(); $form[\u0026#39;orocrm_task[subject]\u0026#39;] = \u0026#39;Task updated\u0026#39;; $form[\u0026#39;orocrm_task[description]\u0026#39;] = \u0026#39;Description updated\u0026#39;; $this-\u0026gt;client-\u0026gt;followRedirects(true); $crawler = $this-\u0026gt;client-\u0026gt;submit($form); $result = $this-\u0026gt;client-\u0026gt;getResponse(); $this-\u0026gt;assertHtmlResponseStatusCodeEquals($result, 200); $this-\u0026gt;assertContains(\u0026#39;Task saved\u0026#39;, $crawler-\u0026gt;html()); } \/** * @depends testUpdate *\/ public function testView() { $response = $this-\u0026gt;client-\u0026gt;requestGrid( \u0026#39;tasks-grid\u0026#39;, [\u0026#39;tasks-grid[_filter][reporterName][value]\u0026#39; =\u0026gt; \u0026#39;John Doe\u0026#39;] ); $result = $this-\u0026gt;getJsonResponseContent($response, 200); $result = reset($result[\u0026#39;data\u0026#39;]); $this-\u0026gt;client-\u0026gt;request( \u0026#39;GET\u0026#39;, $this-\u0026gt;getUrl(\u0026#39;orocrm_task_view\u0026#39;, [\u0026#39;id\u0026#39; =\u0026gt; $result[\u0026#39;id\u0026#39;]]) ); $result = $this-\u0026gt;client-\u0026gt;getResponse(); $this-\u0026gt;assertHtmlResponseStatusCodeEquals($result, 200); $this-\u0026gt;assertContains(\u0026#39;Task updated - Tasks - Activities\u0026#39;, $result-\u0026gt;getContent()); } \/** * @depends testUpdate *\/ public function testIndex() { $this-\u0026gt;client-\u0026gt;request(\u0026#39;GET\u0026#39;, $this-\u0026gt;getUrl(\u0026#39;orocrm_task_index\u0026#39;)); $result = $this-\u0026gt;client-\u0026gt;getResponse(); $this-\u0026gt;assertHtmlResponseStatusCodeEquals($result, 200); $this-\u0026gt;assertContains(\u0026#39;Task updated\u0026#39;, $result-\u0026gt;getContent()); } } Tester les ACLs dans les controlleurs : Dans cet exemple, un utilisateur sans autorisations suffisantes essaie d’accéder à une action du contrôleur. La méthode assertHtmlResponseStatusCodeEquals() est utilisée pour s’assurer que l’accès à la ressource demandée est refusé à l’utilisateur :\nnamespace Oro\\Bundle\\UserBundle\\Tests\\Functional; use Oro\\Bundle\\UserBundle\\Tests\\Functional\\DataFixtures\\LoadUserData; use Oro\\Bundle\\TestFrameworkBundle\\Test\\WebTestCase; \/** * @outputBuffering enabled *\/ class UsersTest extends WebTestCase { protected function setUp() { $this-\u0026gt;initClient(); $this-\u0026gt;loadFixtures([\u0026#39;Oro\\Bundle\\UserBundle\\Tests\\Functional\\API\\DataFixtures\\LoadUserData\u0026#39;]); } public function testUsersIndex() { $this-\u0026gt;client-\u0026gt;request( \u0026#39;GET\u0026#39;, $this-\u0026gt;getUrl(\u0026#39;oro_user_index\u0026#39;), [], [], $this-\u0026gt;generateBasicAuthHeader(LoadUserData::USER_NAME, LoadUserData::USER_PASSWORD) ); $result = $this-\u0026gt;client-\u0026gt;getResponse(); $this-\u0026gt;assertHtmlResponseStatusCodeEquals($result, 403); } public function testGetUsersAPI() { $this-\u0026gt;client-\u0026gt;request( \u0026#39;GET\u0026#39;, $this-\u0026gt;getUrl(\u0026#39;oro_api_get_users\u0026#39;), [\u0026#39;limit\u0026#39; =\u0026gt; 100], [], $this-\u0026gt;generateWsseAuthHeader(LoadUserData::USER_NAME, LoadUserData::USER_API_KEY) ); $result = $this-\u0026gt;client-\u0026gt;getResponse(); $this-\u0026gt;assertJsonResponseStatusCodeEquals($result, 403); } } Voici un exemple de fixture qui ajoute un utilisateur sans permission :\n\/ src\/Oro\/Bundle\/UserBundle\/Tests\/Functional\/DataFixtures\/LoadUserData.php namespace Oro\\Bundle\\UserBundle\\Tests\\Functional\\DataFixtures; use Doctrine\\Common\\DataFixtures\\AbstractFixture; use Doctrine\\Common\\Persistence\\ObjectManager; use Symfony\\Component\\DependencyInjection\\ContainerAwareInterface; use Symfony\\Component\\DependencyInjection\\ContainerInterface; use Oro\\Bundle\\UserBundle\\Entity\\Role; use Oro\\Bundle\\UserBundle\\Entity\\UserApi; class LoadUserData extends AbstractFixture implements ContainerAwareInterface { const USER_NAME = \u0026#39;user_wo_permissions\u0026#39;; const USER_API_KEY = \u0026#39;user_api_key\u0026#39;; const USER_PASSWORD = \u0026#39;user_password\u0026#39;; private $container; public function setContainer(ContainerInterface $container = null) { $this-\u0026gt;container = $container; } public function load(ObjectManager $manager) { \/** @var \\Oro\\Bundle\\UserBundle\\Entity\\UserManager $userManager *\/ $userManager = $this-\u0026gt;container-\u0026gt;get(\u0026#39;oro_user.manager\u0026#39;); \/\/ Find role for user to able to authenticate in test. \/\/ You can use any available role that you want dependently on test logic. $role = $manager-\u0026gt;getRepository(Role::class) -\u0026gt;findOneBy([\u0026#39;role\u0026#39; =\u0026gt; \u0026#39;IS_AUTHENTICATED_ANONYMOUSLY\u0026#39;]); \/\/ Creating new user $user = $userManager-\u0026gt;createUser(); \/\/ Creating API entity for user, we will reference it in testGetUsersAPI method, \/\/ if you are not going to test API you can skip it $api = new UserApi(); $api-\u0026gt;setApiKey(self::USER_API_KEY) -\u0026gt;setUser($user); \/\/ Creating user $user -\u0026gt;setUsername(self::USER_NAME) -\u0026gt;setPlainPassword(self::USER_PASSWORD) \/\/ This value is referenced in testUsersIndex method -\u0026gt;setFirstName(\u0026#39;Simple\u0026#39;) -\u0026gt;setLastName(\u0026#39;User\u0026#39;) -\u0026gt;addRole($role) -\u0026gt;setEmail(\u0026#39;test@example.com\u0026#39;) -\u0026gt;setApi($api) -\u0026gt;setSalt(\u0026#39;\u0026#39;); \/\/ Handle password encoding $userManager-\u0026gt;updatePassword($user); $manager-\u0026gt;persist($user); $manager-\u0026gt;flush(); } } Tester les commandes : Lorsque Oroplatform est installé, vous pouvez tester les commandes en utilisant la méthode runCommand() de la classe WebTestCase. Cette méthode exécute une commande avec des paramètres donnés et retourne sa sortie sous forme de chaîne. Par exemple, voyez à quoi ressemble le test pour la classe UpdateSchemaDoctrineListener du SearchBundle :\nnamespace Oro\\Bundle\\SearchBundle\\Tests\\Functional\\EventListener; use Oro\\Bundle\\TestFrameworkBundle\\Test\\WebTestCase; class UpdateSchemaListenerTest extends WebTestCase { protected function setUp() { $this-\u0026gt;initClient(); } \/** * @dataProvider commandOptionsProvider *\/ public function testCommand($commandName, array $params, $expectedContent) { $result = $this-\u0026gt;runCommand($commandName, $params); $this-\u0026gt;assertContains($expectedContent, $result); } public function commandOptionsProvider() { return [ \u0026#39;otherCommand\u0026#39; =\u0026gt; [ \u0026#39;commandName\u0026#39; =\u0026gt; \u0026#39;doctrine:mapping:info\u0026#39;, \u0026#39;params\u0026#39; =\u0026gt; [], \u0026#39;expectedContent\u0026#39; =\u0026gt; \u0026#39;OK\u0026#39; ], \u0026#39;commandWithoutOption\u0026#39; =\u0026gt; [ \u0026#39;commandName\u0026#39; =\u0026gt; \u0026#39;doctrine:schema:update\u0026#39;, \u0026#39;params\u0026#39; =\u0026gt; [], \u0026#39;expectedContent\u0026#39; =\u0026gt; \u0026#39;Please run the operation by passing one - or both - of the following options:\u0026#39; ], \u0026#39;commandWithAnotherOption\u0026#39; =\u0026gt; [ \u0026#39;commandName\u0026#39; =\u0026gt; \u0026#39;doctrine:schema:update\u0026#39;, \u0026#39;params\u0026#39; =\u0026gt; [\u0026#39;--dump-sql\u0026#39; =\u0026gt; true], \u0026#39;expectedContent\u0026#39; =\u0026gt; \u0026#39;ALTER TABLE\u0026#39; ], \u0026#39;commandWithForceOption\u0026#39; =\u0026gt; [ \u0026#39;commandName\u0026#39; =\u0026gt; \u0026#39;doctrine:schema:update\u0026#39;, \u0026#39;params\u0026#39; =\u0026gt; [\u0026#39;--force\u0026#39; =\u0026gt; true], \u0026#39;expectedContent\u0026#39; =\u0026gt; \u0026#39;Schema update and create index completed\u0026#39; ] ]; } } VOIR AUSSI Lisez les Test des commandes dans la documentation officielle pour plus d’informations sur la façon de tester les commandes dans une application Symfony.\nTester les services ou les Repositories Pour tester des services ou des dépôts, vous pouvez accéder au conteneur de service via la méthode getContainer() :\n\/\/ src\/Oro\/Bundle\/FooBarBundle\/Tests\/Functional\/FooBarTest.php namespace Oro\\Bundle\\FooBarBundle\\Tests\\Functional; use Oro\\Bundle\\TestFrameworkBundle\\Test\\WebTestCase; class FooBarTest extends WebTestCase { protected $repositoryOrService; protected function setUp() { $this-\u0026gt;initClient(); $this-\u0026gt;loadFixtures([\u0026#39;Oro\\Bundle\\FooBarBundle\\Tests\\Functional\\API\\DataFixtures\\LoadFooBarData\u0026#39;]); $this-\u0026gt;repositoryOrService = $this-\u0026gt;getContainer()-\u0026gt;get(\u0026#39;repository_or_service_id\u0026#39;); } public function testMethod($commandName, array $params, $expectedContent) { $expected = \u0026#39;test\u0026#39;; $this-\u0026gt;assertEquals($expected, $this-\u0026gt;repositoryOrService-\u0026gt;callTestMethod()); } Example de test fonctionnel : Ceci est un exemple de la façon dont vous pouvez écrire un test d’intégration pour une classe qui utilise l’ORM de doctrine sans moquer ses classes et en utilisant de vrais services de Doctrine :\nnamespace Oro\\Bundle\\BatchBundle\\Tests\\Functional\\ORM\\QueryBuilder; use Doctrine\\ORM\\Query\\Expr\\Join; use Doctrine\\ORM\\QueryBuilder; use Doctrine\\ORM\\EntityManager; use Oro\\Bundle\\BatchBundle\\ORM\\QueryBuilder\\CountQueryBuilderOptimizer; use Oro\\Bundle\\TestFrameworkBundle\\Test\\WebTestCase; class CountQueryBuilderOptimizerTest extends WebTestCase { \/** * @dataProvider getCountQueryBuilderDataProvider * @param QueryBuilder $queryBuilder * @param string $expectedDql *\/ public function testGetCountQueryBuilder(QueryBuilder $queryBuilder, $expectedDql) { $optimizer = new CountQueryBuilderOptimizer(); $countQb = $optimizer-\u0026gt;getCountQueryBuilder($queryBuilder); $this-\u0026gt;assertInstanceOf(\u0026#39;Doctrine\\ORM\\QueryBuilder\u0026#39;, $countQb); \/\/ Check for expected DQL $this-\u0026gt;assertEquals($expectedDql, $countQb-\u0026gt;getQuery()-\u0026gt;getDQL()); \/\/ Check that Optimized DQL can be converted to SQL $this-\u0026gt;assertNotEmpty($countQb-\u0026gt;getQuery()-\u0026gt;getSQL()); } \/** * @return array *\/ public function getCountQueryBuilderDataProvider() { self::initClient(); $em = self::getContainer()-\u0026gt;get(\u0026#39;doctrine.orm.entity_manager\u0026#39;); return [ \u0026#39;simple\u0026#39; =\u0026gt; [ \u0026#39;queryBuilder\u0026#39; =\u0026gt; self::createQueryBuilder($em) -\u0026gt;from(\u0026#39;OroUserBundle:User\u0026#39;, \u0026#39;u\u0026#39;) -\u0026gt;select([\u0026#39;u.id\u0026#39;, \u0026#39;u.username\u0026#39;]), \u0026#39;expectedDQL\u0026#39; =\u0026gt; \u0026#39;SELECT u.id FROM OroUserBundle:User u\u0026#39; ], \u0026#39;group_test\u0026#39; =\u0026gt; [ \u0026#39;queryBuilder\u0026#39; =\u0026gt; self::createQueryBuilder($em) -\u0026gt;from(\u0026#39;OroUserBundle:User\u0026#39;, \u0026#39;u\u0026#39;) -\u0026gt;select([\u0026#39;u.id\u0026#39;, \u0026#39;u.username as uName\u0026#39;]) -\u0026gt;groupBy(\u0026#39;uName\u0026#39;), \u0026#39;expectedDQL\u0026#39; =\u0026gt; \u0026#39;SELECT u.id, u.username as uName FROM OroUserBundle:User u GROUP BY uName\u0026#39; ] ); } \/** * @param EntityManager $entityManager * @return QueryBuilder *\/ public static function createQueryBuilder(EntityManager $entityManager) { return new QueryBuilder($entityManager); } } Attention Si votre classe est responsable de la récupération des données, il est préférable de charger les fixtures et de les récupérer en utilisant une classe de test, puis d’affirmer que les résultats sont valides. Vérifier le DQL suffit dans ce cas car c’est la seule responsabilité de cette classe de modifier la requête.\n</p>",
              url: "http:\/\/tech.kiboko.fr\/oro\/test\/functional\/functional\/"
            },
            
            {
              value: "Tests unitaire en Javascript",
              label: "<p>Test unitaire Javascript Installation Les logiciel suivant sont nécessaire pour exécuter les tests JS :\nNode.js (Moteur JavaScript) Karma (Lanceur de test Javascript) Jasmine 3.5 (Framework BDD) NOTE Pour obtenir des instructions sur la façon d’installer Node.js, accédez au site officiel.\nUne fois Node installé, installez plusieurs modules en utilisant Node Packaged Modules en exécutant la commande suivante à partir du dossier racine de votre application\nnpm install --prefix=vendor\/oro\/platform\/build\nOù le paramètre –prefix spécifie le chemin relatif au répertoire platform\/build.\n##Configuration\nLa configuration pour lancer les tests et dans build\/karma.config.js.dist.\nNote Voir plus d’informations dans la documentation officielle de Karma.\nIl peut être utile de créer une configuration séparé en copiant .\/vendor\/oro\/platform\/build\/karma.config.js.dist vers .\/vendor\/oro\/platform\/build\/karma.config.js et le modifier.\nLancement Pour exécuter des tests, appelez la commande suivante :\n.\/vendor\/oro\/platform\/build\/node_modules\/.bin\/karma start .\/vendor\/oro\/platform\/build\/karma.conf.js.dist --single-run N’oubliez pas de changer le chemin vers le répertoire de plateform\/build, s’il est différent dans votre application. \u0060 Pour exécuter une testsuite avec une configuration personnalisée, vous pouvez utiliser les paramètres de ligne de commande qui écrasent les paramètres dans le fichier de configuration.\nQuelques options personnalisées ont été ajoutées pour préparer la configuration de Karma :\n–mask string file masque pour les fichiers Spec.Par défault c\u0026rsquo;est vendor\/oro\/**\/Tests\/JS\/**\/*Spec.js qui correspond à tous les fichiers Spec du projet dans le répertoire vendor oro. –spec string chemin vers un fichier de Spec spécifique, s’il est passé, alors la recherche par masque est ignorée et le test est exécuté fichier Spec unique. –skip-indexing boolean permet de sauter la phase de la collecte des fichiers de spécifications et de réutiliser la collection des des lancements précédent. –theme string le nom du thème est utilisé pour générer la configuration de webpack pour certains thèmes. Par défaut, c’est \u0060admin.oro.\nLes extensions suivantes peuvent être utiles si vous utilisez Phpstorm:\nLe plugin Karma aide à exécuter des testsuite à partir de l’IDE et voir les résultats facilement. ddescriber pour jasmin aide à désactiver ou à sauter certains tests de la testsuite rapidement\nRédaction NOTE Voir la documentation de Jasmine 3.5 pour de plus amples renseignements sur la rédaction de tests avec Jasmine 3.5.\nL’exemple ci-dessous illustre les spécifications du module oroui\/js\/mediator :\nimport mediator from \u0026#39;oroui\/js\/mediator\u0026#39;; import Backbone from \u0026#39;backbone\u0026#39;; describe(\u0026#39;oroui\/js\/mediator\u0026#39;, function () { it(\u0026#34;compare mediator to Backbone.Events\u0026#34;, function() { expect(mediator).toEqual(Backbone.Events); expect(mediator).not.toBe(Backbone.Events); }); }); karma-jsmodule-exposure Cette approche permet de tester l’API publique d’un module. Mais vous pouvez utilisez le plugin karma-jsmodule-exposure pour injecter du code exposant à l’intérieur du js-module et fournit l’API pour manipuler les variables internes :\nimport someModule from \u0026#39;some\/module\u0026#39;; import jsmoduleExposure from \u0026#39;jsmodule-exposure\u0026#39;; \/\/ get exposure instance for tested module var exposure = jsmoduleExposure.disclose(\u0026#39;some\/module\u0026#39;); describe(\u0026#39;some\/module\u0026#39;, function () { var foo; beforeEach(function () { \/\/ create mock object with stub method \u0026#39;do\u0026#39; foo = jasmine.createSpyObj(\u0026#39;foo\u0026#39;, [\u0026#39;do\u0026#39;]); \/\/ before each test, pass it off instead of original exposure.substitute(\u0026#39;foo\u0026#39;).by(foo); }); afterEach(function () { \/\/ after each test restore original value of foo exposure.recover(\u0026#39;foo\u0026#39;); }); it(\u0026#39;check doSomething() method\u0026#39;, function() { someModule.doSomething(); \/\/ stub method of mock object has been called expect(foo.do).toHaveBeenCalled(); }); }); Jasmine-jQuery Jasmine-jQuery étend la fonctionnalité de base de Jasmine, en particulier :\najoute un certain nombre de matchers utiles, et permet de vérifier l’état d’une instance jQuery facilement applique des fixtures HTML avant chaque test et retourne le document après les tests fournit un moyen de charger les fixtures HTML et JSON nécessaires pour un test Cependant, parce que Jasmine-jQuery nécessite le chemin complet vers une ressource fixture, il est préférable d’utiliser import pour charger les fixtures par un chemin connexe.\nimport \u0026#39;jasmine-jquery\u0026#39;; import $ from \u0026#39;jquery\u0026#39;; import html from \u0026#39;text-loader!.\/Fixture\/markup.html\u0026#39;; describe(\u0026#39;some\/module\u0026#39;, function () { beforeEach(function () { \/\/ appends loaded html to document\u0026#39;s body, \/\/ after test rolls back it automatically window.setFixtures(html); }); it(\u0026#39;checks the markup of a page\u0026#39;, function () { expect($(\u0026#39;li\u0026#39;)).toHaveLength(5); }); }); </p>",
              url: "http:\/\/tech.kiboko.fr\/oro\/test\/javascript\/javascript\/"
            },
            
            {
              value: "Tips",
              label: "<p>Health Checkers Behat a une possibilité native d\u0026rsquo;invoquer des formateurs sans exécuter les tests et les hooks.\nVous pouvez essayer:\nbin\/behat --dry-run Cela peut être utile au cas où vous n\u0026rsquo;êtes pas sûr d\u0026rsquo;avoir déclaré tout le contexte nécessaire à votre fonctionnalité. OroBehatExtension améliore cette fonctionnalité et ajoute des fonctionnalités supplémentaires.\nErreurs Erreur courante : Couldn’t generate random unique value for OroBundleUserBundleEntityUser: username in 128 tries\nhot fix:\nVérifiez votre fixtures. Supprimez le suffixe (unique) dans la propriété d\u0026rsquo;entité dans le luminaire d\u0026rsquo;entité, comme dans l\u0026rsquo;exemple suivant:\nFixture incorrect :\nyaml Oro\\Bundle\\UserBundle\\Entity\\User: charlie: firstName: Marge lastName: Marge Simpson username (unique): marge228 Correction\nOro\\Bundle\\UserBundle\\Entity\\User: charlie: firstName: Marge lastName: Marge Simpson username: marge228 Erreur racine\nAlice se souvient de toutes les valeurs de la propriété d\u0026rsquo;entité donnée et essaie de générer une valeur unique, mais cela provoque des problèmes lorsqu\u0026rsquo;il n\u0026rsquo;y a qu\u0026rsquo;une seule valeur pour la propriété d\u0026rsquo;entité.\nCette option peut toujours être utilisée si elle est combinée avec la fausse valeur générée automatiquement, comme dans l\u0026rsquo;exemple suivant:\nOro\\Bundle\\UserBundle\\Entity\\User: charlie: firstName (unique): \u0026lt;firstName()\u0026gt; lastName: Marge Simpson username: marge228 Ajouter des extraits Le développement des fonctionnalités comprend les étapes de conception suivantes:\nCréez un brouillon de la fonctionnalité: implémentez un scénario de haut niveau qui couvre l\u0026rsquo;histoire. À ce stade, vous devez avoir une compréhension claire des résultats commerciaux obtenus par l\u0026rsquo;automatisation des tests de fonctionnalités. Spécifiez tous les scénarios susceptibles de se produire lors de l\u0026rsquo;utilisation de la fonction. Les étapes exactes ne sont pas nécessaires. Finalisez la vue d\u0026rsquo;ensemble de la mise en œuvre et planifiez les différentes étapes. Certaines étapes peuvent déjà être entièrement automatisées. Idéalement, vous devez automatiser les étapes manquantes après avoir prévu de les utiliser dans vos scénarios de test de fonctionnalités. Si la fonctionnalité de fonctionnalité est déjà implémentée, il est nécessaire d\u0026rsquo;implémenter les étapes behat impliquées dans le test de fonctionnalité.\nCependant, il est parfois impossible de le faire immédiatement (en raison de l\u0026rsquo;implémentation incomplète des fonctionnalités, des problèmes de blocage ou des informations manquantes). Dans ce cas, vous pouvez temporairement vous moquer des étapes qui manquent d\u0026rsquo;implémentation.\nUn moyen rapide de le faire consiste à exécuter dry-run sur vos tests de fonctionnalités. Dans la console, exécutez la commande suivante:\nbin\/behat path\/to\/your.feature --dry-run --append-snippets --snippets-type=regex\nLa fonctionnalité est exécutée en mode –dry-run , au stade final de l\u0026rsquo;exécution, vous êtes invité à ajouter des étapes de mise en œuvre simulée non définies à l\u0026rsquo;un des contextes existants.\nComment trouver l\u0026rsquo;étape nécessaire Lorsque vous concevez des scénarios d\u0026rsquo;automatisation de test pour la nouvelle fonctionnalité, vous pouvez avoir du mal à trouver des étapes à réutiliser parmi les centaines d\u0026rsquo;étapes déjà automatisées. Utilisez les conseils ci-dessous pour trouver l\u0026rsquo;étape nécessaire.\nSuggestion automatique dans PhpStorm\nLors de la conception d\u0026rsquo;un scénario dans le fichier de fonctionnalités, PhpStorm vous propose des conseils sur les étapes implémentées qui correspondent aux mots clés. Par exemple, lorsque vous tapez grid ou form, les étapes qui impliquent ces éléments apparaissent dans le bloc de suggestions.\nSi PhpStorm ne vous propose aucun conseil lors de la frappe, veuillez vérifier les points suivants:\nVous avez installé les vendors Vous avez installé le plugin behat pour PhpStorm Trouvez le contexte nécessaire\nChaque classe Context doit implémenter l\u0026rsquo;interface Behat\\Behat\\Context\\Context. Obtenez la liste des contextes implémentés et trouvez celui nécessaire par nom.\nHabituellement, le nom du contexte est explicite, par exemple, GridContext, FormContext, ACLContext, etc.\nUtiliser Grep dans la console\nSi, pour une raison quelconque, vous n\u0026rsquo;utilisez pas PhpStorm ou le plugin Behat, vous pouvez toujours trouver l\u0026rsquo;étape nécessaire en filtrant la sortie de la commande qui prévisualise toutes les étapes de la fonctionnalité (utilisez Grep).\nTapez la commande suivante dans votre console:\nbin\/behat -dl -s AcmeDemoBundle | grep \u0026quot;flash message\u0026quot;\nbin\/behat -dl -s AcmeDemoBundle | grep \u0026quot;grid\u0026quot;\nPS : Vous ne pouvez utiliser l\u0026rsquo;interface de ligne de commande behat qu\u0026rsquo;après avoir installé l\u0026rsquo;application.\n</p>",
              url: "http:\/\/tech.kiboko.fr\/oro\/test\/behat\/behat-tips\/"
            },
            
            {
              value: "Monolog",
              label: "<p>PSR3 et Monolog Qu\u0026rsquo;est-ce qu\u0026rsquo;un log ? A quoi ça sert ? Log = Journal Indique différentes choses telles que des actions qui sont faites Très utiles pour les erreurs La PSR-3, une interface commune d\u0026rsquo;interopérabilité https:\/\/www.php-fig.org\/psr\/psr-3\/\nLoggerInterface Remplace les logs de PHP Propose différents niveaux de sévérité de la norme Syslog Debug Info Notice Warning Error Critical Alert Emergency 100 200 250 300 400 500 550 600 Implémentée par KLogger, Monolog, Analog et bien d\u0026rsquo;autres Comment choisir le bon niveau de log ? Niveau 1\nDebug : Informations pour debug son app 🐛 réservé au développeur\nNiveau 2 :\nInfo : Différentes informations de ce qui se passe ✅ Notice : D\u0026rsquo;autres informations qui peuvent être utiles qu\u0026rsquo;on peut garder 📖 Warning : Il faut prêter attention mais ce ne sont pas des erreurs ⚠️ Error : Quelque chose n\u0026rsquo;a pas fonctionné mais ça peut parfois attendre ❌ dysfonctionnement non bloquant (reprise sur erreur)\nNiveau 3 :\nCritical : Quelque chose n\u0026rsquo;a pas fonctionné mais là c\u0026rsquo;est urgent 💥 Alert : Quelque chose n\u0026rsquo;est plus utilisable du tout 🚨 Emergency : Système inutilisable ☢️ (= réveil quelqu\u0026rsquo;un la nuit pour intervenir) [notif SMS possible] dysfonctionnement bloquant (pas de reprise sur erreur)\nUne implémentation de PSR-3 : Monolog Monolog a été développé par Jordi Boggiano (co-fondateur de Composer) : https:\/\/github.com\/Seldaek\/\nPermet d\u0026rsquo;envoyer des logs à plusieurs handlers Filtrer selon le niveau de log Exemple d\u0026rsquo;utilisation, pour des logs Critical\/Alert\/Emergency ils pourraient être envoyés par email (ou par SMS).\nExemple de la doc Symfony, avec configuration des logs de base :\nTous les logs seront donc écrit dans le fichier .log\nCas concrets Utilisation concrète\n1er étape : log envoyé a Elastic via Logstash 2ème étape : affichage des logs en BO gràce au composant ElasticSearch : https:\/\/github.com\/elastic\/elasticsearch-php Exemple de configuration avec répartition des logs dans 2 handlers :\nservices: monolog.formatters.logstash: class: Monolog\\Formatter\\LogstashFormatter arguments: $applicationName: \u0026#39;kiboko\u0026#39; monolog: handlers: mail_on_errors: type: fingers_crossed action_level: critical handler: buffered buffered: type: buffer handler: swift swift: type: swift_mailer from_email: alert@kiboko.fr to_email: nicolas@kiboko.fr subject: An Error Occurred! level: critical logstash: type: socket connection_string: \u0026#39;tcp:\/\/logstash:5044\u0026#39; level: debug formatter: monolog.formatters.logstash Kibana Kibana est une interface utilisateur gratuite et ouverte qui vous permet de visualiser vos données Elasticsearch et de naviguer dans la Suite Elastic.\nhttps:\/\/www.elastic.co\/fr\/kibana\nUtilisation de la stack ElasticStack (ex: EKL Elastic\/Kibana\/Logstash)\nAvec Kibana, on a la possiblité de filter les logs par niveau\nConférences AFUP à ce sujet Pour en savoir plus vous pouvez retrouver\nÉtat de l\u0026rsquo;art d\u0026rsquo;Elasticsearch avec PHP par Damien Alexandre =\u0026gt; ForumPhp 2020 : https:\/\/afup.org\/talks\/3449-etat-de-l-art-d-elasticsearch-avec-php\nLaisse pas trainer ton log par Olivier Dolbeau : =\u0026gt; ForumPhp 2014 : https:\/\/afup.org\/talks\/1160-laisse-pas-trainer-ton-log\n</p>",
              url: "http:\/\/tech.kiboko.fr\/kibokast\/monolog\/"
            },
            
            {
              value: "Exceptions",
              label: "<p>\nQu\u0026rsquo;est qu\u0026rsquo;une exception Objet lancé lors d\u0026rsquo;une erreur (probléme physique, erreur de programmation) Permet de revenir à un état stable Remonte la pile d\u0026rsquo;exécution les plus rapidement possible jusqu\u0026rsquo;à ce qu\u0026rsquo;elle soit rattrapé (gérer) Implémente l\u0026rsquo;interface Throwable qui permet de \u0026ldquo;catcher\u0026rdquo; une erreur A ne pas confondre avec Error (souvant lancé par PHP lui-même) Information d\u0026rsquo;une exception public function __construct($message=\u0026#34;\u0026#34;; $code=0, Throwable $previous=null) { } 4 éléments importants :\nMessage Fichier source de l\u0026rsquo;exception Code d\u0026rsquo;exception Stack trace 4 outils Throw Try Catch Finally Que ce passe t\u0026rsquo;il si on ne catch pas l\u0026rsquo;exception ? Erreur fatale : le processus s\u0026rsquo;arrête\nListe des exceptions PHP Exceptions SPL (PHP) : https:\/\/www.php.net\/manual\/fr\/spl.exceptions.php Exceptions Réservées (Zend) : https:\/\/www.php.net\/manual\/fr\/reserved.exceptions.php exception Handler function handler($exception) { echo \u0026#34;\u0026lt;b\u0026gt;Exception:\u0026lt;\/b\u0026gt; \u0026#34;, $exception-\u0026gt;getMessage(); \/\/ logging ... } set_exception_handler(\u0026#34;handler\u0026#34;); throw new Exception(\u0026#34;Uncaught exception occurred!\u0026#34;; echo \u0026#34;Ah bah non...\u0026#34;; Bonnes pratiques Gérer les exceptions de la plus spécifique à la moins spécifique Gérer plusieurs exceptions à la fois class MainException extends Exception {} class SubException extends Exception {} try { throw new SubException; } catch (MainException | SubException $e) { echo \u0026#34;Exception thrown: \u0026#34; . get_class($e); } Finally\u0026hellip; function getNumber(): int { try { echo \u0026#34;Hello\u0026#34;; throw new RuntimeException( \u0026#34;Please help me\u0026#34;); return 0; } catch(RuntimeException $exception) { echo \u0026#34;Il faut gérer cette exception\u0026#34; return -1; } finally { echo \u0026#34;My name is Julien\u0026#34; return 2; } } Nommage Nommer l\u0026rsquo;exception, pas l\u0026rsquo;émetteur\nBien nommer les exceptions Mauvaise pratique Bonne pratique Contenu de l\u0026rsquo;exception Toujours fournir un maximum d\u0026rsquo;information pour le contexte\nCa évite de chercher pendant 4 heures pourquoi ça bug\u0026hellip;\nUtiliser le I de SOLID Ne pas hésiter à utiliser des interfaces\nGérer l\u0026rsquo;exception au bon moment Si vous ne savez pas comment gérer l\u0026rsquo;exception, laissez la remonter. C\u0026rsquo;est surement du ressort des classes au dessus.\nhttps:\/\/github.com\/symfony\/symfony\/blob\/4.3\/src\/Symfony\/Component\/HttpKernel\/EventListener\/ExceptionListener.php\nConclusion Une exception est un événement qui arrive à un moment dans l\u0026rsquo;application.\nCet événement intervient lorsque quelque chose de problématique est intervenue.La cause peut être trés varié.\nL\u0026rsquo;exception doit être la plus explicite possible.\nGérer toutes les exceptions dans un try \/ catch (Exception $e) est une très mauvaise pratique.\nSources : https:\/\/www.php.net\/ http:\/\/www.upv.es\/~jgonsol\/tutorial\/java\/exceptions\/definition.html#:~:text=Definition%3A%20An%20exception%20is%20an,the%20normal%20flow%20of%20instructions. https:\/\/medium.com\/@anastasionico\/good-practices-handling-error-and-exceptions-in-php-5c3d84d342a9 https:\/\/stackify.com\/php-try-catch-php-exception-tutorial\/ https:\/\/stackoverflow.com\/ ( ne jugez pas svp) https:\/\/blog.theodo.com\/2014\/04\/manage-php-errors-and-exceptions-in-your-project\/#:~:text=Errors%20or%20Exceptions,tell%20that%20something%20went%20wrong.\u0026text=Exceptions%20are%20catchable%2C%20unlike%20errors,the%20execution%20of%20the%20program. https:\/\/blog.eleven-labs.com\/en\/php_handle-exception-gracefully\/ </p>",
              url: "http:\/\/tech.kiboko.fr\/kibokast\/exceptions\/"
            },
            
            {
              value: "Doctrine type",
              label: "<p>Les types Doctrine Les numériques integer smallint : pas plus de 65 535 integer integer : jusqu\u0026rsquo;à 4 millions, ou alors \u002b2 millions\/-2 millions string bigint : sur 64 bits. c\u0026rsquo;est beaucoup string decimal : si on connaît le nombre de chiffres après la virgule float float : précision pas très importante, ça peut être arrondi Les chaînes string string : taille limitée par la DB, Doctrine peut le passer en texte string text : no limit string guid : global unique identifier. ex: filename iPhone, registre Windows resource binary : images, médias, taille limitée par la DB, Doctrine peut le passer en blob resource blob : no limit Les bits boolean boolean : true\/false (en réalité c\u0026rsquo;est juste un int) Les dates \\DateTime date\tdate \\DateTime datetime\tdate et heure \\DateTime datetimetz\tdate, heure et décalage horaire (par rapport à UTC) \\DateTime time\theure \\DateTime dateinterval\técart entre dates \\DateTimeImmutable datetime_immutable \\DateTimeImmutable date_immutable \\DateTimeImmutable time_immutable Mutable $date = new \\DateTime(); echo $date-\u0026gt;format(\u0026#39;y-m-d\u0026#39;);\t\/\/ \u0026#39;2020-09-25\u0026#39; $bidule = $date-\u0026gt;modify(\u0026#39;\u002b3 month\u0026#39;); echo $bidule-\u0026gt;format(\u0026#39;y-m-d\u0026#39;); \/\/ \u0026#39;2020-12-25\u0026#39; echo $date-\u0026gt;format(\u0026#39;y-m-d\u0026#39;);\t\/\/ \u0026#39;2020-12-25\u0026#39; WTF ?? Immutable $date = new \\DateTimeImmutable(); echo $date-\u0026gt;format(\u0026#39;y-m-d\u0026#39;);\t\/\/ \u0026#39;2020-09-25\u0026#39; $bidule = $date-\u0026gt;modify(\u0026#39;\u002b3 month\u0026#39;); echo $bidule-\u0026gt;format(\u0026#39;y-m-d\u0026#39;); \/\/ \u0026#39;2020-12-25\u0026#39; echo $date-\u0026gt;format(\u0026#39;y-m-d\u0026#39;);\t\/\/ \u0026#39;2020-09-25\u0026#39; Les arrays array array : sérialisé sous forme de texte dans la base array simple_array : utilise implode et explode sur les virgules, tableau 1-dimension array json : utilise json_decode pour la serialisation Les objets object object : marche pas bien, il vaut mieux sérialiser puis enregistrer en text Explications: https:\/\/www.doctrine-project.org\/projects\/doctrine-dbal\/en\/2.12\/reference\/types.html#object\nLes types custom Ex : On veut un type Money.\nCREATE DOMAIN MyMoney AS DECIMAL(18,3);\nuse Doctrine\\DBAL\\Types\\Types final class MoneyType extends Type { getSQLDeclaration() \u0026lsquo;MyMoney\u0026rsquo; convertToPHPValue() Money($value) convertToDatabaseValue() $value-\u0026gt;toDecimal() getName() \u0026lsquo;money\u0026rsquo; Lien vers la doc. Doctrine : https:\/\/www.doctrine-project.org\/projects\/doctrine-dbal\/en\/2.12\/reference\/types.html#custom-mapping-types\n</p>",
              url: "http:\/\/tech.kiboko.fr\/kibokast\/doctrine-type\/"
            },
            
            {
              value: "Stack FAQ",
              label: "<p>Stack FAQ Listes d\u0026rsquo;erreurs rencontrées lors de nos développements, avec une solution éventuelle pour remédier au problème.\n1. Erreurs lors d\u0026rsquo;une installation Erreur configuration \u0026ldquo;snc_redis.session\u0026rdquo; The child node \u0026#34;client\u0026#34; at path \u0026#34;snc_redis.session\u0026#34; must be configured Pour éviter cette erreur, on peut commenter la configuration Redis dans config_prod.yml tel que :\n#snc_redis: # session: # locking: false Erreur \u0026ldquo;Compilation failed: invalid range\u0026rdquo; An exception has been thrown during the rendering of a template (\u0026#34;Warning: preg_match(): Compilation failed: invalid range in character class at offset 72\u0026#34;) in OroSidebarBundle::sidebar.html.twig at line 21. Probleme lié à une mauvaise version de php\nErreur write timed-out lors d\u0026rsquo;un migration load La commande a été lancé avant que tous les services soient démarrés\nErreur connexion logstash lors d\u0026rsquo;un platform update Failed connecting to tcp:\/\/logstash:5044 Vérifier que les 2 services logstash et kibana sont bien lancés.\nErreur \u0026ldquo;data type json\u0026rdquo; Undefined object: 7 ERROR: data type json has no default operator class for access method “btree” Vérifier que les patchs soient bien appliqués :\ncomposer run kiboko-apply-patches Patch réglant le probleme EntityExtendBundle_UpdateExtendIndicesMigration.patch\nErreur lors d\u0026rsquo;une ré-installation Ne pas oublier de renseigner installed null dans config\/parameters.yml\nAvant\ninstalled: \u0026#39;2020-09-04T17:39:05\u002b02:00\u0026#39; Après :\ninstalled: null 2. Erreurs lors des modifications de Workflow Erreur workflow \u0026ldquo;doesn\u0026rsquo;t have allowed transition\u0026rdquo; Step \u0026#34;open\u0026#34; of workflow \u0026#34;b2c_flow_abandoned_shopping_cart\u0026#34; doesn\u0026#39;t have allowed transition \u0026#34;__start__\u0026#34;. Cette erreur correspond à un probleme de workflow, possibilité de corriger avec la commande :\nbin\/console oro:workflow:definitions:load\n3. Erreurs liées aux assets Erreur \u0026ldquo;Building assets\u0026rdquo; Building assets. (...) throw err; ^ Probleme de version de node (en local mac, possibilité de switcher de version de Node avec nvm)\n4. Erreurs ElasticSearch Erreur \u0026ldquo;No alive nodes found in your cluster\u0026rdquo; No alive nodes found in your cluster Cette erreur correspond à un probleme d\u0026rsquo;ElasticSearch. Le service doit être cassé.\nErreur \u0026ldquo;index_not_found_exception\u0026rdquo; {“error”:{“root_cause”:[{“type”:“index_not_found_exception”,“reason”:“no such index\u0026#34; .... Solution apportée :\non créé des index vides avec cette commande bin\/console oro:elasticsearch:create-standard-indexes puis on regénère les indexes bin\/console oro:website-search:reindex --website-id=3 ou n\u0026rsquo;importe quel type de commande qui fait de la reindexation (oro:search:reindex, etc.) Si c\u0026rsquo;est les websites-search indexes qui ne marche pas, il faut lancé oro:elasticsearch:create-standard-indexes\noro:elasticsearch:create-standard-indexes =\u0026gt; Creates new empty standard indexes with mappings. Removes current standard indexes if they exist\nSi c\u0026rsquo;est les websites-search indexes qui ne marche pas, il faut lancé oro:website-elasticsearch:create-website-indexes\noro:website-elasticsearch:create-website-indexes =\u0026gt; Creates new empty website indexes with mappings. Removes current website indexes if they exist\nErreur \u0026ldquo;process_cluster_event_timeout_exception\u0026rdquo; lors d\u0026rsquo;un oro:website-search:reindex {“error”:{“root_cause”:[{“type”:“process_cluster_event_timeout_exception”,“reason”:“failed to process cluster event (put-mapping) within 30s”}],“type”:“process_cluster_event_timeout_exception”,“reason”:“failed to process cluster event (put-mapping) within 30s”},“status”:503} Probleme de configuration d\u0026rsquo;ElasticSearch, actions à réaliser :\nsuppression du volume du service et du container elastic configuration du service et des données \u0026ldquo;environment\u0026rdquo; dans le fichier docker-compose.yml tel que : - http.cors.allow-origin=http:\/\/localhost:${DEJAVU_PORT},http:\/\/127.0.0.1:${DEJAVU_PORT} </p>",
              url: "http:\/\/tech.kiboko.fr\/autre\/stack-faq\/"
            },
            
            {
              value: "Créer une application frontend sur OroPlatform",
              label: "<p>OroPlatform fournit un environnement complet pour créér des applications métier dédiées à une équipe interne d\u0026rsquo;une entreprise. Il ne fournit cependant pas d\u0026rsquo;interface pubique à destination de tiers, à l\u0026rsquo;exception notable de l\u0026rsquo;interface OroCommerce Store Front.\nNous allons créer un socle d\u0026rsquo;application OroPlatform qui disposera d\u0026rsquo;un accès client. Par défaut, une application OroPlatform dispose d\u0026rsquo;une seule application déclarée, nommée default. C\u0026rsquo;est sur cette application que l\u0026rsquo;on développe des interfaces métier, nous allons chercher à créer une seconde application nommée helpdesk_portal\nArchitecture Nous allons nous appliquer à créer cette application sur OroPlatform 4.1 Community Edition et Symfony 4.4.\nNous tenterons de respecter une organisation de notre code en DDD - Domain Driven Development\nsrc\/ └ HelpDeskPortal\/ ├\tBundle\/ │ ├ DependencyInjection\/ │ │ │ Configuration.php │ │ └ KibokoHelpDeskPortalExtension.php │ ├ Resources\/ │ │ └ config\/ │ │ └ oro\/ │ └ KibokoHelpDeskPortalBundle.php ├ Domain\/ │ └ Frontend\/ └ Infrastructure\/ ├ Persistence\/ │ └ Doctrine\/ │ └ Repository\/ └ Symfony\/ ├ DependencyInjection\/ ├ Request\/ ├ Router\/ └ Session\/ Créer le projet Nous allons partir d\u0026rsquo;un projet OroPlatform CE 4.1 vierge.\ngit clone git@github.com:oroinc\/platform-application.git helpdesk-application cd helpdesk-application git checkout 4.1.2 rm -rf .git git init git add -A . git commit -m \u0026#34;Initial commit from git@github.com:oroinc\/platform-application.git atr version 4.1.2\u0026#34; composer install Routage Dans le but de simplification, nous allons activer l\u0026rsquo;auto-wiring sur notre composant de routage :\nAutowiring services: Kiboko\\HelpDeskPortal\\Infrastructure\\Symfony\\Router\\: resource: \u0026#39;..\/src\/HelpDeskPortal\/Infrastructure\/Router\u0026#39; autowire: true autoconfigure: true Ajouter un préfixe aux routes OroPlatform Pour la première étape, nous allons ajouter un préfixe admin\/ à nos routes standard OroPlatform, comme le fait OroCommerce.\nNous utiliserons le paramètre de configuration %web_backend_prefix% pour définir facilement cette valeur. Nous profiterons que OroCommerce ait déjà défini ce paramètre.\nNous alons utiliser un event listener qui va retraiter les déclarations de routes, tel que :\n\u0026lt;?php declare(strict_types=1); namespace Kiboko\\HelpDeskPortal\\Infrastructure\\Symfony\\Router\\EventListener; use Oro\\Bundle\\ApiBundle\\ApiDoc\\RestRouteOptionsResolver; use Oro\\Bundle\\DistributionBundle\\Event\\RouteCollectionEvent; use Symfony\\Component\\Routing\\Route; class RouteCollectionListener { const OPTION_FRONTEND = \u0026#39;helpdesk_portal\u0026#39;; private string $prefix; public function __construct(string $prefix) { $this-\u0026gt;prefix = trim(trim($prefix), \u0026#39;\/\u0026#39;); } public function onCollectionAutoload(RouteCollectionEvent $event): void { if (\u0026#39;\u0026#39; === $this-\u0026gt;prefix) { return; } \/** @var Route $route *\/ foreach ($event-\u0026gt;getCollection()-\u0026gt;getIterator() as $route) { if ($route-\u0026gt;hasOption(self::OPTION_FRONTEND) \u0026amp;\u0026amp; $route-\u0026gt;getOption(self::OPTION_FRONTEND)) { continue; } if (!$this-\u0026gt;hasPrefix($route-\u0026gt;getPath())) { $route-\u0026gt;setPath($this-\u0026gt;prefix . $route-\u0026gt;getPath()); } if ($route-\u0026gt;hasOption(RestRouteOptionsResolver::OVERRIDE_PATH_OPTION)) { $overridePath = $route-\u0026gt;getOption(RestRouteOptionsResolver::OVERRIDE_PATH_OPTION); if (!$this-\u0026gt;hasPrefix($overridePath)) { $route-\u0026gt;setOption( RestRouteOptionsResolver::OVERRIDE_PATH_OPTION, $this-\u0026gt;addPrefix($overridePath) ); } } } } private function hasPrefix(string $path): bool { $prefix = $this-\u0026gt;prefix . \u0026#39;\/\u0026#39;; return 0 === strpos($path, $prefix) || 0 === strpos($path, \u0026#39;\/\u0026#39; . $prefix); } private function addPrefix(string $path): string { if (0 === strpos($path, \u0026#39;\/\u0026#39;)) { return \u0026#39;\/\u0026#39; . $this-\u0026gt;prefix . $path; } return $this-\u0026gt;prefix . \u0026#39;\/\u0026#39; . $path; } } Et la déclaration de service qui lui correspond :\nservices: Kiboko\\HelpDeskPortal\\Infrastructure\\Symfony\\Router\\EventListener\\RouteCollectionListener: arguments: - \u0026#39;%web_backend_prefix%\u0026#39; tags: - { name: kernel.event_listener, event: oro_distribution.route_collection.expose, method: onCollectionAutoload, priority: 120 } - { name: kernel.event_listener, event: oro_distribution.route_collection.autoload, method: onCollectionAutoload, priority: 120 } lazy: true Extracteur de routes frontend Pour pouvoir exporter les routes javascript, nous avons besoin d\u0026rsquo;extraire les routes du portail Helpdesk.\n\u0026lt;?php namespace Kiboko\\HelpDeskPortal\\Infrastructure\\Symfony\\Router; use FOS\\JsRoutingBundle\\Extractor\\ExposedRoutesExtractor; use Symfony\\Component\\Routing\\Route; \/** * Expose routes which marked with option \u0060helpdesk_portal: true\u0060. *\/ class PortalExposedRoutesExtractor extends ExposedRoutesExtractor { \/** * {@inheritdoc} *\/ public function isRouteExposed(Route $route, $name) { return parent::isRouteExposed($route, $name) \u0026amp;\u0026amp; $route-\u0026gt;hasOption(\u0026#39;helpdesk_portal\u0026#39;) \u0026amp;\u0026amp; $route-\u0026gt;getOption(\u0026#39;helpdesk_portal\u0026#39;); } \/** * {@inheritdoc} *\/ public function getCachePath($locale) { $path = parent::getCachePath($locale); $fileName = basename($path); $fileName = \u0026#39;helpdesk_portal_\u0026#39;.$fileName; return dirname($path) . DIRECTORY_SEPARATOR . $fileName; } } Ainsi que les services nécessaires à l\u0026rsquo;extraction de ces routes Javascript :\nservices: Kiboko\\HelpDeskPortal\\Infrastructure\\Symfony\\Router\\PortalExposedRoutesExtractor: arguments: - \u0026#39;@router\u0026#39; - [] - \u0026#39;%kernel.cache_dir%\/oro_data\u0026#39; - \u0026#39;%kernel.bundles%\u0026#39; kiboko_help_desk_portal.js_routing_controller: class: \u0026#39;%fos_js_routing.controller.class%\u0026#39; public: true arguments: - \u0026#39;@fos_js_routing.serializer\u0026#39; - \u0026#39;@Kiboko\\HelpDeskPortal\\Infrastructure\\Symfony\\Router\\PortalExposedRoutesExtractor\u0026#39; - \u0026#39;%fos_js_routing.cache_control%\u0026#39; - \u0026#39;%kernel.debug%\u0026#39; Nous aurons également besoin d\u0026rsquo;exposer une route supplémentaire pour le service de contrôleur kiboko_help_desk_portal.js_routing_controller que nous avons créé plus haut :\nkiboko_help_desk_portal_js_routing_js: path: \u0026#34;\/media\/js\/frontend_routes.{_format}\u0026#34; defaults: { _controller: kiboko_help_desk_porta.js_routing_controller:indexAction } requirements: _format: json options: helpdesk_portal: true </p>",
              url: "http:\/\/tech.kiboko.fr\/oro\/creer-une-application-frontend-sur-oroplatform\/"
            },
            
            {
              value: "Git flow",
              label: "<p>Spécificités Kiboko pour la mise en place de git flow\nEnvironnements et branches Environnement Branche Production master Staging staging . develop Branches Branche master nombre : unique durée de vie : permanente responsabilité : Lead dev et DT création : démarrage du projet Code stable, testé et validé. Ce code doit être validé en staging par le client.\n⚠️ Sera déployé sur l’environnement de production\nLes PR à destination de la branche Master sont validées par les personnes ayant la main sur les déploiements sur l’environnement de production\nBranche staging nombre : unique durée de vie : permanente responsabilité : Lead dev et DT création : démarrage du projet Code stable, testé et validé en environnement de dev\/test. Permet de valider le fonctionnement d’une nouvelle fonctionnalité sur une environnement identique à la production. Permet au client d’effectuer sa recette.\nLes PR à destination de la branche staging sont validées par les personnes ayant la main sur les déploiements sur l’environnement de staging après le code review validé.\n⚠️ Sera déployé sur l’environnement de staging\nBranches « feature » nombre : au moins une par fonctionnalité à développer durée de vie : quelques jours responsabilité : Développeur création : démarrage du développement d’un ticket, par fork de la branche develop nommage : feature\/\u0026lt;numéro de ticket\u0026gt;- ex : feature\/103-news-bundle Code review : Lead dev et DT Code en cours de développement qui implémente une fonctionnalité à embarquer dans la prochaine version de l’application.\nUne fois le développement sur cette branche terminé :\ncréation d’une PR depuis cette branche vers develop assignation de la responsabilité au Lead dev ou DT validation de la PR par le reviewer ou le lead-dev Branches « hotfix » nombre : au moins une par bug à corriger en production durée de vie : quelques heures, le temps de passer le correctif en production responsabilité : Développeur création : par fork de la branche master nommage : hotfix\/\u0026lt;numéro de ticket\u0026gt;- ex : hotfix\/103-category-import Code review : Lead dev et DT </p>",
              url: "http:\/\/tech.kiboko.fr\/autre\/git-flow\/"
            },
            
            {
              value: "Les types de blocks dans Oro",
              label: "<p>BlockTypes Some usage examples layout: actions: - \u0026#39;@add\u0026#39;: id: style_calendar parentId: head_style blockType: style options: src: \u0026#39;js\/calendar\/calendar.css\u0026#39; - \u0026#39;@add\u0026#39;: id: script_prototype parentId: head_script blockType: script options: src: \u0026#39;js\/prototype\/prototype.js\u0026#39; - \u0026#39;@add\u0026#39;: id: meta_description parentId: head blockType: meta options: name: \u0026#39;description\u0026#39; content: \u0026#39;=data[\u0026#34;product\u0026#34;].getDescription()\u0026#39; siblingId: meta - \u0026#39;@add\u0026#39;: id : logo blockType: link options: image: logo.png path: \/ attr: class: logo vars: image_class: large image_alt: Madison Island siblingId: navigation prepend: true - \u0026#39;@add\u0026#39;: id : breadcrumbs_product parentId: breadcrumbs blockType: text options: text: \u0026#39;=data[\u0026#34;product\u0026#34;].getName()\u0026#39; Commands To have a list of block type :\nbin\/console debug:container --show-private --tag layout.block_type\nAnd to have the data providers :\nbin\/console debug:container --show-private --tag layout.data_provider\n</p>",
              url: "http:\/\/tech.kiboko.fr\/oro\/block-types\/"
            },
            
            {
              value: "Regex",
              label: "<p>Expressions régulières Doc. php : https:\/\/www.php.net\/manual\/fr\/pcre.pattern.php\nAlternatives (abc|def) alternative avec capture : recherche abc ou def et fournira le résultat trouvé (?:abc|def) alternative sans capture : recherche abc ou def, mais ne fournira pas le résultat trouvé (?:(Lun|Mar)di) alternative avec capture interne : recherche Lun ou Mar et fournira le résultat trouvé respectivement dans les positions 1 et 2 (?|(Lun|Mar)di) alternative avec capture interne : recherche Lun ou Mar et fournira toujours le résultat trouvé dans la position 1 (\u0026lt;(?:span|div)\u0026gt;Lorem Ipsum\u0026lt;\/\\\\1\u0026gt;) alternative sans capture et référence arrière Classes de caractères Plages de caractères . recherche tout caractère \\d recherche un des caractères entre 0 et 9 \\. recherche le caractère . [2-6] recherche un des caractères entre 2 et 6 [a-z] recherche un des caractères entre a et z [A-Z] recherche un des caractères entre A et Z [a-zA-Z] recherche un des caractères entre a et z et entre A et Z [a-zA-Z0-9] recherche un des caractères entre a et z, entre A et Z et entre 0 et 9 Répétitions [a-z0-9-]\u002b recherche les caractères 1 fois ou plus [a-z0-9-]* recherche des caractères 0 fois ou plus [a-z0-9-]? crecherche des caractères 0 fois ou 1 fois Recherche inversée [^,]* recherche tout caractère différent de , [^a-z]* recherche tout caractère différent de la plage entre a et z Ancres ^\/catalog\/ (importance du ^) recherche toute chaine qui commence par \/catalog\/ \\\\.html$ (importance du $) recherche toute chaine qui termine par .html ^(?:\/.*|)(\/[a-z0-9-]\u002b)\\.html$ recherche toute chaine qui termine par .html et ne capture que la dernière partie, ex : \/lorem-ipsum.html deviendra \/lorem-ipsum \/lorem-ipsum\/dolor-sit-amet.html deviendra \/dolor-sit-amet </p>",
              url: "http:\/\/tech.kiboko.fr\/autre\/regex\/"
            },
            
            {
              value: "Changer l\u0027ordre d\u0027affichage des champs dans les migrations",
              label: "<p>Ordering the fields on the different views (full, create, update) By default, the order the fields are displayed on the views is determined by the system, and can change each time the cache is cleared. To avoid that and force the ordering of the fields, you need to set the oro_options as follows:\npublic function up(Schema $schema, QueryBag $queries) { $table = $schema-\u0026gt;getTable(self::TABLE_NAME); $table-\u0026gt;addColumn(\u0026#39;address\u0026#39;, \u0026#39;string\u0026#39;, [ \u0026#39;oro_options\u0026#39; =\u0026gt; [ \u0026#39;extend\u0026#39; =\u0026gt; [\u0026#39;owner\u0026#39; =\u0026gt; ExtendScope::OWNER_CUSTOM], \u0026#39;view\u0026#39; =\u0026gt; [\u0026#39;priority\u0026#39; =\u0026gt; 199], ], ]); $table-\u0026gt;addColumn(\u0026#39;address_details\u0026#39;, \u0026#39;string\u0026#39;, [ \u0026#39;oro_options\u0026#39; =\u0026gt; [ \u0026#39;extend\u0026#39; =\u0026gt; [\u0026#39;owner\u0026#39; =\u0026gt; ExtendScope::OWNER_CUSTOM], \u0026#39;view\u0026#39; =\u0026gt; [\u0026#39;priority\u0026#39; =\u0026gt; 198], ], ]); $table-\u0026gt;addColumn(\u0026#39;postal_code\u0026#39;, \u0026#39;string\u0026#39;, [ \u0026#39;length\u0026#39; =\u0026gt; 5, \u0026#39;oro_options\u0026#39; =\u0026gt; [ \u0026#39;extend\u0026#39; =\u0026gt; [\u0026#39;owner\u0026#39; =\u0026gt; ExtendScope::OWNER_CUSTOM], \u0026#39;view\u0026#39; =\u0026gt; [\u0026#39;priority\u0026#39; =\u0026gt; 197], ], ]); $table-\u0026gt;addColumn(\u0026#39;town\u0026#39;, \u0026#39;string\u0026#39;, [ \u0026#39;length\u0026#39; =\u0026gt; 100, \u0026#39;oro_options\u0026#39; =\u0026gt; [ \u0026#39;extend\u0026#39; =\u0026gt; [\u0026#39;owner\u0026#39; =\u0026gt; ExtendScope::OWNER_CUSTOM], \u0026#39;view\u0026#39; =\u0026gt; [\u0026#39;priority\u0026#39; =\u0026gt; 196], ], ]); } The value of \u0027owner\u0027 =\u0026gt; ExtendScope::OWNER_CUSTOM tells the system to handle almost everything, so that you do not have to write a new form type for instance. The option \u0027view\u0027 =\u0026gt; [\u0027priority\u0027 =\u0026gt; 199] allows developers to force the ordering of the fields in the view. The higher the value, the higher in the view.\n</p>",
              url: "http:\/\/tech.kiboko.fr\/oro\/back\/order-field-in-migration\/"
            },
            
            {
              value: "Commandes utiles",
              label: "<p>Generic Install\ncomposer install --prefer-dist --no-dev bin\/console oro:install --timeout=0 Start message queue consume\nbin\/console oro:message-queue:consume with less or more informations\nbin\/console oro:message-queue:consume -v bin\/console oro:message-queue:consume -vv bin\/console oro:message-queue:consume -vvv Remove cache\nrm -rf var\/cache\/* Indexation Search\nbin\/console oro:search:index bin\/console oro:search:reindex Website\nbin\/console oro:website-search:reindex bin\/console oro:website-search:reindex --website-id=2 Update entities bin\/console oro:entity-extend:cache:check Makes sure that extended entity configs are ready to be processed by other commands. This is an internal command. Please do not run it manually. bin\/console oro:entity-extend:cache:clear Clears extended entity cache. bin\/console oro:entity-extend:cache:warmup Warms up extended entity cache. bin\/console oro:entity-extend:migration:update-config Updates extended entities configuration during a database structure migration process. This is an internal command. Please do not run it manually. bin\/console oro:entity-extend:update-config Prepare entity config bin\/console oro:entity-extend:update-schema Synchronize extended and custom entities metadata with a database schema Assets Install assets\n3.0 (with assetic)\nbin\/console oro:asset:install \u0026amp;\u0026amp; bin\/console assetic:dump bin\/console oro:assets:install -e dev \u0026amp;\u0026amp; bin\/console assetic:dump -e dev 3.1 (with webpack)\nbin\/console asset:install \u0026amp;\u0026amp; bin\/console oro:asset:build bin\/console asset:install --env=dev \u0026amp;\u0026amp; bin\/console oro:asset:build --env=dev with symlink (without new file creation)\nbin\/console oro:asset:install --symlink Migrations Schema migrations\nbin\/console oro:migration:load Data migrations\nbin\/console oro:migration:data:load Data migrations dump\nbin\/console oro:migration:dump more : https:\/\/github.com\/oroinc\/platform\/tree\/master\/src\/Oro\/Bundle\/MigrationBundle\nUsers Password changing\nbin\/console oro:user:update nomUser --user-password=root Create a limited access token over time\nbin\/console oro:user:impersonate user ElasticSearch En cas d\u0026rsquo;erreur d\u0026rsquo;indexation :\nbin\/console oro:website-elasticsearch:create-website-indexes Others Translations\nbin\/console oro:translation:load bin\/console oro:translation:dump bin\/console oro:translation:dump \u0026amp;\u0026amp; bin\/console oro:localization:dump Load with parameters :\nbin\/console oro:translation:load --languages=en --languages=fr --rebuild-cache Détails : https:\/\/github.com\/oroinc\/platform\/blob\/master\/src\/Oro\/Bundle\/TranslationBundle\/Resources\/doc\/reference\/commands.md\nGenerate JS routing (Api\/Components)\nbin\/console fos:js-routing:dump --target web\/js\/routes.js Worflows \u0026amp; Processes\nbin\/console oro:workflow:definitions:load bin\/console oro:process:configuration:load And more If you need Bruce\u0026rsquo;s power : https:\/\/github.com\/kiboko-labs\/KibokoArmageddonBundle\n</p>",
              url: "http:\/\/tech.kiboko.fr\/oro\/commandes-utiles\/"
            },
            
            {
              value: "Etendre une entité",
              label: "<p>Extending the BusinessUnit entity Extending the BusinessUnit entity is rather easy. Just create a new class in the [Bundle]\\Migrations\\Schema\\vx_x namespace and make it implement the Oro\\Bundle\\MigrationBundle\\Migration\\Migration interface (and eventually the Oro\\Bundle\\AttachmentBundle\\Migration\\Extension\\AttachmentExtensionAwareInterface if you need to have attachments to your entity, like images or any files).\nBelow is an example from kiboko-labs\/sevea-orocommerce:\n\u0026lt;?php namespace Kiboko\\Bundle\\AppBundle\\Migrations\\Schema\\v1_0; use Doctrine\\DBAL\\Schema\\Schema; use Oro\\Bundle\\AttachmentBundle\\Migration\\Extension\\AttachmentExtension; use Oro\\Bundle\\AttachmentBundle\\Migration\\Extension\\AttachmentExtensionAwareInterface; use Oro\\Bundle\\EntityExtendBundle\\EntityConfig\\ExtendScope; use Oro\\Bundle\\EntityExtendBundle\\Migration\\OroOptions; use Oro\\Bundle\\MigrationBundle\\Migration\\Migration; use Oro\\Bundle\\MigrationBundle\\Migration\\QueryBag; class CustomizeBusinessUnit implements Migration, AttachmentExtensionAwareInterface { const TABLE_NAME = \u0026#39;oro_business_unit\u0026#39;; const THUMB_WIDTH = 200; const THUMB_HEIGHT = 200; const IMAGE_SIZE = 2; \/** @var AttachmentExtension *\/ protected $attachmentExtension; \/** * Sets the AttachmentExtension * * @param AttachmentExtension $attachmentExtension *\/ public function setAttachmentExtension(AttachmentExtension $attachmentExtension) { $this-\u0026gt;attachmentExtension = $attachmentExtension; } \/** * Modifies the given schema to apply necessary changes of a database * The given query bag can be used to apply additional SQL queries before and after schema changes * * @param Schema $schema * @param QueryBag $queries * @return void * @throws \\Doctrine\\DBAL\\Schema\\SchemaException *\/ public function up(Schema $schema, QueryBag $queries) { $table = $schema-\u0026gt;getTable(self::TABLE_NAME); $table-\u0026gt;addColumn(\u0026#39;address\u0026#39;, \u0026#39;string\u0026#39;, [ OroOptions::KEY =\u0026gt; [ \u0026#39;extend\u0026#39; =\u0026gt; [\u0026#39;owner\u0026#39; =\u0026gt; ExtendScope::OWNER_CUSTOM, \u0026#39;entity\u0026#39; =\u0026gt; [\u0026#39;description\u0026#39; =\u0026gt; \u0026#39;The address of the business unit\u0026#39;]], \u0026#39;view\u0026#39; =\u0026gt; [\u0026#39;priority\u0026#39; =\u0026gt; 200], ], ]); $table-\u0026gt;addColumn(\u0026#39;address_details\u0026#39;, \u0026#39;string\u0026#39;, [ OroOptions::KEY =\u0026gt; [ \u0026#39;extend\u0026#39; =\u0026gt; [\u0026#39;owner\u0026#39; =\u0026gt; ExtendScope::OWNER_CUSTOM], \u0026#39;view\u0026#39; =\u0026gt; [\u0026#39;priority\u0026#39; =\u0026gt; 190], ], ]); $table-\u0026gt;addColumn(\u0026#39;postal_code\u0026#39;, \u0026#39;string\u0026#39;, [ \u0026#39;length\u0026#39; =\u0026gt; 5, OroOptions::KEY =\u0026gt; [ \u0026#39;extend\u0026#39; =\u0026gt; [\u0026#39;owner\u0026#39; =\u0026gt; ExtendScope::OWNER_CUSTOM], \u0026#39;view\u0026#39; =\u0026gt; [\u0026#39;priority\u0026#39; =\u0026gt; 180], ], ]); $table-\u0026gt;addColumn(\u0026#39;town\u0026#39;, \u0026#39;string\u0026#39;, [ \u0026#39;length\u0026#39; =\u0026gt; 100, OroOptions::KEY =\u0026gt; [ \u0026#39;extend\u0026#39; =\u0026gt; [\u0026#39;owner\u0026#39; =\u0026gt; ExtendScope::OWNER_CUSTOM], \u0026#39;view\u0026#39; =\u0026gt; [\u0026#39;priority\u0026#39; =\u0026gt; 170], ], ]); $table-\u0026gt;addColumn(\u0026#39;longitude\u0026#39;, \u0026#39;float\u0026#39;, [ OroOptions::KEY =\u0026gt; [ \u0026#39;extend\u0026#39; =\u0026gt; [\u0026#39;owner\u0026#39; =\u0026gt; ExtendScope::OWNER_CUSTOM], \u0026#39;view\u0026#39; =\u0026gt; [\u0026#39;priority\u0026#39; =\u0026gt; 160], ], ]); $table-\u0026gt;addColumn(\u0026#39;latitude\u0026#39;, \u0026#39;float\u0026#39;, [ OroOptions::KEY =\u0026gt; [ \u0026#39;extend\u0026#39; =\u0026gt; [\u0026#39;owner\u0026#39; =\u0026gt; ExtendScope::OWNER_CUSTOM], \u0026#39;view\u0026#39; =\u0026gt; [\u0026#39;priority\u0026#39; =\u0026gt; 150], ], ]); $table-\u0026gt;addColumn(\u0026#39;type\u0026#39;, \u0026#39;string\u0026#39;, [ \u0026#39;length\u0026#39; =\u0026gt; 10, OroOptions::KEY =\u0026gt; [ \u0026#39;extend\u0026#39; =\u0026gt; [\u0026#39;owner\u0026#39; =\u0026gt; ExtendScope::OWNER_CUSTOM], \u0026#39;view\u0026#39; =\u0026gt; [\u0026#39;priority\u0026#39; =\u0026gt; 140], ], ]); $table-\u0026gt;addColumn(\u0026#39;erp_code\u0026#39;, \u0026#39;string\u0026#39;, [ \u0026#39;length\u0026#39; =\u0026gt; 20, OroOptions::KEY =\u0026gt; [ \u0026#39;extend\u0026#39; =\u0026gt; [\u0026#39;owner\u0026#39; =\u0026gt; ExtendScope::OWNER_CUSTOM], \u0026#39;view\u0026#39; =\u0026gt; [\u0026#39;priority\u0026#39; =\u0026gt; 120], ], ]); $table-\u0026gt;addColumn(\u0026#39;facebook\u0026#39;, \u0026#39;string\u0026#39;, [ OroOptions::KEY =\u0026gt; [ \u0026#39;extend\u0026#39; =\u0026gt; [\u0026#39;owner\u0026#39; =\u0026gt; ExtendScope::OWNER_CUSTOM], \u0026#39;view\u0026#39; =\u0026gt; [\u0026#39;priority\u0026#39; =\u0026gt; 110], ], ]); $this-\u0026gt;attachmentExtension-\u0026gt;addImageRelation( $schema, self::TABLE_NAME, \u0026#39;image\u0026#39;, [], self::IMAGE_SIZE, self::THUMB_WIDTH, self::THUMB_HEIGHT ); } } Be very careful ! If you mistake, it\u0026rsquo;s possible you\u0026rsquo;ll have to run the oro:install command again. Oro keeps memory of the previous structure in database (table oro_entity_config_field), stored base64 serialized BLOB field. Really difficult to update.\nExtending the BusinessUnitType You have to write a new type extension in order to add and configure the fields of the form. You may create new fields, and override \u0026ldquo;parent\u0026rdquo; field configurations.\n\u0026lt;?php namespace Kiboko\\Bundle\\AppBundle\\Form\\Extension; use Oro\\Bundle\\AttachmentBundle\\Form\\Type\\ImageType; use Oro\\Bundle\\OrganizationBundle\\Form\\Type\\BusinessUnitType; use Symfony\\Component\\Form\\AbstractTypeExtension; use Symfony\\Component\\Form\\Extension\\Core\\Type\\ChoiceType; use Symfony\\Component\\Form\\FormBuilderInterface; class BusinessUnitExtension extends AbstractTypeExtension { const TYPE_VENDOR = \u0026#39;vendor\u0026#39;; const TYPE_VITRINE = \u0026#39;vitrine\u0026#39;; const TYPE_EXTERNAL = \u0026#39;external\u0026#39;; \/** * Returns the name of the type being extended. * * @return string The name of the type being extended *\/ public function getExtendedType() { return BusinessUnitType::class; } \/** * @param FormBuilderInterface $builder * @param array $options *\/ public function buildForm(FormBuilderInterface $builder, array $options) { $builder -\u0026gt;add(\u0026#39;image\u0026#39;, ImageType::class) -\u0026gt;add(\u0026#39;type\u0026#39;, ChoiceType::class, [ \u0026#39;label\u0026#39; =\u0026gt; $this-\u0026gt;getTranslationKey(\u0026#39;type\u0026#39;), \u0026#39;choices\u0026#39; =\u0026gt; [ $this-\u0026gt;getTranslationKey(\u0026#39;type.choices.vendor\u0026#39;) =\u0026gt; self::TYPE_VENDOR, $this-\u0026gt;getTranslationKey(\u0026#39;type.choices.vitrine\u0026#39;) =\u0026gt; self::TYPE_VITRINE, $this-\u0026gt;getTranslationKey(\u0026#39;type.choices.external\u0026#39;) =\u0026gt; self::TYPE_EXTERNAL, ] ]) ; } private function getTranslationKey(string $key) : string { return sprintf(\u0026#39;oro.organization.businessunit.%s.label\u0026#39;, $key); } } Creating the form listener New fields declared in the type extension above won\u0026rsquo;t be added automatically on the form view. In order to add those fields on the form view, we need to hook into the form prerender event Oro\\Bundle\\UIBundle\\Event\\Events::BEFORE_UPDATE_FORM_RENDER.\n\u0026lt;?php namespace Kiboko\\Bundle\\AppBundle\\EventListener; use Oro\\Bundle\\UIBundle\\Event\\BeforeFormRenderEvent; use Oro\\Bundle\\UIBundle\\Event\\Events; use Oro\\Bundle\\UIBundle\\View\\ScrollData; use Symfony\\Component\\EventDispatcher\\EventSubscriberInterface; use Symfony\\Component\\Form\\FormView; class BusinessUnitFormListener implements EventSubscriberInterface { const FORM_NAME = \u0026#39;oro_business_unit_form\u0026#39;; \/** * @return array The event names to listen to *\/ public static function getSubscribedEvents() { return [ Events::BEFORE_UPDATE_FORM_RENDER =\u0026gt; \u0026#39;onBusinessUnitEdit\u0026#39;, ]; } public function onBusinessUnitEdit(BeforeFormRenderEvent $event) { $form = $event-\u0026gt;getForm(); if (!$this-\u0026gt;supports($form)) { return; } $template = $event-\u0026gt;getTwigEnvironment()-\u0026gt;render( \u0026#39;@KibokoApp\/Form\/file_widget.html.twig\u0026#39;, [\u0026#39;form\u0026#39; =\u0026gt; $form-\u0026gt;children[\u0026#39;image\u0026#39;]] ); $scrollData = new ScrollData($event-\u0026gt;getFormData()); $scrollData-\u0026gt;addSubBlockData(1, 0, $template, \u0026#39;image\u0026#39;); $event-\u0026gt;setFormData($scrollData-\u0026gt;getData()); } \/** * @param FormView $formView * @return bool *\/ protected function supports(FormView $formView) { return $formView-\u0026gt;vars[\u0026#39;name\u0026#39;] === self::FORM_NAME; } } Be careful, as each form rendering will trigger this event. Be sure to filter the forms with a supports method as above, for example\nThe form data can be found via the BeforeFormRenderEvent. It\u0026rsquo;s just a flat array, that is easier to manipulate wrapped into a Oro\\Bundle\\UIBundle\\View\\ScrollData object.\nThe goal is to generate the HTML for each added form field:\n$template = $event-\u0026gt;getTwigEnvironment()-\u0026gt;render( \u0026#39;@KibokoApp\/Form\/file_widget.html.twig\u0026#39;, [\u0026#39;form\u0026#39; =\u0026gt; $form-\u0026gt;children[\u0026#39;image\u0026#39;]] ); and to place it at the required place in the form data:\n$scrollData-\u0026gt;addSubBlockData(1, 0, $template, \u0026#39;image\u0026#39;); You\u0026rsquo;ll have to create the template file yourself. In the above example (file_widget.html.twig), it\u0026rsquo;s just a one-line template:\n{{ form_row(form) }} </p>",
              url: "http:\/\/tech.kiboko.fr\/oro\/back\/extend-entity\/"
            },
            
            {
              value: "Installer et configurer Xdebug",
              label: "<p>1 : Installation sur le systeme XDebug est une extension de PHP, qui permet le débogage de scripts.\nPour installer xdebug, sur mac ou sur linux, il suffit que l\u0026rsquo;extension Xdebug soit chargée. Quand vous faites un \u0060php -v vous pouvez voir si XDebug est activé.\nPour l\u0026rsquo;installer vous pouvez suivre l\u0026rsquo;installation par OS : https:\/\/xdebug.org\/docs\/install Ou sinon suivre le wizard (https:\/\/xdebug.org\/wizard) pour réaliser une installation a la main.\nL\u0026rsquo;installation automatique va surement vous rajouter une ligne dans la config de php (fichier php.ini) dont vous pouvez aller checker l\u0026rsquo;emplacement grâce à un php --ini. À vous de déplacer cette ligne dans un fichier tel que ext-xdebug.ini pour que ça soit plus propre. Pourquoi ça ? Parce que les extensions de base et même php lui meme séparent souvent la config des extensions dans des fichiers dédiés. Il faudra aller les mettre dans un dossier conf.d dans le repertoire de php comme ceci : \/usr\/local\/etc\/php\/7.3\/conf.d\/ext-xdebug.ini\nBon, une fois cela fait, vous devriez voir xdebug quand vous faites un php -v , sinon, revérifier les étapes précédentes.\n2 : Configuration de base : Je vous invite à utiliser cette config de base (à mettre dans le fichier de config spécifique a Xdebug) :\nzend_extension = xdebug xdebug.mode=debug xdebug.client_port=9003 xdebug.start_with_request=yes xdebug.idekey=PHPSTORM 3 : Activation automatique Si vous avez déjà utilisé Xdebug vous savez surement qu\u0026rsquo;elle ralentit énormément de temps d\u0026rsquo;exécution des scripts. C\u0026rsquo;est pourquoi il est nécessaire de pouvoir activer\/désactiver l\u0026rsquo;extension à la demande pour l\u0026rsquo;utiliser uniquement au moment utile. Par exemple ne le lancez surtout pas durant la génération du cache, pendant un composer install\u0026hellip;\nLà, il existe 2 solutions:\nDésactivation par la config de php Avec cette méthode, en soi , comme pour toute extension, il suffit de commenter la fameuse ligne : ;zend_extension = xdebug\nPour ça, utiliser un éditeur de texte, ou plutôt un script:\nVoici un exemple, à adapter selon votre OS ( surtout le sed et le dossier de php)\nVersion Mac function changexdebugscript() { alias xdebug=changexdebugscript cat \u0026lt;\u0026lt; \u0026#34;EOF\u0026#34; _ _ | | | | __ ____| | ___| |__ _ _ __ _ \\ \\\/ \/ _\u0060 |\/ _ \\ \u0026#39;_ \\| | | |\/ _\u0060 | \u0026gt; \u0026lt; (_| | __\/ |_) | |_| | (_| | \/_\/\\_\\__,_|\\___|_.__\/ \\__,_|\\__, | __\/ | |___\/ EOF php=$(php -v | tail -r | tail -n 1 | cut -d \u0026#34; \u0026#34; -f 2 | cut -c 1-3) if grep -R \u0026#34;;\\\u002bzend_extension\u0026#34; \/usr\/local\/etc\/php\/\u0026#34;$php\u0026#34;\/conf.d\/ext-xdebug.ini then echo \u0026#34;Activation de xDebug pour PHP \u0026#34;$php sed -i -e \u0026#34;s\/;zend_extension\/zend_extension\/g\u0026#34; \/usr\/local\/etc\/php\/\u0026#34;$php\u0026#34;\/conf.d\/ext-xdebug.ini else echo \u0026#34;Désactivation de xDebug pour PHP \u0026#34;$php sed -i -e \u0026#34;s\/zend_extension\/;zend_extension\/g\u0026#34; \/usr\/local\/etc\/php\/\u0026#34;$php\u0026#34;\/conf.d\/ext-xdebug.ini fi } Version Linux function changexdebugscript() { alias xdebug=changexdebugscript cat \u0026lt;\u0026lt; \u0026#34;EOF\u0026#34; _ _ | | | | __ ____| | ___| |__ _ _ __ _ \\ \\\/ \/ _\u0060 |\/ _ \\ \u0026#39;_ \\| | | |\/ _\u0060 | \u0026gt; \u0026lt; (_| | __\/ |_) | |_| | (_| | \/_\/\\_\\__,_|\\___|_.__\/ \\__,_|\\__, | __\/ | |___\/ EOF php=$(php -v | tail -n 5 | cut -d \u0026#34; \u0026#34; -f 2 | cut -c 1-3 | head -n 1) if grep -R \u0026#34;;\\\u002bzend_extension\u0026#34; \/etc\/php\/\u0026#34;$php\u0026#34;\/cli\/conf.d\/20-xdebug.ini then echo \u0026#34;Activation de xDebug pour PHP \u0026#34;$php sed -e \u0026#34;s\/;zend_extension\/zend_extension\/g\u0026#34; \/etc\/php\/\u0026#34;$php\u0026#34;\/cli\/conf.d\/20-xdebug.ini | sudo tee \/etc\/php\/\u0026#34;$php\u0026#34;\/cli\/conf.d\/20-xdebug.ini else echo \u0026#34;Désactivation de xDebug pour PHP \u0026#34;$php sed -e \u0026#34;s\/zend_extension\/;zend_extension\/g\u0026#34; \/etc\/php\/\u0026#34;$php\u0026#34;\/cli\/conf.d\/20-xdebug.ini | sudo tee \/etc\/php\/\u0026#34;$php\u0026#34;\/cli\/conf.d\/20-xdebug.ini fi } De cette manière, peu importe la version de php en cours, la commande xdebug vas s\u0026rsquo;occuper de désactiver\/ activer xdebug\nDésactivation par l\u0026rsquo;IDE Si votre IDE, le permet, vous pouvez désactiver le fait qu\u0026rsquo;il écoute sur le port de xdebug à la volée : Normalement, vous étes censés obtenir des perfs normales si vous désactivez xdebug de cette façon, mais de ma propre expérience. Il arrive que sur de très gros script, xdebug ralentisse quand même PHP. À vous d\u0026rsquo;utiliser la méthode que vous préférez.\nUtilisation Et bien là ça dépend de votre IDE, avec Phpstorm vous devez configurer le port dans la config \u0026lsquo;Xdebug\u0026rsquo; dans les paramètres. Puis lancer le script, page web, ou utilisez les run configurations.\nhttps:\/\/www.jetbrains.com\/help\/phpstorm\/debugging-with-phpstorm-ultimate-guide.html#debugging-a-php-cli-script Avec un navigateur web Si vous vous débugger du code dans le navigateur, installer l\u0026rsquo;extension Xdebug helper puis configurer la avec votre IDEKEY : FAQ : Q : J\u0026rsquo;ai désactivé xdebug mais mon appli est tres lente\nR : Il faut redémarrer le serveur pour que PHP prenne en compte le changement de config.\nQ : Je ne sais pas ou est situé la config php pour mettre Xdebug\nR : Utilisez la commande php \u0026ndash;ini pour localiser la config ou utilisez l\u0026rsquo;outil en ligne (https:\/\/xdebug.org\/wizard)\nQ : Mon IDE ne s\u0026rsquo;arrête pas sur les points d\u0026rsquo;arret.\nR : Vérifier la config de php, vérifier le port utilisé par l\u0026rsquo;ide ( le meme que la config).Aussi que votre IDE écoute Xdebug. Vérifiez aussi le comportement le fonctionnement en CLI ou en WEB.\n</p>",
              url: "http:\/\/tech.kiboko.fr\/env-local\/install-xdebug\/"
            },
            
            {
              value: "Code review",
              label: "<p>1. Cycle de vie des PRs Pour la création des PRs, se reporter à la procédure décrite dans les usages Github Pas plus de 2 PRs ouvertes par personne : tant que j\u0026rsquo;ai encore une PR non mergée, je n\u0026rsquo;entame pas de nouvelle tâche. Tout le monde relit les PRs de tout le monde Afin de fluidifier les développements, il est important de relire les PRs plusieurs fois par jour (ex : le matin en arrivant, puis après la pause déjeuner. Possibilité de relire à 2 si besoin) Tout le monde peut merger les PRs en respectant les règles de validité ci-dessous 2. Règles de validité d\u0026rsquo;une PR Prérequis Chaque branche doit contenir un numéro de ticket : feature\/XXX-new-feature Chaque commentaire de commit doit contenir un numéro de ticket : #XXX : Add new feature Les tests unitaires doivent passer La PR doit avoir le libellé \u0026ldquo;GTM\u0026rdquo; La PR doit avoir une taille raisonnable Les commits doivent être bien découpés (pas de \u0026ldquo;fix, re-re-fix, wip\u0026rdquo;) Règles de merge Je merge une PR si elle respecte les critères suivants :\nRespect des prérequis décrits ci-dessus Déjà 2 autres personnes ont approuvé la PR dont un dev expérimenté Toutes les discussions sont marquées comme résolues ⚠️ Elle pointe sur la branche develop ⚠️ Je vérifie que le milestone est le bon pour faciliter la rédaction des notes de version Approbation et correction En tant que relecteur Lorsque j\u0026rsquo;ai une question ou un retour à faire sur une PR, je mets un commentaire sur la ligne concernée (en restant courtois dans mes insultes) Lorsque je n\u0026rsquo;ai plus de retours à faire, j\u0026rsquo;approuve la PR. Si elle respecte les règles de validité, je la merge sur develop. En tant que développeur Lorsque je corrige ma PR, je réponds au commentaire (en restant courtois dans mes insultes) et je marque la discussion comme résolue </p>",
              url: "http:\/\/tech.kiboko.fr\/kibokast\/code-review\/"
            },
            
            {
              value: "Commandes Debug",
              label: "<p>Commandes Symfony Articles officiels présentants certaines fonctionnalités :\nhttps:\/\/symfony.com\/blog\/new-in-symfony-3-4-debug-autowiring-command https:\/\/symfony.com\/blog\/new-in-symfony-3-4-debug-form-command Pour avoir la liste complete : bin\/console list debug\nDebug Router Doc officiel : https:\/\/symfony.com\/doc\/3.4\/routing\/debug.html\nPour avoir l\u0026rsquo;ensemble des routes avec leur nom et les URLs qui correspondent\nbin\/console debug:router\nExemple pour rechercher une route \u0026ldquo;produit\u0026rdquo; dans des controllers :\nbin\/console debug:router --show-controllers | grep \/product\nDebug Container Doc officiel : https:\/\/symfony.com\/doc\/3.4\/service_container\/debug.html\nPour avoir l\u0026rsquo;ensemble des services publiques\nbin\/console debug:container\nPour rechercher un service par son nom : bin\/console debug:container validator Pour rechercher un service par tag : bin\/console debug:container --tag=form.type Pour rechercher un service par parametre : bin\/console debug:container --parameter=kernel.debug Debug Config Doc officiel : https:\/\/symfony.com\/doc\/3.4\/reference\/configuration\/debug.html\nPour avoir l\u0026rsquo;ensemble des configuration\nbin\/console debug:config\nPour rechercher pour un bundle : bin\/console debug:config AppBundle Debug Twig Pour avoir l\u0026rsquo;ensemble des fonctions des filtres, des tests et des globales disponibles ainsi que les chemins chargés par l\u0026rsquo;application\nbin\/console debug:twig\nDebug Swiftmailer Doc officiel : https:\/\/symfony.com\/doc\/3.4\/reference\/configuration\/swiftmailer.html\nPour avoir les mailers disponibles\nbin\/console debug:swiftmailer\nDebug Autowiring Doc officiel : https:\/\/symfony.com\/doc\/3.4\/service_container\/debug.html\nPour avoir l\u0026rsquo;ensemble des services déclarés en auto-wiring :\nbin\/console debug:autowiring\nDebug Forms Pour avoir l\u0026rsquo;ensemble des formulaires (Type, Extension, Type Guessers) disponibles :\nbin\/console debug:form\nDebug Translations Pour avoir l\u0026rsquo;ensemble des traductions par locale ou bundle :\nbin\/console debug:translation\nDebug routes JS bin\/console fos:js-routing:debug\nCommandes Oro Entity config Oro Permet de récupérer la configuration d\u0026rsquo;une entité :\nbin\/console oro:entity-config:debug AppBundle\\\\Entity\\\\Norm\nPermet de récupérer la configuration d\u0026rsquo;un champ d\u0026rsquo;une entité :\nbin\/console oro:entity-config:debug AppBundle\\\\Entity\\\\Norm code\nLayout à compléter\nbin\/console oro:debug:layout\nWorkflow à compléter\nbin\/console oro:debug:workflow:definitions\n</p>",
              url: "http:\/\/tech.kiboko.fr\/kibokast\/commandes-debug\/"
            },
            
            {
              value: "Collections Doctrine",
              label: "<p> Documentation Github La collection sert à adresser le besoin de fournir des listes d\u0026rsquo;objets. Doctrine fournit une implémentation utilisée dans son ORM et ses ODM.\nLa collection permet de gérer une liste d\u0026rsquo;objets du même type, pour :\nfiltrer trier appliquer un traitement (map) calculer un résultat d\u0026rsquo;après le contenu de la liste (reduce) L\u0026rsquo;interface Collection Il s\u0026rsquo;agit du contrat \u0026ldquo;Collection\u0026rdquo; de Doctrine, toute collection devra implémenter cette interface.\nCette interface implémente elle-même les contrats suivants :\n\\Countable : la collection pourra être utilisée avec la fonction count(), ce qui permettra de connaitre le nombre d\u0026rsquo;éléments contenus par la collection. \\IteratorAggregate : la collection pourra être parcourue dans une structure foreach \\ArrayAccess : la collection pourra être utilisée avec les opérateurs [], de la même manière qu\u0026rsquo;on le fait avec un tableau Les méthodes map La méthode map( callable $callback ) va appliquer la fonction de rappel passée en argument sur chaque élément qu\u0026rsquo;elle contient et retournera une copie de la collection. Dans cette copie chaque élément aura été remplacé avec le résultat de cette fonction.\n\u0026lt;?php $collection = new ArrayCollection([\u0026#39;SKU001\u0026#39;, \u0026#39;SKU002\u0026#39;, \u0026#39;SKU003\u0026#39;]); $mappedCollection = $collection-\u0026gt;map(function(string $value): Product { return new Product($value); }); \/\/ Retournera : [object (Product) { $sku = \u0026#39;SKU001\u0026#39; }, object (Product) { $sku = \u0026#39;SKU002\u0026#39; }, object (Product) { $sku = \u0026#39;SKU003\u0026#39; }] filter La méthode filter( callable $callback ) va appliquer la fonction de rappel passée en argument sur chaque élément qu\u0026rsquo;elle contient et retournera une copie de la collection. Dans cette copie, ne restera que les éléments pour lesquels la fonction de rappel a renvoyé true\n\u0026lt;?php $collection = new ArrayCollection([new Product(\u0026#39;SKU001\u0026#39;), new Product(\u0026#39;SKU002\u0026#39;), new Product(\u0026#39;SKU003\u0026#39;)]); $mappedCollection = $collection-\u0026gt;filter(function(Product $value): bool { return in_array($value-\u0026gt;sku, [\u0026#39;SKU001\u0026#39;, \u0026#39;SKU003\u0026#39;, \u0026#39;SKU005\u0026#39;]); }); \/\/ Retournera : [object (Product) { $sku = \u0026#39;SKU001\u0026#39; }, object (Product) { $sku = \u0026#39;SKU003\u0026#39; }] slice La méthode slice( int $start, null|int $length ) va retourner une nouvelle copie de la collection contenant uniquement les éléments commençant à la position $start, avec au maximum $length éléments à partir de ce point si ce paramètre est fourni.\n\u0026lt;?php $collection = new ArrayCollection([new Product(\u0026#39;SKU001\u0026#39;), new Product(\u0026#39;SKU002\u0026#39;), new Product(\u0026#39;SKU003\u0026#39;), new Product(\u0026#39;SKU004\u0026#39;), new Product(\u0026#39;SKU005\u0026#39;)]); $mappedCollection = $collection-\u0026gt;slice(2, 3); \/\/ Retournera : [object (Product) { $sku = \u0026#39;SKU002\u0026#39; }, object (Product) { $sku = \u0026#39;SKU003\u0026#39; }, object (Product) { $sku = \u0026#39;SKU004\u0026#39; }] </p>",
              url: "http:\/\/tech.kiboko.fr\/kibokast\/collections-doctrine\/"
            },
            
            {
              value: "Principes SOLID",
              label: "<p> Single responsibility principle Open\/closed principle Liskov substitution principle Interface segregation principle Dependency inversion principle Single responsibility principle \u0026lt;?php class Product { \/\/ ... public function getURL(ObjectManager $om): URL { $url = new URL(); $url-\u0026gt;setProduct($this); $url-\u0026gt;setPath(...); $om-\u0026gt;persist($url); $om-\u0026gt;flush(); } \/\/ ... } Open\/closed principle \u0026lt;?php final class Foo { \/\/ ... public function lorem(ObjectManager $om, ?string $name = null): URL { } \/\/ ... } Liskov substitution principle \u0026lt;?php class Foo { public function lorem() { return 42; } } final class Bar extends Foo { private Registry $doctrine; private Repository $repository; public function lorem(string $path) { $this-\u0026gt;repository-\u0026gt;load(72) return new URL($path); } } \u0026lt;?php class Foo { public function lorem() { return 42; } } final class Bar extends Foo { public function lorem() { return 64; } public function ipsum(string $path) { return new URL($path); } } Interface segregation principle \u0026lt;?php interface LoremInterface extends \\Countable, \\Traversable {} class Lorem implements LoremInterface, \\Stringable, \\IteratorAggregate {} class Ipsum implements LoremInterface, \\Stringable, \\Iterator {} Traversable Iterator IteratorAggregate Countable Dependency inversion principle \u0026lt;?php final class Incorrect { public function lorem(EntityManager $em) { $em-\u0026gt;persist(...); $em-\u0026gt;flush(); } public function ipsum(ArrayCollection $list) { return count($list) \u0026gt; 10; } } \u0026lt;?php final class Correct { public function lorem(ObjectManager $om) { $om-\u0026gt;persist(...); $om-\u0026gt;flush(); } public function ipsum(\\Countable $list) { return count($list) \u0026gt; 10; } } </p>",
              url: "http:\/\/tech.kiboko.fr\/kibokast\/principes-solid\/"
            },
            
            {
              value: "Utilisation des commandes Kloud",
              label: "<p>https:\/\/github.com\/kiboko-labs\/docker-images\nCommandes de gestion des images Docker kloud images:test Pour vérifier que les images soient conformes aux exigences (vérifie les pré-requis)\nkloud images:pull Pour mettre à jour les images docker\nkloud images:tree Pour afficher l\u0026rsquo;arbre de dépendances des images Docker\nCommandes de manipulation des stacks Docker Initialize the Docker stack ion a project without Docker Stack\nkloud stack:init Identifie le meilleur choix de stack en posant jusqu\u0026rsquo;à une dizaine de questions interactivement. Initialise cette stack d\u0026rsquo;après les réponses et crée un fichier .kloud.yaml à la racine du projet pour les prochaines utilisations de la commande.\nkloud stack:upgrade Met à jour la stack Docker d\u0026rsquo;après les contraintes listées dans le fichier .kloud.yaml\nUtilisation en local Utilisation à travers Docker (préférable sous Mac) Créer un fichier \/usr\/local\/bin\/kloud, avec le contenu suivant :\n#!\/usr\/bin\/env sh docker run --rm -ti -v \u0026#39;\/var\/run\/docker.sock:\/var\/run\/docker.sock\u0026#39; -v $PWD:\/app kiboko\/kloud $@ Puis rendre le fichier exécutable avec chmod \u002bx \/usr\/local\/bin\/kloud\nUtilisation du fichier Phar (préférable sous Linux) Télécharger la dernière version publiée de l\u0026rsquo;utilitaire au format Phar : https:\/\/github.com\/kiboko-labs\/docker-images\/releases\n</p>",
              url: "http:\/\/tech.kiboko.fr\/kibokast\/utilisation-des-commandes-kloud\/"
            },
            
            {
              value: "Importer un dump SQL avec Docker",
              label: "<p>Scénario : Nous avons un dump que nous voulons importer sur une base vierge pour avoir une appli qui tourne avec de la donnée.\nOn peut copier un fichier du local au container Docker dans le dossier \/tmp\/ :\ndocker cp dump.sql mycontainer:\/tmp\/dump.sql L\u0026rsquo;inverse est possible aussi (copier du container Docker au host) :\ndocker cp mycontainer:\/tmp\/dump.sql \/chemin\/dump.sql On se connecte au container SQL de docker :\ndocker exec -ti le-container_mysql bash On lance la commande avec l\u0026rsquo;option -v ( pour voir le dump avec du \u0026ldquo;verbose\u0026rdquo; ) depuis le container SQL :\nmysql :\nmysql -v —batch -h{host} -u{user} -p nom-de-la-base-de-donnée \u0026lt; \/tmp\/bdd.sql postgresql :\npsql -U {user} -d {database} -f tmp\/dump.sql Short one :)\nBackup docker exec CONTAINER \/usr\/bin\/mysqldump -u root --password=root DATABASE \u0026gt; backup.sql Restore cat backup.sql | docker exec -i CONTAINER \/usr\/bin\/mysql -u root --password=root DATABASE </p>",
              url: "http:\/\/tech.kiboko.fr\/docker\/importer-un-dump-sql-avec-docker\/"
            },
            
            {
              value: "Nettoyer son environnement docker",
              label: "<p>Documentation https:\/\/docs.docker.com\/config\/pruning\/\nProcessus Pour libérer de l\u0026rsquo;espace sur VM, on peut lancer plusieurs commandes pour supprimer les images et les volumes qui sont non utilisés :\ndocker image prune\ndocker volume prune\nAttention à ne pas supprimer tous ses containers\n</p>",
              url: "http:\/\/tech.kiboko.fr\/docker\/clean-docker-env\/"
            },
            
            {
              value: "Trouver les grosses tables de la bdd",
              label: "<p>SQL tips Oro Pour connaître les tables de plus de 100mb :\nSELECT *, pg_size_pretty(total_bytes) AS total, pg_size_pretty(index_bytes) AS INDEX, pg_size_pretty(toast_bytes) AS toast, pg_size_pretty(table_bytes) AS TABLE FROM ( SELECT *, total_bytes-index_bytes-COALESCE(toast_bytes,0) AS table_bytes FROM ( SELECT c.oid, nspname AS table_schema, relname AS TABLE_NAME, c.reltuples AS row_estimate, pg_total_relation_size(c.oid) AS total_bytes, pg_indexes_size(c.oid) AS index_bytes, pg_total_relation_size(reltoastrelid) AS toast_bytes FROM pg_class c LEFT JOIN pg_namespace n ON n.oid = c.relnamespace WHERE relkind = \u0026#39;r\u0026#39; AND nspname=\u0026#39;public\u0026#39; ) a ) a WHERE total_bytes \u0026gt; 100000000 ORDER BY total_bytes </p>",
              url: "http:\/\/tech.kiboko.fr\/sql\/big-tables\/"
            },
            
            {
              value: "Utilisation Tmetric",
              label: "<p>Support officiel : https:\/\/tmetric.com\/support\/\n1. Outils web app : https:\/\/app.tmetric.com\/\nextension navigateur (indispensable)\nGoogle Chrome : https:\/\/chrome.google.com\/webstore\/detail\/tmetric-%E2%80%93-time-tracker-pr\/ffijoclmniipjbhecddgkfpdafpbdnen\nMozilla Firefox : https:\/\/addons.mozilla.org\/fr\/firefox\/addon\/tmetric-extension\/\n=\u0026gt; permet d\u0026rsquo;ajouter un bouton \u0026ldquo;start timer\u0026rdquo; sur le ticket (Jira\/Github)\ndesktop app : https:\/\/tmetric.com\/download 2. Saisie de temps 2.1. Depuis un ticket Dès que lon commence une tache, on déclenche l\u0026rsquo;enregistrement du temps via le bouton \u0026ldquo;Start timer\u0026rdquo; présent sur le ticket (ou la PR), une modal s\u0026rsquo;ouvre :\ntask : correspond au nom du ticket (avec son numéro) notes : surcharge le nom du ticket si modifié project : :warning: bien vérifier que le projet dans la liste déourlante est bien le bon :warning: tags : non utilisé dans Tmetric, il est préférable de les retirer à ce jour (changement à prévoir lors de l\u0026rsquo;utilisation de la version )\n2.2. Tache interne Si la tache effectuée n\u0026rsquo;a pas de ticket, c\u0026rsquo;est une tache interne (sinon on créé le ticket manquant sur le projet)\nOn peut donc ajouter un \u0026ldquo;Time entry\u0026rdquo; depuis l\u0026rsquo;application web https:\/\/app.tmetric.com\/ ou desktop.\nDans la description, utiliser l\u0026rsquo;auto-complete si la mission existe déjà et ajouter dans Project \u0026ldquo;Kiboko interne\u0026rdquo;.\nSinon on peut renseigner l\u0026rsquo;information.\n3. Autres vues 3.1. Vue \u0026ldquo;My time\u0026rdquo; =\u0026gt; https:\/\/app.tmetric.com\/\nSur cette vue, on peut suivre et vérifier sa saisie de temps et la modifier simplement si il y a des erreurs.\n3.2. Vue \u0026ldquo;Projects\u0026rdquo; Liste les différents projets disponibles, si il en manque merci de prévenir Xavier (admin) ou Dimitri (owner).\n3.3. Vue \u0026ldquo;Reports\u0026rdquo; Permet d\u0026rsquo;analyser le temps saisie par projet, tache ou équipe. Cette fonctionnalité permet d\u0026rsquo;exporter les données de l\u0026rsquo;équipe au format .csv afin de créer les CRA par client.\n</p>",
              url: "http:\/\/tech.kiboko.fr\/kibokast\/utilisation-tmetric\/"
            },
            
            {
              value: "Migrations Oro",
              label: "<p>Il y a 2 types de migrations dans Oro :\nMigrations Schema Migrations Data Doc. Oro : https:\/\/github.com\/oroinc\/platform\/tree\/master\/src\/Oro\/Bundle\/MigrationBundle\nNous vous conseillons de suivre le cours \u0026ldquo;Entities and their data\u0026rdquo; d\u0026rsquo;OroInc qui vous apprendra en détails les méthodes et bonnes pratiques pour faire eds migrations dans OroPlatform : https:\/\/oroinc.com\/oro-fundamentals-online-course\/\nExtrait : 1. Migrations Schema Modification de schéma Doctrine =\u0026gt; DBAL\nPas d\u0026rsquo;utilisation d\u0026rsquo;entité\/ORM dans le schéma 1.1. implémentation de l\u0026rsquo;interface Installation utilise des numéros de versions (=\u0026gt; getVersion())\n\/!\\ regroupement de l\u0026rsquo;ensemble des migrations pour créer le schéma\n=\u0026gt; cf Schéma de Yevhen\n1.2. implémentation de l\u0026rsquo;interface Migration \/!\\ quand on ajoute une Migration, il faut systématiquement :\najouter la migration dans l\u0026rsquo;installation en adaptant le schéma désiré changer le numéro de version 1.3. Cas spécifiques : champs non null utilisation des \u0026ldquo;OrderedMigration\u0026rdquo; =\u0026gt; getOrder():int\nEx : ajout champ UNIQUE \u002b NOT NULL\nmigration A avec up() methode alterTable() avec ajout de la colonne déclarée en NULL =\u0026gt; ajout addPostQuery() migration B avec up() methode alterTable() avec ajout de la colonne NOTNULL\n1.4. Cas spécifiques : modification de colonne existante utilisation de requêtes .SQL avec la méthode addPostQuery()\n1.5. Cas spécifiques : Oro options Utilisation de \u0026ldquo;Oro_Options\u0026rdquo;\n1.6. Cas spécifiques : OroConfigField OroConfigField uniquement pour les entités crées par ce bundle\n1.7. Cas spécifiques : entity extend Implements : ExtendExtensionInterface\n1.8. Cas spécifiques : dépendance des migrations utilisation des \u0026ldquo;DependentMigration\u0026rdquo;\n2. Migrations Data Migration pour créer de la donnée.\nExécuter après les migrations de schéma =\u0026gt; ORM\nUsage : initialiser une environnement avec des données\n\/!\\ Si Schema est mis a jour, il faut impacter les migrations de data\n3. Nomenclature des migrations 3.1. Installer Format : {nom_du_bundle}Installer\nex : KibokoBarcodeBundleInstaller\n3.2. Migration Le nom de la migration doit correspondre au fonctionnel de la migration. Si le domaine est différent, on créé des fichiers différents par domaine.\nex : AddBudgetMigration ou FixProductsNorms\n4. Tests pour vérifier la migration bin\/console oro:platform:update --force bin\/console oro:migration:load (si fixture en plus de main) bin\/console oro:entity-extend:cache:clear =\u0026gt; si erreur, PR refusée (prochainement ajouté à la CI)\n</p>",
              url: "http:\/\/tech.kiboko.fr\/kibokast\/migrations-oro\/"
            },
            
            {
              value: "Usage Github",
              label: "<p>1. Vue Kanban Dans cette vue Kanban d\u0026rsquo;un projet github, il y a :\ndes tickets des PR des notes 2. Tickets 2.1 Création\nLors de la création d\u0026rsquo;un ticket :\nChoisir le projet correspondant Choisir le milestone Ajouter les labels\/libellés 2.2 Sous-tâches\nPenser à ajouter des sous-taches dans le ticket tel que\n- [ ] Sous-tache\n(barre d\u0026rsquo;avancement sur le ticket)\nSi la sous tâche est importante possiblité de créer un nouveau ticket et de faire référence dans le ticket parent tel que :\n- [ ] Sous-tache #123\n3.3 Commentaires\nUsage du développeur :\nremonter toutes les informations dans le tickets : bug, solution à un bug\u0026hellip; identifier les utilisateurs github avec @user 3. Pull Request (PR) Lors d\u0026rsquo;une nouvelle tache, on créé une nouvelle branche git Dès le 1er commit push, on créé une nouvelle PR associé au projet et on ajoute le libellé WIP\nDès que la tache côté développeur est finie, on peut retirer le libellé WIP et renseigner un reviewer.\nLes taches du release manager :\néchanger dans la PR avec le développeur fusionner les PR tester develop\/staging\/master (vérifier que les fusions de branches fonctionnent normalement) livrer sur l\u0026rsquo;environnement correspondant en utilisant une release (version Github) 4. Releases Création via l\u0026rsquo;UI de github (tag .git \u002b commentaire)\nConvention de nommage des tags : vyyyy.mm.x\nExemple :\nv2020.02.1\nsi c\u0026rsquo;est la 1ère livraison du mois\nPre-release\nPour usage sur la branch develop\nConvention de nommage des pre-release : vyyyy.mm.xRCx\nExemple :\nv2020.02.1RC1\nsi c\u0026rsquo;est la 1ère livraison du mois\n</p>",
              url: "http:\/\/tech.kiboko.fr\/kibokast\/usage-github\/"
            },
            
            {
              value: "Kibokast",
              label: "<p></p>",
              url: "http:\/\/tech.kiboko.fr\/kibokast\/"
            },
            
            {
              value: "Composer",
              label: "<p></p>",
              url: "http:\/\/tech.kiboko.fr\/composer\/"
            },
            
            {
              value: "Environnement local",
              label: "<p></p>",
              url: "http:\/\/tech.kiboko.fr\/env-local\/"
            },
            
            {
              value: "Oro",
              label: "<p></p>",
              url: "http:\/\/tech.kiboko.fr\/oro\/"
            },
            
            {
              value: "SQL",
              label: "<p></p>",
              url: "http:\/\/tech.kiboko.fr\/sql\/"
            },
            
            {
              value: "Docker",
              label: "<p></p>",
              url: "http:\/\/tech.kiboko.fr\/docker\/"
            },
            
            {
              value: "Autre",
              label: "<p></p>",
              url: "http:\/\/tech.kiboko.fr\/autre\/"
            },
            
            {
              value: "Utilisation stack Docker Kiboko",
              label: "<p>1. Initialisation d’un projet sur dev0 avec cette stack 1.1. Initialisation du projet cloner le projet application en local git clone git@github.com:kiboko-labs\/{nom-du-projet}.git connexion ssh sur dev0 ssh kiboko@dev0.kiboko.io\nse rendre dans le répertoire www\/ cd www\/\ncloner le projet dans un répertoire nominatif tel que : git clone git@github.com:kiboko-labs\/{nom-du-projet}.git {nom-du-projet}-{NOM-DU-DEV}\nse rendre dans le répertoire créé cd {nom-du-projet}-{NOM-DU-DEV}\ncréer ma configuration phpstorm pour le déploiement sur dev0 (remote host) dans l\u0026rsquo;onglet Mapping, dans le champs Deployment path, mettre un \/ définir le remote en sftp et par défaut si vous aviez déjà au moins 1 remote paramétré et par defaut, il faut forcer le remote dev0 par defaut car c\u0026rsquo;est le remote par defaut qui sera automatiquement synchronisé depuis votre local DANGER : si par defaut est une prod\nactiver le déploiement automatique : Tools\/Déployment\/Automatic upload (les modif. locales à l’enregistrement seront deployées automatiquement)\ncreation du fichier .env à partir du fichier .env.dist\navec des ports uniques (published port) ajout du token Github ajout des tokens Blackfire ou supprimer les valeurs 1.1.1. Installation vierge make start (lance tous les services sauf WS et MQ) make install (ne pas remplir le parameters.yml à la main attendre que l’installeur le demande) 1.1.2. Installation avec un dump make start importer son dump dans le service sql make vendor platform-update 1.2. Lancement du MQ et WS avant exploitation make start-{mq,ws} 1.3.Exploitation voir la consommation des messages : docker-compose logs -f amqp\u0060 accès à RabbitMQManagement ex : http:\/\/dev0.kiboko.io:10006\/ accès au mailcatcher ex : http:\/\/dev0.kiboko.io:10004\/ accès à ElasticSearch via DejaVu ex : http:\/\/dev0.kiboko.io:10009\/ Pratique : quand vous n’utilisez plus l’environnement, make stop\n1.4. Vider le cache make cache-clear pour le cache de l\u0026rsquo;envirnonnement prod make cache-clear-dev pour le cache de l\u0026rsquo;environnement dev 1.5 Changer de branche Il est impératif de faire changer de branche sur l\u0026rsquo;environnement local et l\u0026rsquo;environnement distant. L\u0026rsquo;environnement distant réclamera d\u0026rsquo;être committé ou remis à l\u0026rsquo;état original.\n⚠️ Aucun commit ne doit être fait depuis l\u0026rsquo;environnement distant\nPour remettre les fichiers à leur état original : git reset --hard Pour checkout la nouvelle version de travail : git checkout \u0026lt;branch\u0026gt; 2. Usages particuliers utilisation xdebug via le service DBGp (à venir) 3. Ressources tiers extension navigateur qui permet de switcher en mode dev, prod et debug: https:\/\/github.com\/kiboko-labs\/kiboko-symfony-env sur Chrome :\najout extensions chrome:\/\/extensions\/ activer le mode développeur charger l\u0026rsquo;extension non empaquetée images docker : https:\/\/github.com\/kiboko-labs\/docker-images </p>",
              url: "http:\/\/tech.kiboko.fr\/kibokast\/utilisation-stack-docker-kiboko\/"
            },
            
            {
              value: "",
              label: "<p>Kubernetes Developer Environment Get the kubeconfig.yml file and use the Use the --kubeconfig=kubeconfig.yml option to all your kubectl commands Get cluster info $ kubectl --kubeconfig=kubeconfig.yml cluster-info Kubernetes master is running at https:\/\/wzb5w7.c1.gra7.k8s.ovh.net CoreDNS is running at https:\/\/wzb5w7.c1.gra7.k8s.ovh.net\/api\/v1\/namespaces\/kube-system\/services\/kube-dns:dns\/proxy Metrics-server is running at https:\/\/wzb5w7.c1.gra7.k8s.ovh.net\/api\/v1\/namespaces\/kube-system\/services\/https:metrics-server:\/proxy To further debug and diagnose cluster problems, use \u0026#39;kubectl cluster-info dump\u0026#39;. Install Kubernetes Dashboard FR: https:\/\/kubernetes.io\/fr\/docs\/tasks\/access-application-cluster\/web-ui-dashboard\/ EN: https:\/\/kubernetes.io\/docs\/tasks\/access-application-cluster\/web-ui-dashboard\/\n$ kubectl --kubeconfig=kubeconfig.yml apply -f https:\/\/raw.githubusercontent.com\/kubernetes\/dashboard\/master\/aio\/deploy\/recommended.yaml namespace\/kubernetes-dashboard created serviceaccount\/kubernetes-dashboard created service\/kubernetes-dashboard created secret\/kubernetes-dashboard-certs created secret\/kubernetes-dashboard-csrf created secret\/kubernetes-dashboard-key-holder created configmap\/kubernetes-dashboard-settings created role.rbac.authorization.k8s.io\/kubernetes-dashboard created clusterrole.rbac.authorization.k8s.io\/kubernetes-dashboard created rolebinding.rbac.authorization.k8s.io\/kubernetes-dashboard created clusterrolebinding.rbac.authorization.k8s.io\/kubernetes-dashboard created deployment.apps\/kubernetes-dashboard created service\/dashboard-metrics-scraper created deployment.apps\/dashboard-metrics-scraper created Kubectl will make Dashboard available at http:\/\/localhost:8001\/api\/v1\/namespaces\/kubernetes-dashboard\/services\/https:kubernetes-dashboard:\/proxy\/.\nYou then need to create your users if it wasn\u0026rsquo;t already done. Create a sample User: https:\/\/github.com\/kubernetes\/dashboard\/blob\/master\/docs\/user\/access-control\/creating-sample-user.md\nCreating Users for the Kubernetes Dashboard Crating a service account cat \u0026lt;\u0026lt;EOF | kubectl --kubeconfig=kubeconfig.yml apply -f - apiVersion: v1 kind: ServiceAccount metadata: name: gplanchat namespace: kubernetes-dashboard EOF Creating a ClusterRoleBinding cat \u0026lt;\u0026lt;EOF | kubectl --kubeconfig=kubeconfig.yml apply -f - apiVersion: rbac.authorization.k8s.io\/v1 kind: ClusterRoleBinding metadata: name: gplanchat roleRef: apiGroup: rbac.authorization.k8s.io kind: ClusterRole name: cluster-admin subjects: - kind: ServiceAccount name: gplanchat namespace: kubernetes-dashboard EOF Getting a bearer Token $ kubectl --kubeconfig=kubeconfig.yml -n kubernetes-dashboard describe secret $(kubectl --kubeconfig=kubeconfig.yml -n kubernetes-dashboard get secret | grep gplanchat | awk \u0026#39;{print $1}\u0026#39;) Name: gplanchat-token-w8bl4 Namespace: kubernetes-dashboard Labels: \u0026lt;none\u0026gt; Annotations: kubernetes.io\/service-account.name: gplanchat kubernetes.io\/service-account.uid: 23111bc9-376b-4b87-9ecb-9d4743f14c9e Type: kubernetes.io\/service-account-token Data ==== token: eyJh[...]pgE ca.crt: 1801 bytes namespace: 20 bytes Now copy the token and paste it into Enter token field on the login screen.\nClick Sign in button and that\u0026rsquo;s it. You are now logged in as an admin.\n</p>",
              url: "http:\/\/tech.kiboko.fr\/kubernetes\/"
            },
            
            {
              value: "",
              label: "<p>Requêtes SQL utiles Fonction Postgres pour décoder les champs serialized_data Avant toute chose, nous devons créer les fonctions nécessaires à ce décodage et qui seront réutilisables dans nos requêtes SQL :\nRéférence : https:\/\/gist.github.com\/gplanchat\/87385224d6b1d5ef7bca6c831c0cfb7c\n\/** Decode a php serialized value to json. This function only supports basic data types: - arrays (will always become a json object) - booleans - integers - floats - strings - NULL The php_unserialize(text) function is a helper function which extracts the first value found in the string and returns a ROW( vartype, varval, serializedlength) The php_unserialize_to_json(text) function returns the json value extracted from the serialized string. Examples: SELECT php_unserialize_to_json(\u0026#39;a:5:{i:0;d:1;s:1:\u0026#34;k\u0026#34;;a:3:{i:0;s:1:\u0026#34;a\u0026#34;;i:1;s:1:\u0026#34;b\u0026#34;;s:3:\u0026#34;sub\u0026#34;;a:3:{i:0;s:1:\u0026#34;a\u0026#34;;i:1;s:1:\u0026#34;b\u0026#34;;i:2;s:1:\u0026#34;c\u0026#34;;}}i:1;N;i:2;b:1;i:3;b:0;}\u0026#39;)#\u0026gt;\u0026gt;\u0026#39;{k,sub,2}\u0026#39;; SELECT php_unserialize_to_json(\u0026#39;s:8:\u0026#34;a string\u0026#34;;\u0026#39;); SELECT php_unserialize_to_json(\u0026#39;s:0:\u0026#34;\u0026#34;;\u0026#39;); SELECT php_unserialize_to_json(\u0026#39;i:1337;\u0026#39;); SELECT php_unserialize_to_json(\u0026#39;d:1.234;\u0026#39;); SELECT php_unserialize_to_json(\u0026#39;b:1;\u0026#39;)::TEXT; SELECT php_unserialize_to_json(\u0026#39;b:0;\u0026#39;)::TEXT; SELECT php_unserialize_to_json(\u0026#39;N;\u0026#39;)::TEXT; SELECT php_unserialize_to_json(\u0026#39;a:0:{}\u0026#39;)::TEXT; SELECT php_unserialize_to_json(\u0026#39;a:1:{i:0;s:5:\u0026#34;array\u0026#34;;}\u0026#39;)::TEXT; SELECT php_unserialize_to_json(\u0026#39;a:1:{i:0;i:1;}\u0026#39;)::TEXT; SELECT php_unserialize_to_json(\u0026#39;a:2:{i:0;i:1;i:1;s:1:\u0026#34;b\u0026#34;;}\u0026#39;)::TEXT; SELECT php_unserialize_to_json(\u0026#39;a:2:{i:0;d:1;s:1:\u0026#34;k\u0026#34;;s:1:\u0026#34;b\u0026#34;;}\u0026#39;)::TEXT; SELECT php_unserialize_to_json(\u0026#39;a:2:{i:0;d:1;s:1:\u0026#34;k\u0026#34;;a:2:{i:0;s:1:\u0026#34;a\u0026#34;;i:1;s:1:\u0026#34;b\u0026#34;;}}\u0026#39;)::TEXT; *\/ --- --- This function is the helper function --- CREATE OR REPLACE FUNCTION php_unserialize(str text) RETURNS json AS $BODY$ DECLARE vartype CHAR; varlength INT; jsonstr TEXT; varcount INT; jsonval JSONB; arrkey JSON; arrval JSON; extract TEXT; -- String length of the serialized data serialized_string_length INT; BEGIN CASE substring(str, 1, 1) WHEN \u0026#39;a\u0026#39; THEN -- array -- init object jsonval := \u0026#39;{}\u0026#39;::jsonb; -- remove the \u0026#34;a\u0026#34; and \u0026#34;:\u0026#34; characters str := substring(str, 3); -- Detect number of values in array varlength := substring(str, 1, position(\u0026#39;:\u0026#39; IN str) - 1)::INT; -- Base size of array is 5 (a:[size]:{}) serialized_string_length := 5 \u002b char_length(varlength::TEXT); -- If no values, return empty object, as this always returns objects IF varlength = 0 THEN return json_build_array(\u0026#39;array\u0026#39;, jsonval, serialized_string_length)::JSON; END IF; -- remove the array size and \u0026#34;:{\u0026#34; str := substring(str, char_length(varlength::TEXT) \u002b 3); -- Find the number of variables specified FOR varcount IN 1 .. varlength LOOP -- Find the value of the key and remove it from base string arrkey := php_unserialize(str); str := substring(str, (arrkey-\u0026gt;\u0026gt;2)::INT \u002b 1); -- Find the value of the value and remove it from base string arrval := php_unserialize(str); str := substring(str, (arrval-\u0026gt;\u0026gt;2)::INT \u002b 1); serialized_string_length := serialized_string_length \u002b (arrkey-\u0026gt;\u0026gt;2)::INT \u002b (arrval-\u0026gt;\u0026gt;2)::INT; -- Append value jsonval := jsonval || jsonb_build_object(arrkey-\u0026gt;\u0026gt;1, arrval-\u0026gt;1); END LOOP; return json_build_array(\u0026#39;array\u0026#39;, jsonval, serialized_string_length); WHEN \u0026#39;b\u0026#39; THEN -- boolean return json_build_array(\u0026#39;bool\u0026#39;,(CASE substring(str, 3, 1) WHEN \u0026#39;1\u0026#39; THEN TRUE ELSE FALSE END)::TEXT, 4); WHEN \u0026#39;d\u0026#39; THEN -- float return json_build_array(\u0026#39;float\u0026#39;, substring(str, 3, position(\u0026#39;;\u0026#39; IN str) - 3)::TEXT, position(\u0026#39;;\u0026#39; IN str)); WHEN \u0026#39;i\u0026#39; THEN -- int return json_build_array(\u0026#39;int\u0026#39;, substring(str, 3, position(\u0026#39;;\u0026#39; IN str) - 3)::TEXT, position(\u0026#39;;\u0026#39; IN str)); WHEN \u0026#39;N\u0026#39; THEN -- null return json_build_array(\u0026#39;null\u0026#39;, \u0026#39;null\u0026#39;::TEXT, 2); WHEN \u0026#39;s\u0026#39; THEN -- string str := substring(str,3); varlength := substring(str, 1, position(\u0026#39;:\u0026#39; IN str) - 1)::INT; extract := substring(str, char_length(varlength::TEXT) \u002b 3, varlength)::TEXT; return json_build_array(\u0026#39;string\u0026#39;, extract, varlength \u002b char_length(varlength::TEXT) \u002b 6); ELSE RAISE EXCEPTION \u0026#39;Unable to decode serialized value, unsupported type: “%”\u0026#39;, str; END CASE; END; $BODY$ LANGUAGE plpgsql IMMUTABLE COST 10; --- --- The main function --- CREATE OR REPLACE FUNCTION php_unserialize_to_json(str text) RETURNS json AS $BODY$ DECLARE varlength INT; BEGIN CASE substring(str, 1, 1) WHEN \u0026#39;a\u0026#39; THEN return php_unserialize(str)-\u0026gt;1; WHEN \u0026#39;b\u0026#39; THEN return php_unserialize(str)-\u0026gt;1; WHEN \u0026#39;d\u0026#39; THEN return php_unserialize(str)-\u0026gt;1; WHEN \u0026#39;i\u0026#39; THEN return php_unserialize(str)-\u0026gt;1; WHEN \u0026#39;N\u0026#39; THEN return php_unserialize(str)-\u0026gt;1; WHEN \u0026#39;s\u0026#39; THEN return php_unserialize(str)-\u0026gt;1; ELSE RETURN NULL; END CASE; END; $BODY$ LANGUAGE plpgsql IMMUTABLE COST 10; --- --- The main function --- CREATE OR REPLACE FUNCTION php_unserialize_to_json(str text) RETURNS json AS $BODY$ DECLARE varlength INT; BEGIN CASE substring(str, 1, 1) WHEN \u0026#39;a\u0026#39; THEN return php_unserialize(str)-\u0026gt;1; WHEN \u0026#39;b\u0026#39; THEN return php_unserialize(str)-\u0026gt;1; WHEN \u0026#39;d\u0026#39; THEN return php_unserialize(str)-\u0026gt;1; WHEN \u0026#39;i\u0026#39; THEN return php_unserialize(str)-\u0026gt;1; WHEN \u0026#39;N\u0026#39; THEN return php_unserialize(str)-\u0026gt;1; WHEN \u0026#39;s\u0026#39; THEN return php_unserialize(str)-\u0026gt;1; ELSE RETURN NULL; END CASE; END; $BODY$ LANGUAGE plpgsql IMMUTABLE COST 10; --- --- The combined base64 decode and unserialization function --- CREATE OR REPLACE FUNCTION oro_unserialize_to_json(str text) RETURNS json AS $BODY$ BEGIN return php_unserialize_to_json(convert_from(decode(str, \u0026#39;base64\u0026#39;), \u0026#39;UTF8\u0026#39;)); END; $BODY$ LANGUAGE plpgsql IMMUTABLE COST 10; Puis, dans toute requête SQL, utiliser la fonction telle que fait sur la 3e colonne de la requête suivante :\nSELECT product.id, product.sku, oro_unserialize_to_json(product.serialized_data) FROM oro_product AS product Les opérateurs JSON standard peuvent être utilisés sur cette colonne, comme par exemple :\nSELECT product.id, product.sku, oro_unserialize_to_json(product.serialized_data) -\u0026gt;\u0026gt; \u0026#39;ak_date_peremption\u0026#39; AS ak_date_peremption FROM oro_product AS product https:\/\/www.postgresqltutorial.com\/postgresql-json\/\n</p>",
              url: "http:\/\/tech.kiboko.fr\/oro\/sql\/"
            },
            
            {
              value: "Categories",
              label: "<p></p>",
              url: "http:\/\/tech.kiboko.fr\/categories\/"
            },
            
            {
              value: "Mentions légales",
              label: "<p>Editeur du site Kiboko\n16 avenue Clément Charbonnier\n43000 Le Puy-en-Velay\nFrance\nConditions d\u0026rsquo;utilisation Le site accessible par l\u0026rsquo;url suivante : tech.kiboko.fr, est exploité dans le respect de la législation française. L\u0026rsquo;utilisation de ce site est régie par les présentes conditions générales. En utilisant le site, vous reconnaissez avoir pris connaissance de ces conditions et les avoir acceptées. Celles-ci pourront êtres modifiées à tout moment et sans préavis par la société Kiboko. Kiboko ne saurait être tenu pour responsable en aucune manière d’une mauvaise utilisation du service.\nLimitation de responsabilité Les informations contenues sur ce site sont aussi précises que possibles et le site est périodiquement remis à jour, mais peut toutefois contenir des inexactitudes, des omissions ou des lacunes. Si vous constatez une lacune, erreur ou ce qui parait être un dysfonctionnement, merci de bien vouloir le signaler par email en décrivant le problème de la manière la plus précise possible (page posant problème, action déclenchante, type d’ordinateur et de navigateur utilisé\u0026hellip;).\nTout contenu téléchargé se fait aux risques et périls de l\u0026rsquo;utilisateur et sous sa seule responsabilité. En conséquence, Kiboko ne saurait être tenu responsable d\u0026rsquo;un quelconque dommage subi par l\u0026rsquo;ordinateur de l\u0026rsquo;utilisateur ou d\u0026rsquo;une quelconque perte de données consécutives au téléchargement.\nLes photos sont non contractuelles. Les liens hypertextes mis en place dans le cadre du présent site internet en direction d\u0026rsquo;autres ressources présentes sur le réseau Internet ne sauraient engager la responsabilité de Kiboko.\nLitiges Les présentes conditions sont régies par les lois françaises et toute contestation ou litiges qui pourraient naître de l\u0026rsquo;interprétation ou de l\u0026rsquo;exécution de celles-ci seront de la compétence exclusive des tribunaux dont dépend le siège social de la société Kiboko. La langue de référence, pour le règlement de contentieux éventuels, est le français.\nConfidentialité Vos données personnelles sont confidentielles et ne seront en aucun cas communiquées à des tiers hormis pour la bonne exécution de la prestation.\nPropriété intellectuelle Tout le contenu du présent site, incluant, de façon non limitative, les graphismes, images, textes, vidéos, animations, sons, logos, gifs et icônes ainsi que leur mise en forme sont la propriété exclusive de la société Kiboko à l\u0026rsquo;exception des marques, logos ou contenus appartenant à d\u0026rsquo;autres sociétés partenaires ou auteurs. Toute reproduction, distribution, modification, adaptation, retransmission ou publication, même partielle, de ces différents éléments est strictement interdite sans l\u0026rsquo;accord exprès par écrit de Kiboko. Cette représentation ou reproduction, par quelque procédé que ce soit, constitue une contrefaçon sanctionnée par les articles L.3335-2 et suivants du Code de la propriété intellectuelle. Le non-respect de cette interdiction constitue une contrefaçon pouvant engager la responsabilité civile et pénale du contrefacteur. En outre, les propriétaires des Contenus copiés pourraient intenter une action en justice à votre encontre.\nKiboko est identiquement propriétaire des \u0026ldquo;droits des producteurs de bases de données\u0026rdquo; visés au Livre III, Titre IV, du Code de la Propriété Intellectuelle (loi n° 98-536 du 1er juillet 1998) relative aux droits d\u0026rsquo;auteur et aux bases de données.\nLes utilisateurs et visiteurs du site internet peuvent mettre en place un hyperlien en direction de ce site, mais uniquement en direction de la page d’accueil, accessible à l’URL suivante : www.site-internet-qualite.fr, à condition que ce lien s’ouvre dans une nouvelle fenêtre. En particulier un lien vers une sous page (« lien profond ») est interdit, ainsi que l’ouverture du présent site au sein d’un cadre (« framing »), sauf l\u0026rsquo;autorisation expresse et préalable de .\nPour toute demande d\u0026rsquo;autorisation ou d\u0026rsquo;information, veuillez nous contacter par email : hello@kiboko.fr. Des conditions spécifiques sont prévues pour la presse.\nPar ailleurs, la mise en forme de ce site a nécessité le recours à des sources externes dont nous avons acquis les droits ou dont les droits d\u0026rsquo;utilisation sont ouverts.\nHébergeur GitHub Pages : https:\/\/pages.github.com\/\nConditions de service Ce site est proposé en langages HTML5 et CSS3, pour un meilleur confort d\u0026rsquo;utilisation et un graphisme plus agréable, nous vous recommandons de recourir à des navigateurs modernes comme Chrome \u0026amp; Firefox\n</p>",
              url: "http:\/\/tech.kiboko.fr\/legal-notice\/"
            },
            
            {
              value: "Tags",
              label: "<p></p>",
              url: "http:\/\/tech.kiboko.fr\/tags\/"
            },
            
          ];
          $("#search").autocomplete({
            source: projects
          })
          .data("ui-autocomplete")._renderItem = function (ul, item) {
            return $("<li>")
            .append("<a href=" + item.url + " + \" &quot;\" +  >" + item.value + "</a>" + item.label)
            .appendTo(ul);
          };
          });
        </script>
      </div>
    </div>
  </div>
</div>
<!-- /banner -->
    </header>
    <!-- /header -->
    
    

  <!-- topics -->
  <section class="section">
    <div class="container">
      <div class="row justify-content-center">
        <div class="col-12 text-center">
          <h2 class="section-title"></h2>
        </div>
        <!-- topic-item -->
        
        <div class="col-lg-4 col-sm-6 mb-4">
          <a href="http://tech.kiboko.fr/kibokast/" class="px-4 py-5 bg-white shadow text-center d-block match-height">
            <i class="ti-blackboard icon text-primary d-block mb-4"></i>
            <h3 class="mb-3 mt-0">Kibokast</h3>
            <p class="mb-0">Les Kibokast sont des mini-formations tenues par un membre de Kiboko pour le reste de l&#39;équipe. Voici la liste des sujets.</p>
          </a>
        </div>
        
        <div class="col-lg-4 col-sm-6 mb-4">
          <a href="http://tech.kiboko.fr/composer/" class="px-4 py-5 bg-white shadow text-center d-block match-height">
            <i class="ti-light-bulb icon text-primary d-block mb-4"></i>
            <h3 class="mb-3 mt-0">Composer</h3>
            <p class="mb-0">La catégorie Composer tutos/tips pour utiliser Composer</p>
          </a>
        </div>
        
        <div class="col-lg-4 col-sm-6 mb-4">
          <a href="http://tech.kiboko.fr/env-local/" class="px-4 py-5 bg-white shadow text-center d-block match-height">
            <i class="ti-light-bulb icon text-primary d-block mb-4"></i>
            <h3 class="mb-3 mt-0">Environnement local</h3>
            <p class="mb-0">La catégorie Environnement local regroupe des tutos/tips pour configurer son env pour travailler avec Oro</p>
          </a>
        </div>
        
        <div class="col-lg-4 col-sm-6 mb-4">
          <a href="http://tech.kiboko.fr/oro/" class="px-4 py-5 bg-white shadow text-center d-block match-height">
            <i class="ti-light-bulb icon text-primary d-block mb-4"></i>
            <h3 class="mb-3 mt-0">Oro</h3>
            <p class="mb-0">La catégorie Oro regroupe l&#39;ensemble des technologies OroCommerce, OroPlatform et OroCRM.</p>
          </a>
        </div>
        
        <div class="col-lg-4 col-sm-6 mb-4">
          <a href="http://tech.kiboko.fr/sql/" class="px-4 py-5 bg-white shadow text-center d-block match-height">
            <i class="ti-light-bulb icon text-primary d-block mb-4"></i>
            <h3 class="mb-3 mt-0">SQL</h3>
            <p class="mb-0">La catégorie SQL tutos/tips concernant le language SQL / les bases de données</p>
          </a>
        </div>
        
        <div class="col-lg-4 col-sm-6 mb-4">
          <a href="http://tech.kiboko.fr/docker/" class="px-4 py-5 bg-white shadow text-center d-block match-height">
            <i class="ti-server icon text-primary d-block mb-4"></i>
            <h3 class="mb-3 mt-0">Docker</h3>
            <p class="mb-0">Pour nos développements, nous utilisons Docker avec une stack spécifique. Voici quelques méthodes que nous utilisons.</p>
          </a>
        </div>
        
        <div class="col-lg-4 col-sm-6 mb-4">
          <a href="http://tech.kiboko.fr/autre/" class="px-4 py-5 bg-white shadow text-center d-block match-height">
            <i class="ti-notepad icon text-primary d-block mb-4"></i>
            <h3 class="mb-3 mt-0">Autre</h3>
            <p class="mb-0">Différentes documentations non typées.</p>
          </a>
        </div>
        
      </div>
    </div>
  </section>
  <!-- /topics -->

  
  
  <!-- call to action -->
  <section>
    <div class="container">
      <div class="row">
        <div class="col-12">
          <div class="section px-3 bg-white shadow text-center">
          <h2 class="mb-4">Vous avez une question ?</h2>
          <p class="mb-4"></p>
          
          
          <a href="http://kiboko.fr/fr/contactez-nous/" class="btn btn-primary">Contactez-nous</a>
          
          
          </div>
        </div>
      </div>
    </div>
  </section>
  <!-- /call to action -->
  
  


    <!-- footer -->
<footer class="section pb-4">
  <div class="container">
    <div class="row align-items-center">
      <div class="col-md-8 text-md-left text-center">
        <!-- legal notice -->
          <a href="/legal-notice">
            <p class="mb-md-0 mb-4">Mentions légales</p>
          </a>
        <!-- /legal notice -->
      </div>
      <div class="col-md-4 text-md-right text-center">
        <ul class="list-inline list-social">
          
          <li class="list-inline-item"><a class="text-color d-inline-block p-2" href="https://twitter.com/kibokolabs"><i class="ti-twitter-alt"></i></a></li>
          
          <li class="list-inline-item"><a class="text-color d-inline-block p-2" href="https://github.com/kiboko-labs"><i class="ti-github"></i></a></li>
          
          <li class="list-inline-item"><a class="text-color d-inline-block p-2" href="https://www.linkedin.com/company/kiboko-sas"><i class="ti-linkedin"></i></a></li>
          
          <li class="list-inline-item"><a class="text-color d-inline-block p-2" href="http://kiboko.fr/fr/"><i class="ti-wordpress"></i></a></li>
          
        </ul>
      </div>
    </div>
  </div>
</footer>
<!-- /footer -->

<!-- Main Script -->

<script src="http://tech.kiboko.fr/js/script.min.js"></script>

  </body>

</html>