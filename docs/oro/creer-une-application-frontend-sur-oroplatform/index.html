<!DOCTYPE html>
<html lang="fr-fr">
  <head>
  <meta charset="utf-8">
  <title>Créer une application frontend sur OroPlatform</title>

  <meta name="generator" content="Hugo 0.147.3">

  <!-- mobile responsive meta -->
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  
  <!-- ** Plugins Needed for the Project ** -->
  <!-- Bootstrap -->
  <link rel="stylesheet" href="https://tech.kiboko.fr/plugins/bootstrap/bootstrap.min.css">

  <!-- themefy-icon -->
  <link rel="stylesheet" href="https://tech.kiboko.fr/plugins/themify-icons/themify-icons.css">

  <!-- highlight -->
  <link rel="stylesheet" href="https://tech.kiboko.fr/plugins/highlight/hybrid.css">

  <!--Favicon-->
  <link rel="icon" href="https://tech.kiboko.fr/images/favicon.png" type="image/x-icon">

  <!-- fonts -->
  <link href="https://fonts.googleapis.com/css?family=Libre%20Franklin%2c%20Helvetica%20Neue%2c%20Helvetica%2c%20Arial%2c%20Sans-Serif:300,400,700&display=swap" rel="stylesheet">
  
  <style>
  :root{
    --primary-color: #222;
    --body-color:#ddd;
    --text-color:#000;
    --text-color-dark:#333;
    --white-color:#eee;
    --light-color:#ddd;
    --font-family:Libre Franklin, Helvetica Neue, Helvetica, Arial, Sans-Serif;
  }
  </style>

<!-- Main Stylesheet -->

<link href="https://tech.kiboko.fr/css/style.min.css" rel="stylesheet" media="screen"/>

<!-- jquiry -->
<script src="https://tech.kiboko.fr/plugins/jquery/jquery-1.12.4.js"></script>

<!-- jquary ui -->
<script src="https://tech.kiboko.fr/plugins/jquery/jquery-ui.js"></script>

<!-- Bootstrap JS -->
<script src="https://tech.kiboko.fr/plugins/bootstrap/bootstrap.min.js"></script>

<!-- match-height JS -->
<script src="https://tech.kiboko.fr/plugins/match-height/jquery.matchHeight-min.js"></script>

<!-- highlight -->
<script src="https://tech.kiboko.fr/plugins/highlight/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>



</head>
  
  <body>
    
    <!-- header -->
    <header class="shadow-bottom sticky-top bg-white">
      <nav class="navbar navbar-expand-md navbar-light">
  <div class="container">
    <a class="navbar-brand px-2" href="/">
      
      
      
      
      <div class="navbar-brand">
          <img class="img-fluid" src="https://tech.kiboko.fr/images/logo.png" alt="Tech.Kiboko.fr">
          <span class="title">Tech.Kiboko.fr</span>
      </div>
      
      
    </a>
    <button class="navbar-toggler border-0" type="button" data-toggle="collapse" data-target="#navigation"
      aria-controls="navigation" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse text-center" id="navigation">
      <ul class="navbar-nav ml-auto">
        <li class="nav-item">
          <a class="nav-link text-dark" href="/"></a>
        </li>
        
        
        <li class="nav-item">
          <a class="nav-link text-dark" href="/kibokast">Kibokast</a>
        </li>
        
        
        
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle text-dark" href="#" role="button" data-toggle="dropdown"
            aria-haspopup="true" aria-expanded="false">
            docs
          </a>
          <div class="dropdown-menu">
            
            <a class="dropdown-item" href="/oro">Oro</a>
            
            <a class="dropdown-item" href="/docker">Docker</a>
            
            <a class="dropdown-item" href="/autre">Autre</a>
            
            <a class="dropdown-item" href="/composer">Composer</a>
            
            <a class="dropdown-item" href="/env-local">Environnement local</a>
            
            <a class="dropdown-item" href="/kubernetes">Kubernetes</a>
            
            <a class="dropdown-item" href="/sql">SQL</a>
            
          </div>
        </li>
        
        
        
        <li class="nav-item">
          <a class="nav-link text-dark" href="http://kiboko.fr/fr/contactez-nous/">Contactez-nous</a>
        </li>
        
        
      </ul>
      
    </div>
  </div>
</nav>

    </header>
    <!-- /header -->
    
    

<!-- details page -->
<section class="single section-sm pb-0">
  <div class="container">
    <div class="row">
      <div class="col-lg-3">
        <div class="sidebar">
          <ul class="list-styled">
            
            <a class="back-btn" href="/"></a>
            
              
            
              
            
              
            
              
              








<li data-nav-id="https://tech.kiboko.fr/oro/" title="Oro" class="sidelist
  ">
  <a href="https://tech.kiboko.fr/oro/">
    Oro
  </a>
  
  
    <ul>
      
        
          








<li data-nav-id="https://tech.kiboko.fr/oro/back/" title="Back" class="sidelist
  ">
  <a href="https://tech.kiboko.fr/oro/back/">
    Back
  </a>
  
  
    <ul>
      
        
          








<li data-nav-id="https://tech.kiboko.fr/oro/back/order-field-in-migration/" title="Changer l&#39;ordre d&#39;affichage des champs dans les migrations" class="sidelist
  ">
  <a href="https://tech.kiboko.fr/oro/back/order-field-in-migration/">
    Changer l&#39;ordre d&#39;affichage des champs dans les migrations
  </a>
  
  
</li>


        
      
        
          








<li data-nav-id="https://tech.kiboko.fr/oro/back/extend-entity/" title="Etendre une entité" class="sidelist
  ">
  <a href="https://tech.kiboko.fr/oro/back/extend-entity/">
    Etendre une entité
  </a>
  
  
</li>


        
      
    </ul>
  
</li>


        
      
        
          








<li data-nav-id="https://tech.kiboko.fr/oro/datagrid/" title="Datagrid" class="sidelist
  ">
  <a href="https://tech.kiboko.fr/oro/datagrid/">
    Datagrid
  </a>
  
  
    <ul>
      
        
          








<li data-nav-id="https://tech.kiboko.fr/oro/datagrid/afficher-dynamiquement-une-action/" title="Afficher dynamiquement une action de datagrid" class="sidelist
  ">
  <a href="https://tech.kiboko.fr/oro/datagrid/afficher-dynamiquement-une-action/">
    Afficher dynamiquement une action de datagrid
  </a>
  
  
</li>


        
      
        
          








<li data-nav-id="https://tech.kiboko.fr/oro/datagrid/mass-actions-product-grid/" title="Ajouter une mass action dans la grille produit" class="sidelist
  ">
  <a href="https://tech.kiboko.fr/oro/datagrid/mass-actions-product-grid/">
    Ajouter une mass action dans la grille produit
  </a>
  
  
</li>


        
      
    </ul>
  
</li>


        
      
        
          








<li data-nav-id="https://tech.kiboko.fr/oro/front/" title="Front" class="sidelist
  ">
  <a href="https://tech.kiboko.fr/oro/front/">
    Front
  </a>
  
  
    <ul>
      
        
          








<li data-nav-id="https://tech.kiboko.fr/oro/front/add-consent-on-registration/" title="Ajouter  un Consent sur la page d&#39;inscription" class="sidelist
  ">
  <a href="https://tech.kiboko.fr/oro/front/add-consent-on-registration/">
    Ajouter  un Consent sur la page d&#39;inscription
  </a>
  
  
</li>


        
      
        
          








<li data-nav-id="https://tech.kiboko.fr/oro/front/create-form-frontend/" title="Creer un formulaite en front" class="sidelist
  ">
  <a href="https://tech.kiboko.fr/oro/front/create-form-frontend/">
    Creer un formulaite en front
  </a>
  
  
</li>


        
      
    </ul>
  
</li>


        
      
        
          








<li data-nav-id="https://tech.kiboko.fr/oro/select-type-in-oro-config/" title="Utiliser un champ select d&#39;entité dans la config Oro" class="sidelist
  ">
  <a href="https://tech.kiboko.fr/oro/select-type-in-oro-config/">
    Utiliser un champ select d&#39;entité dans la config Oro
  </a>
  
  
</li>


        
      
        
          








<li data-nav-id="https://tech.kiboko.fr/oro/test/" title="Tester avec Oro" class="sidelist
  ">
  <a href="https://tech.kiboko.fr/oro/test/">
    Tester avec Oro
  </a>
  
  
    <ul>
      
        
          








<li data-nav-id="https://tech.kiboko.fr/oro/test/behat/" title="Tests Behat" class="sidelist
  ">
  <a href="https://tech.kiboko.fr/oro/test/behat/">
    Tests Behat
  </a>
  
  
    <ul>
      
        
          








<li data-nav-id="https://tech.kiboko.fr/oro/test/behat/behat-autoloading/" title="Autoloading" class="sidelist
  ">
  <a href="https://tech.kiboko.fr/oro/test/behat/behat-autoloading/">
    Autoloading
  </a>
  
  
</li>


        
      
        
          








<li data-nav-id="https://tech.kiboko.fr/oro/test/behat/behat-configuration/" title="Configuration" class="sidelist
  ">
  <a href="https://tech.kiboko.fr/oro/test/behat/behat-configuration/">
    Configuration
  </a>
  
  
</li>


        
      
        
          








<li data-nav-id="https://tech.kiboko.fr/oro/test/behat/behat-conventions/" title="Conventions" class="sidelist
  ">
  <a href="https://tech.kiboko.fr/oro/test/behat/behat-conventions/">
    Conventions
  </a>
  
  
</li>


        
      
        
          








<li data-nav-id="https://tech.kiboko.fr/oro/test/behat/behat-elements-form/" title="Elements form" class="sidelist
  ">
  <a href="https://tech.kiboko.fr/oro/test/behat/behat-elements-form/">
    Elements form
  </a>
  
  
</li>


        
      
        
          








<li data-nav-id="https://tech.kiboko.fr/oro/test/behat/behat-exemples/" title="exemples" class="sidelist
  ">
  <a href="https://tech.kiboko.fr/oro/test/behat/behat-exemples/">
    exemples
  </a>
  
  
</li>


        
      
        
          








<li data-nav-id="https://tech.kiboko.fr/oro/test/behat/behat-fixtures/" title="Fixtures" class="sidelist
  ">
  <a href="https://tech.kiboko.fr/oro/test/behat/behat-fixtures/">
    Fixtures
  </a>
  
  
</li>


        
      
        
          








<li data-nav-id="https://tech.kiboko.fr/oro/test/behat/behat-isolation/" title="Isolation" class="sidelist
  ">
  <a href="https://tech.kiboko.fr/oro/test/behat/behat-isolation/">
    Isolation
  </a>
  
  
</li>


        
      
        
          








<li data-nav-id="https://tech.kiboko.fr/oro/test/behat/behat-symfony/" title="Symfony" class="sidelist
  ">
  <a href="https://tech.kiboko.fr/oro/test/behat/behat-symfony/">
    Symfony
  </a>
  
  
</li>


        
      
        
          








<li data-nav-id="https://tech.kiboko.fr/oro/test/behat/behat-tips/" title="Tips" class="sidelist
  ">
  <a href="https://tech.kiboko.fr/oro/test/behat/behat-tips/">
    Tips
  </a>
  
  
</li>


        
      
    </ul>
  
</li>


        
      
        
          








<li data-nav-id="https://tech.kiboko.fr/oro/test/functional/functional/" title="Tests fonctionnel avec PHPUnit" class="sidelist
  ">
  <a href="https://tech.kiboko.fr/oro/test/functional/functional/">
    Tests fonctionnel avec PHPUnit
  </a>
  
  
</li>


        
      
        
          








<li data-nav-id="https://tech.kiboko.fr/oro/test/javascript/javascript/" title="Tests unitaire en Javascript" class="sidelist
  ">
  <a href="https://tech.kiboko.fr/oro/test/javascript/javascript/">
    Tests unitaire en Javascript
  </a>
  
  
</li>


        
      
    </ul>
  
</li>


        
      
        
          








<li data-nav-id="https://tech.kiboko.fr/oro/creer-une-application-frontend-sur-oroplatform/" title="Créer une application frontend sur OroPlatform" class="sidelist
  active">
  <a href="https://tech.kiboko.fr/oro/creer-une-application-frontend-sur-oroplatform/">
    Créer une application frontend sur OroPlatform
  </a>
  
  
</li>


        
      
        
          








<li data-nav-id="https://tech.kiboko.fr/oro/block-types/" title="Les types de blocks dans Oro" class="sidelist
  ">
  <a href="https://tech.kiboko.fr/oro/block-types/">
    Les types de blocks dans Oro
  </a>
  
  
</li>


        
      
        
          








<li data-nav-id="https://tech.kiboko.fr/oro/commandes-utiles/" title="Commandes utiles" class="sidelist
  ">
  <a href="https://tech.kiboko.fr/oro/commandes-utiles/">
    Commandes utiles
  </a>
  
  
</li>


        
      
        
          








<li data-nav-id="https://tech.kiboko.fr/oro/sql/" title="" class="sidelist
  ">
  <a href="https://tech.kiboko.fr/oro/sql/">
    
  </a>
  
  
</li>


        
      
    </ul>
  
</li>


              
            
              
            
              
            
              
            
              
            
          </ul>
        </div>
      </div>
      <div class="col-lg-9">
        <div class="p-lg-5 p-4 bg-white">
          <h2 class="mb-5 category-title">
              
              Créer une application frontend sur OroPlatform
          </h2>
          <p></p>
          
            <p class="post-meta border-bottom pb-3 mb-0 mt-3">20/05/2020</p>
          
          
          <div class="content"><p>OroPlatform fournit un environnement complet pour créér des applications métier dédiées à une équipe interne d&rsquo;une entreprise.
Il ne fournit cependant pas d&rsquo;interface pubique à destination de tiers, à l&rsquo;exception notable de l&rsquo;interface <em>OroCommerce Store Front</em>.</p>
<p>Nous allons créer un socle d&rsquo;application OroPlatform qui disposera d&rsquo;un accès client. Par défaut, une application OroPlatform dispose
d&rsquo;une seule application déclarée, nommée <code>default</code>. C&rsquo;est sur cette application que l&rsquo;on développe des interfaces métier, nous allons
chercher à créer une seconde application nommée <code>helpdesk_portal</code></p>
<h2 id="architecture">Architecture</h2>
<p>Nous allons nous appliquer à créer cette application sur OroPlatform 4.1 Community Edition et Symfony 4.4.</p>
<p>Nous tenterons de respecter une organisation de notre code en DDD - <em>Domain Driven Development</em></p>
<pre tabindex="0"><code>src/
 └ HelpDeskPortal/
    ├	Bundle/
    │  ├ DependencyInjection/
    │  │  │ Configuration.php
    │  │  └ KibokoHelpDeskPortalExtension.php
    │  ├ Resources/
    │  │  └ config/
    │  │     └ oro/
    │  └ KibokoHelpDeskPortalBundle.php
    ├ Domain/
    │  └ Frontend/
    └ Infrastructure/
       ├ Persistence/
       │  └ Doctrine/
       │     └ Repository/
       └ Symfony/
          ├ DependencyInjection/
          ├ Request/
          ├ Router/
          └ Session/
</code></pre><h2 id="créer-le-projet">Créer le projet</h2>
<p>Nous allons partir d&rsquo;un projet OroPlatform CE 4.1 vierge.</p>
<pre tabindex="0"><code>git clone git@github.com:oroinc/platform-application.git helpdesk-application
cd helpdesk-application
git checkout 4.1.2
rm -rf .git
git init
git add -A .
git commit -m &#34;Initial commit from git@github.com:oroinc/platform-application.git atr version 4.1.2&#34;
composer install
</code></pre><h2 id="routage">Routage</h2>
<p>Dans le but de simplification, nous allons activer l&rsquo;auto-wiring sur notre composant de routage :</p>
<h3 id="autowiring">Autowiring</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">services</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">Kiboko\HelpDeskPortal\Infrastructure\Symfony\Router\</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">resource</span>: <span style="color:#e6db74">&#39;../src/HelpDeskPortal/Infrastructure/Router&#39;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">autowire</span>: <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">autoconfigure</span>: <span style="color:#66d9ef">true</span>
</span></span></code></pre></div><h3 id="ajouter-un-préfixe-aux-routes-oroplatform">Ajouter un préfixe aux routes OroPlatform</h3>
<p>Pour la première étape, nous allons ajouter un préfixe <code>admin/</code> à nos routes standard OroPlatform, comme le fait OroCommerce.</p>
<p>Nous utiliserons le paramètre de configuration <code>%web_backend_prefix%</code> pour définir facilement cette valeur. Nous profiterons
que OroCommerce ait déjà défini ce paramètre.</p>
<p>Nous alons utiliser un event listener qui va retraiter les déclarations de routes, tel que :</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#f92672">&lt;?</span><span style="color:#a6e22e">php</span> <span style="color:#66d9ef">declare</span>(<span style="color:#a6e22e">strict_types</span><span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">namespace</span> <span style="color:#a6e22e">Kiboko\HelpDeskPortal\Infrastructure\Symfony\Router\EventListener</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">use</span> <span style="color:#a6e22e">Oro\Bundle\ApiBundle\ApiDoc\RestRouteOptionsResolver</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">use</span> <span style="color:#a6e22e">Oro\Bundle\DistributionBundle\Event\RouteCollectionEvent</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">use</span> <span style="color:#a6e22e">Symfony\Component\Routing\Route</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">RouteCollectionListener</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#66d9ef">OPTION_FRONTEND</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;helpdesk_portal&#39;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#a6e22e">string</span> $prefix;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">__construct</span>(<span style="color:#a6e22e">string</span> $prefix)
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">prefix</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">trim</span>(<span style="color:#a6e22e">trim</span>($prefix), <span style="color:#e6db74">&#39;/&#39;</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">onCollectionAutoload</span>(<span style="color:#a6e22e">RouteCollectionEvent</span> $event)<span style="color:#f92672">:</span> <span style="color:#a6e22e">void</span>
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (<span style="color:#e6db74">&#39;&#39;</span> <span style="color:#f92672">===</span> $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">prefix</span>) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">/** @var Route $route */</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">foreach</span> ($event<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">getCollection</span>()<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">getIterator</span>() <span style="color:#66d9ef">as</span> $route) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> ($route<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">hasOption</span>(<span style="color:#a6e22e">self</span><span style="color:#f92672">::</span><span style="color:#a6e22e">OPTION_FRONTEND</span>) <span style="color:#f92672">&amp;&amp;</span> $route<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">getOption</span>(<span style="color:#a6e22e">self</span><span style="color:#f92672">::</span><span style="color:#a6e22e">OPTION_FRONTEND</span>)) {
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">continue</span>;
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span>$this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">hasPrefix</span>($route<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">getPath</span>())) {
</span></span><span style="display:flex;"><span>                $route<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">setPath</span>($this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">prefix</span> <span style="color:#f92672">.</span> $route<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">getPath</span>());
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> ($route<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">hasOption</span>(<span style="color:#a6e22e">RestRouteOptionsResolver</span><span style="color:#f92672">::</span><span style="color:#a6e22e">OVERRIDE_PATH_OPTION</span>)) {
</span></span><span style="display:flex;"><span>                $overridePath <span style="color:#f92672">=</span> $route<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">getOption</span>(<span style="color:#a6e22e">RestRouteOptionsResolver</span><span style="color:#f92672">::</span><span style="color:#a6e22e">OVERRIDE_PATH_OPTION</span>);
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span>$this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">hasPrefix</span>($overridePath)) {
</span></span><span style="display:flex;"><span>                    $route<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">setOption</span>(
</span></span><span style="display:flex;"><span>                        <span style="color:#a6e22e">RestRouteOptionsResolver</span><span style="color:#f92672">::</span><span style="color:#a6e22e">OVERRIDE_PATH_OPTION</span>,
</span></span><span style="display:flex;"><span>                        $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">addPrefix</span>($overridePath)
</span></span><span style="display:flex;"><span>                    );
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">hasPrefix</span>(<span style="color:#a6e22e">string</span> $path)<span style="color:#f92672">:</span> <span style="color:#a6e22e">bool</span>
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        $prefix <span style="color:#f92672">=</span> $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">prefix</span> <span style="color:#f92672">.</span> <span style="color:#e6db74">&#39;/&#39;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ae81ff">0</span> <span style="color:#f92672">===</span> <span style="color:#a6e22e">strpos</span>($path, $prefix)
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">||</span> <span style="color:#ae81ff">0</span> <span style="color:#f92672">===</span> <span style="color:#a6e22e">strpos</span>($path, <span style="color:#e6db74">&#39;/&#39;</span> <span style="color:#f92672">.</span> $prefix);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">addPrefix</span>(<span style="color:#a6e22e">string</span> $path)<span style="color:#f92672">:</span> <span style="color:#a6e22e">string</span>
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (<span style="color:#ae81ff">0</span> <span style="color:#f92672">===</span> <span style="color:#a6e22e">strpos</span>($path, <span style="color:#e6db74">&#39;/&#39;</span>)) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#39;/&#39;</span> <span style="color:#f92672">.</span> $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">prefix</span> <span style="color:#f92672">.</span> $path;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">prefix</span> <span style="color:#f92672">.</span> <span style="color:#e6db74">&#39;/&#39;</span> <span style="color:#f92672">.</span> $path;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Et la déclaration de service qui lui correspond :</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">services</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">Kiboko\HelpDeskPortal\Infrastructure\Symfony\Router\EventListener\RouteCollectionListener</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">arguments</span>:
</span></span><span style="display:flex;"><span>      - <span style="color:#e6db74">&#39;%web_backend_prefix%&#39;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">tags</span>:
</span></span><span style="display:flex;"><span>      - { <span style="color:#f92672">name: kernel.event_listener, event: oro_distribution.route_collection.expose, method: onCollectionAutoload, priority</span>: <span style="color:#ae81ff">120</span> }
</span></span><span style="display:flex;"><span>      - { <span style="color:#f92672">name: kernel.event_listener, event: oro_distribution.route_collection.autoload, method: onCollectionAutoload, priority</span>: <span style="color:#ae81ff">120</span> }
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">lazy</span>: <span style="color:#66d9ef">true</span>
</span></span></code></pre></div><h3 id="extracteur-de-routes-frontend">Extracteur de routes frontend</h3>
<p>Pour pouvoir exporter les routes javascript, nous avons besoin d&rsquo;extraire les routes du portail Helpdesk.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#f92672">&lt;?</span><span style="color:#a6e22e">php</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">namespace</span> <span style="color:#a6e22e">Kiboko\HelpDeskPortal\Infrastructure\Symfony\Router</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">use</span> <span style="color:#a6e22e">FOS\JsRoutingBundle\Extractor\ExposedRoutesExtractor</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">use</span> <span style="color:#a6e22e">Symfony\Component\Routing\Route</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">/**
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> * Expose routes which marked with option `helpdesk_portal: true`.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"> */</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">PortalExposedRoutesExtractor</span> <span style="color:#66d9ef">extends</span> <span style="color:#a6e22e">ExposedRoutesExtractor</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">/**
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">     * {@inheritdoc}
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">isRouteExposed</span>(<span style="color:#a6e22e">Route</span> $route, $name)
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">parent</span><span style="color:#f92672">::</span><span style="color:#a6e22e">isRouteExposed</span>($route, $name) <span style="color:#f92672">&amp;&amp;</span>
</span></span><span style="display:flex;"><span>            $route<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">hasOption</span>(<span style="color:#e6db74">&#39;helpdesk_portal&#39;</span>) <span style="color:#f92672">&amp;&amp;</span>
</span></span><span style="display:flex;"><span>            $route<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">getOption</span>(<span style="color:#e6db74">&#39;helpdesk_portal&#39;</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">/**
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">     * {@inheritdoc}
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">getCachePath</span>($locale)
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        $path <span style="color:#f92672">=</span> <span style="color:#66d9ef">parent</span><span style="color:#f92672">::</span><span style="color:#a6e22e">getCachePath</span>($locale);
</span></span><span style="display:flex;"><span>        $fileName <span style="color:#f92672">=</span> <span style="color:#a6e22e">basename</span>($path);
</span></span><span style="display:flex;"><span>        $fileName <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;helpdesk_portal_&#39;</span><span style="color:#f92672">.</span>$fileName;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">dirname</span>($path) <span style="color:#f92672">.</span> <span style="color:#a6e22e">DIRECTORY_SEPARATOR</span> <span style="color:#f92672">.</span> $fileName;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Ainsi que les services nécessaires à l&rsquo;extraction de ces routes Javascript :</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">services</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">Kiboko\HelpDeskPortal\Infrastructure\Symfony\Router\PortalExposedRoutesExtractor</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">arguments</span>:
</span></span><span style="display:flex;"><span>      - <span style="color:#e6db74">&#39;@router&#39;</span>
</span></span><span style="display:flex;"><span>      - []
</span></span><span style="display:flex;"><span>      - <span style="color:#e6db74">&#39;%kernel.cache_dir%/oro_data&#39;</span>
</span></span><span style="display:flex;"><span>      - <span style="color:#e6db74">&#39;%kernel.bundles%&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">kiboko_help_desk_portal.js_routing_controller</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">class</span>: <span style="color:#e6db74">&#39;%fos_js_routing.controller.class%&#39;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">public</span>: <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">arguments</span>:
</span></span><span style="display:flex;"><span>      - <span style="color:#e6db74">&#39;@fos_js_routing.serializer&#39;</span>
</span></span><span style="display:flex;"><span>      - <span style="color:#e6db74">&#39;@Kiboko\HelpDeskPortal\Infrastructure\Symfony\Router\PortalExposedRoutesExtractor&#39;</span>
</span></span><span style="display:flex;"><span>      - <span style="color:#e6db74">&#39;%fos_js_routing.cache_control%&#39;</span>
</span></span><span style="display:flex;"><span>      - <span style="color:#e6db74">&#39;%kernel.debug%&#39;</span>
</span></span></code></pre></div><p>Nous aurons également besoin d&rsquo;exposer une route supplémentaire pour le service de contrôleur <code>kiboko_help_desk_portal.js_routing_controller</code> que nous avons créé plus haut :</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">kiboko_help_desk_portal_js_routing_js</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">path</span>: <span style="color:#e6db74">&#34;/media/js/frontend_routes.{_format}&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">defaults</span>: { <span style="color:#f92672">_controller</span>: <span style="color:#ae81ff">kiboko_help_desk_porta.js_routing_controller:indexAction }</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">requirements</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">_format</span>: <span style="color:#ae81ff">json</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">options</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">helpdesk_portal</span>: <span style="color:#66d9ef">true</span>
</span></span></code></pre></div></div>
          
          <nav class="pagination mt-3">
            
            
            
            
            
            
            
            
            
            

            
            
            
            
            

            
            
            
            
            
            
            
            
            
            
            

            
            
            
            
            

            
            
            
            
            
            
            
            

            
            
            

            
            
            
            
            
            
            
            
            
            
            

            
            
            

            
            
            
            
            
            
            
            
            
            
            

            
            
            

            
            
            
            
            
            
            
            
            
            
            

            
            
            

            
            
            
            
            
            
            
            
            
            
            

            
            
            

            
            
            
            
            
            
            
            
            
            
            

            
            
            

            
            
            
            
            
            
            
            
            
            
            

            
            
            

            
            
            
            
            
            
            
            
            
            
            

            
            
            

            
            
            
            
            
            
            
            
            
            
            

            
            
            

            
            
            
            
            
            
            
            
            
            
            

            
            
            

            
            
            
            
            
            
            
            
            
            
            

            
            
            

            
            
            
            
            
            
            
            
            
            
            

            
            
            

            
            
            
            
            
            
            
            
            
            
            

            
            
            

            
            
            
            
            
            
            
            
            
            
            

            
            
            

            
            
            
            
            
            
            
            
            
            
            

            
            
            

            
            
            
            
            
            
            
            
            
            
            

            
            
            

            
            
            
            
            
            
            
            
            
            
            
            
            
            

            
            
            

            
            
            
            
            
            
            
            
            
            
            

            
            
            
            
            

            
            
            
            
            
            
            
            

            
            
            

            
            
            
            
            
            
            
            
            
            
            
            
            
            
            

            
            
            
            
            

            
            
            
            
            
            
            
            
            
            
            

            
            
            
            
            

            
            
            
            
            
            
            
            

            
            
            

            
            
            
            
            
            
            
            
            
            
            

            
            
            

            
            
            
            
            
            
            
            
            
            
            
            
            
            

            
            
            
            
            

            
            
            
            
            
            
            
            

            
            
            

            
            
            
            
            
            
            
            
            
            
            

            
            
            

            
            
            
            
            
            
            
            
            
            
            
            
            
            

            
            
            
            
            

            
            
            
            
            
            
            
            

            
            
            

            
            
            
            
            
            
            
            
            
            
            

            
            
            

            
            
            
            
            
            
            
            
            
            
            
            
            
            

            
            
            

            
            
            
            
            
            
            
            
            
            
            

            
            
            
            
            

            
            
            
            
            
            
            
            

            
            
            

            
            
            
            
            
            
            
            

            
            
            

            
            
            
            
            
            
            
            
            
            
            

            
            
            

            
            
            
            
            
            
            
            
            
            
            

            
            
            

            
            
            
            
            
            
            
            
            
            
            

            
            
            

            
            
            
            
            
            
            
            
            
            
            

            
            
            

            
            
            
            
            
            
            
            
            
            
            

            
            
            

            
            
            
            
            
            
            
            
            
            
            

            
            
            

            
            
            
            
            
            
            
            
            
            
            

            
            
            

            
            
            
            
            
            
            
            
            
            
            

            
            
            

            
            
            
            
            
            
            
            
            
            
            
            
            
            

            
            
            

            
            
            
            
            
            
            
            
            
            
            

            
            
            

            
            
            
            
            
            
            
            
            
            
            
            
            
            
            

            
            
            

            
            
            
            
            
            
            
            
            
            
            
            
            
            

            
            
            

            
            
            
            
            
            
            
            
            
            
            

            
            
            

            
            
            
            
            
            
            
            
            
            
            

            
            
            

            
            
            
            
            
            
            
            
            
            
            
            
            
            

            
            
            
            
            

            
            
            
            
            
            
            
            

            
            
            

            
            
            
            
            
            
            
            
            
            
            
            
            
            

            
            
            
            
            

            
            
            
            
            
            
            
            

            
            
            

            
            
            
            
            
            
            
            
            
            
            

            
            
            

            
            
            
            
            
            
            
            
            
            
            
            
            
            

            
            
            
            
            

            
            
            
            
            
            
            
            

            
            
            

            
            
            
            
            
            
            
            
            
            
            

            
            
            

            
            
            
            
            
            
            
            
            
            
            

            
            
            

            
            
            
            
            
            
            
            
            
            
            
            
            
            

            
            
            

            
            
            
            
            
            
            

            
            <a class="nav nav-prev" href="https://tech.kiboko.fr/oro/test/javascript/javascript/"><i class="ti-arrow-left mr-2"></i> <span class="d-none d-md-block">Tests unitaire en Javascript</span></a>
            
            
            <a class="nav nav-next" href="https://tech.kiboko.fr/oro/block-types/"> <span class="d-none d-md-block">Les types de blocks dans Oro</span><i class="ti-arrow-right ml-2"></i></a>
            
          </nav>
        </div>
      </div>
    </div>
  </div>
</section>
<!-- /details page -->









    <!-- footer -->
<footer class="section pb-4">
  <div class="container">
    <div class="row align-items-center">
      <div class="col-md-8 text-md-left text-center">
        <!-- legal notice -->
          <a href="/legal-notice">
            <p class="mb-md-0 mb-4">Mentions légales</p>
          </a>
        <!-- /legal notice -->
      </div>
      <div class="col-md-4 text-md-right text-center">
        <ul class="list-inline list-social">
          
          <li class="list-inline-item"><a class="text-color d-inline-block p-2" href="https://twitter.com/kibokolabs"><i class="ti-twitter-alt"></i></a></li>
          
          <li class="list-inline-item"><a class="text-color d-inline-block p-2" href="https://github.com/kiboko-labs"><i class="ti-github"></i></a></li>
          
          <li class="list-inline-item"><a class="text-color d-inline-block p-2" href="https://www.linkedin.com/company/kiboko-sas"><i class="ti-linkedin"></i></a></li>
          
          <li class="list-inline-item"><a class="text-color d-inline-block p-2" href="http://kiboko.fr/fr/"><i class="ti-wordpress"></i></a></li>
          
        </ul>
      </div>
    </div>
  </div>
</footer>
<!-- /footer -->

<!-- Main Script -->

<script src="https://tech.kiboko.fr/js/script.min.js"></script>

  </body>

</html>